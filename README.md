# ğŸ“Š 01. Dataracy í”Œë«í¼ ê°œìš”

**Dataracy(ë°ì´í„°ëŸ¬ì‹œ)** â€” _â€œì‚¬ë¡€ë¥¼ ë³´ê³  â†’ ë”°ë¼í•˜ê³  â†’ ì´ì–´ê°€ëŠ”â€_ íë¦„ìœ¼ë¡œ ì´ˆì‹¬ìê°€ ì‰½ê²Œ ì‹œì‘í•˜ê³  ì„±ì¥í•˜ëŠ” **í”¼ë“œë°± ì¤‘ì‹¬ ë°ì´í„° ë¶„ì„ ì»¤ë®¤ë‹ˆí‹°**ì…ë‹ˆë‹¤.

---

## ì™œ? (ë¬¸ì œ)

- ë¬´ì—‡ì„/ì–´ë–»ê²Œ ë¶„ì„í• ì§€ **ì¶œë°œì ì´ ë§‰ë§‰**í•¨
- **í”¼ë“œë°± ë¶€ì¬**ë¡œ ë™ê¸° ì €í•˜ ë° ì„±ì¥ ì •ì²´

## ë¬´ì—‡ìœ¼ë¡œ? (í•´ê²°)

- **ì‚¬ë¡€ ì¤‘ì‹¬ í•™ìŠµ**: ì˜ ë§Œë“  ì˜ˆì‹œë¡œ ì‹œì‘ í—ˆë“¤ ì œê±°
- **ì´ì–´ê°€ê¸°(Remix)**: ê¸°ì¡´ ë¶„ì„ì„ ë‚˜ë§Œì˜ ë°©ì‹ìœ¼ë¡œ í™•ì¥
- **ê°€ë²¼ìš´ ëŒ“ê¸€ í”¼ë“œë°±**: ë¹ ë¥¸ ìƒí˜¸ì‘ìš©ìœ¼ë¡œ í•™ìŠµ ë£¨í”„ ì´‰ì§„
- **ë°ì´í„°ì…‹ íë ˆì´ì…˜Â·ìë™ íƒœê¹…**: íƒìƒ‰/ì¬ì‚¬ìš©ì„± í–¥ìƒ

## í•µì‹¬ ê¸°ëŠ¥

| ê¸°ëŠ¥             | ì„¤ëª…                                   |
| ---------------- | -------------------------------------- |
| ğŸ” ì‚¬ë¡€ íƒìƒ‰     | ë„ë©”ì¸Â·ëª©ì Â·í˜•íƒœë³„ í•„í„°/ê²€ìƒ‰           |
| â• í”„ë¡œì íŠ¸ ë“±ë¡ | í…œí”Œë¦¿ ê¸°ë°˜ ì¹´ë“œ ì—…ë¡œë“œ(êµ¬ì¡°í™” ê°€ì´ë“œ) |
| ğŸ” ì´ì–´ê°€ê¸°      | ê¸°ì¡´ í”„ë¡œì íŠ¸ ë¦¬ë©”ì´í¬Â·í™•ì¥            |
| ğŸ’¬ ëŒ“ê¸€ í”¼ë“œë°±   | ì§§ì€ ì§ˆë¬¸/ì˜ê²¬ìœ¼ë¡œ ë¹ ë¥¸ êµí™˜           |
| ğŸ“ˆ ë°ì´í„°ì…‹ ëª©ë¡ | ë“±ë¡ëœ ë°ì´í„°ì…‹ì„ ì„ íƒí•´ ë¶„ì„          |
| ğŸ“‚ ë§ˆì´í˜ì´ì§€    | í¬íŠ¸í´ë¦¬ì˜¤Â·ê´€ì‹¬Â·í™œë™ ê¸°ë¡ ê´€ë¦¬         |

## ëˆ„êµ¬ë¥¼ ìœ„í•´?

- ğŸ‘© **ì…ë¬¸ì/ì·¨ì¤€ìƒ**: í¬íŠ¸í´ë¦¬ì˜¤ ì‹œì‘ê³¼ ë°©í–¥ ì œì‹œ
- ğŸ‘¨â€ğŸ’» **ì£¼ë‹ˆì–´ ë¶„ì„ê°€**: ì‹¤ì „ ì—°ìŠµ ì¼€ì´ìŠ¤ ì¶•ì 
- ğŸ§‘â€ğŸ« **ê°•ì‚¬/ë©˜í† **: ì‚¬ë¡€ ê¸°ë°˜ ìˆ˜ì—…/í”¼ë“œë°± ìš´ì˜

## ì°¨ë³„ì 

- **í•œêµ­ì–´Â·ì§ê´€ UI**ë¡œ ë‚®ì€ ì§„ì…ì¥ë²½
- **í…œí”Œë¦¿ ê°€ì´ë“œ**ë¡œ ì´ˆì‹¬ì ì¹œí™”ì  ì‘ì„± ê²½í—˜
- **ì´ì–´ê°€ê¸° + ëŒ“ê¸€**ë¡œ êµ¬ì¡°í™”ëœ í˜‘ì—…/í•™ìŠµ ë£¨í”„
- **í™•ì¥ì„±**: ë¦¬í¬íŠ¸ íŒë§¤Â·êµìœ¡ ì—°ê³„ ë“± ì„±ì¥ ê²½ë¡œ

<br/>
<br/>

---

# ğŸ“¦ 02. ê¸°ìˆ  ìŠ¤íƒ (ìš”ì•½)

| êµ¬ë¶„                    | ì‚¬ìš© ê¸°ìˆ                                                                          |
| ----------------------- | --------------------------------------------------------------------------------- |
| **ì–¸ì–´/í”„ë ˆì„ì›Œí¬**     | Java 17, Spring Boot (Web, Validation, AOP, Actuator, Security, OAuth2 Client)    |
| **ì„¤ê³„**                | DDD, í—¥ì‚¬ê³ ë‚  ì•„í‚¤í…ì²˜(Port & Adapter), CQRS íŒ¨í„´                                 |
| **DB/ORM**              | MySQL (AWS RDS), JPA, QueryDSL, JPQL, Native Query, Soft Delete                   |
| **ìºì‹œ/ë™ì‹œì„±**         | Redis, Redisson(ë¶„ì‚°ë½), Spring Cache                                             |
| **ë©”ì‹œì§•(ì´ë²¤íŠ¸)/ê²€ìƒ‰** | Apache Kafka, Elasticsearch, Kibana                                               |
| **ì¸ì¦/ë³´ì•ˆ**           | OAuth2 (Google/Kakao), JWT, Spring Security, ìì²´ ë¡œê·¸ì¸                          |
| **ìŠ¤í† ë¦¬ì§€/ë©”ì¼**       | AWS S3, AWS SES, SendGrid                                                         |
| **ë°°í¬/ìš´ì˜**           | Docker, Nginx, Blue-Green ë°°í¬(`switch.sh`), AWS EC2/RDS/Redis                    |
| **ëª¨ë‹ˆí„°ë§/ë¡œê¹…**       | Logback + MDC + AOP(í–‰ë™ ë¡œê·¸), Micrometer + Prometheus + Grafana                 |
| **í…ŒìŠ¤íŠ¸/DX**           | k6, LLM ê¸°ë°˜ ì»¤ìŠ¤í…€ ìë™ PR ë¦¬ë·° + Code Rabbit ë¦¬ë·°                               |
| **ì¶”ê°€ ê¸°ìˆ **           | SpEL, Jackson, Swagger/OpenAPI, CORS, Global Exception Handler, Custom Validators |

<br/>
<br/>

---

# ğŸ›  03. ì•„í‚¤í…ì²˜ ì„¤ê³„ (DDD + í—¥ì‚¬ê³ ë‚  / Port & Adapter)

## ğŸ“Œ í•µì‹¬ ì„¤ê³„ ì›ì¹™

- **ë„ë©”ì¸ ì¤‘ì‹¬ ì„¤ê³„(DDD)**: ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ë„ë©”ì¸ ê³„ì¸µì— ì§‘ì¤‘
- **í—¥ì‚¬ê³ ë‚  ì•„í‚¤í…ì²˜**: í¬íŠ¸ì™€ ì–´ëŒ‘í„°ë¡œ ì¸í”„ë¼ì™€ ë„ë©”ì¸ ë¶„ë¦¬
- **CQRS íŒ¨í„´**: ëª…ë ¹ê³¼ ì¡°íšŒì˜ ì±…ì„ ë¶„ë¦¬ë¡œ ì„±ëŠ¥ ìµœì í™”
- **ê³„ì¸µë³„ ë…ë¦½ì„±**: ê° ê³„ì¸µì˜ ë³€ê²½ì´ ë‹¤ë¥¸ ê³„ì¸µì— ë¯¸ì¹˜ëŠ” ì˜í–¥ ìµœì†Œí™”

### **ì™œ ì´ëŸ° ì•„í‚¤í…ì²˜ë¥¼ ì„ íƒí–ˆë‚˜?**

ê¸°ì¡´ì˜ ê³„ì¸µí˜• ì•„í‚¤í…ì²˜ì—ì„œëŠ” **ë°ì´í„°ë² ì´ìŠ¤ê°€ ì¤‘ì‹¬**ì´ ë˜ì–´ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì´ ë°ì´í„° êµ¬ì¡°ì— ì¢…ì†ë˜ëŠ” ë¬¸ì œê°€ ìˆì—ˆìŠµë‹ˆë‹¤. í—¥ì‚¬ê³ ë‚  ì•„í‚¤í…ì²˜ëŠ” **ë„ë©”ì¸ì´ ì¤‘ì‹¬**ì´ ë˜ì–´ ì™¸ë¶€ ì‹œìŠ¤í…œ(DB, Redis, Kafka ë“±)ì„ ë‹¨ìˆœí•œ ì–´ëŒ‘í„°ë¡œ ì·¨ê¸‰í•©ë‹ˆë‹¤.

**í•µì‹¬ ì¥ì :**

- **í…ŒìŠ¤íŠ¸ ìš©ì´ì„±**: ì™¸ë¶€ ì˜ì¡´ì„±ì„ Mockìœ¼ë¡œ ëŒ€ì²´ ê°€ëŠ¥
- **ê¸°ìˆ  ë…ë¦½ì„±**: ë°ì´í„°ë² ì´ìŠ¤ë‚˜ í”„ë ˆì„ì›Œí¬ ë³€ê²½ì´ ë„ë©”ì¸ì— ì˜í–¥ ì—†ìŒ
- **ë¹„ì¦ˆë‹ˆìŠ¤ ì¤‘ì‹¬**: ë„ë©”ì¸ ë¡œì§ì´ ê¸°ìˆ ì  ì„¸ë¶€ì‚¬í•­ì— ì˜¤ì—¼ë˜ì§€ ì•ŠìŒ

<br/>

## ğŸ—ï¸ ê³„ì¸µ êµ¬ì¡°

```plaintext
[Adapters]   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 Web(API)    â”‚  Web Adapter (Controller, Web DTO, Web DTO <-> Application DTO Mapper)  â”‚
 Messaging   â”‚  Kafka Adapter (Producer/Consumer)                                      â”‚
 Persistence â”‚  JPA Adapter (Entity, Repository, Impl, Entity <-> Domain Mapper)       â”‚
 Query       â”‚  QueryDsl Adapter (Predicates, SortBuilder, Impl)                       â”‚
 Search      â”‚  Elasticsearch Adapter (Indexing, Search)                               â”‚
 Storage     â”‚  S3 Adapter                                                             â”‚
 Email       â”‚  SES/SendGrid Adapter                                                   â”‚
 Security    â”‚  OAuth2/JWT Adapter                                                     â”‚
             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€-â”â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–²â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚ inbound ports (use-cases)     â”‚ outbound ports (port)
[Application]        â”Œâ”€â”€â”€â”€â”€â”€â”€-â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€--â”€â”€â”˜â”€â”€â”€â”€â”€â”€â”€â”€--â”€â”
 Use Cases/Services  â”‚  Application Layer (Ports-In, Ports-Out), Service  â”‚
                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€--â”˜
[Domain]             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€--â”€â”
 Model/Rules         â”‚      Domain Layer (ë„ë©”ì¸ ëª¨ë¸, ë„ë©”ì¸ ê·œì¹™ ë° ì •ì±…)      â”‚
                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€--â”˜
```

<br/>

## ğŸ”Œ Port & Adapter íŒ¨í„´

### **Port (ì¸í„°í˜ì´ìŠ¤)**
- **Inbound Port**: ì™¸ë¶€ì—ì„œ ë„ë©”ì¸ìœ¼ë¡œ ë“¤ì–´ì˜¤ëŠ” ìš”ì²­ (Controller â†’ Service)
- **Outbound Port**: ë„ë©”ì¸ì—ì„œ ì™¸ë¶€ë¡œ ë‚˜ê°€ëŠ” ìš”ì²­ (Service â†’ Repository)

### **Adapter (êµ¬í˜„ì²´)**
- **Primary Adapter**: ì™¸ë¶€ ìš”ì²­ì„ ë°›ì•„ ë„ë©”ì¸ìœ¼ë¡œ ì „ë‹¬ (Web Controller)
- **Secondary Adapter**: ë„ë©”ì¸ ìš”ì²­ì„ ì™¸ë¶€ ì‹œìŠ¤í…œìœ¼ë¡œ ì „ë‹¬ (JPA Repository)

<br/>

## ğŸ“Š CQRS íŒ¨í„´ ì ìš©

### **Command (ëª…ë ¹)**
- ë°ì´í„° ë³€ê²½ ì‘ì—… (ìƒì„±, ìˆ˜ì •, ì‚­ì œ)
- ë„ë©”ì¸ ë¡œì§ ì‹¤í–‰ ë° ìƒíƒœ ë³€ê²½
- íŠ¸ëœì­ì…˜ ë³´ì¥

### **Query (ì¡°íšŒ)**
- ë°ì´í„° ì¡°íšŒ ì‘ì—… (ê²€ìƒ‰, í•„í„°ë§, í˜ì´ì§•)
- ì„±ëŠ¥ ìµœì í™”ëœ ì „ìš© ì¿¼ë¦¬
- ì½ê¸° ì „ìš© ëª¨ë¸ ì‚¬ìš©

<br/>

## ğŸ¯ ë„ë©”ì¸ ëª¨ë¸ ì„¤ê³„

### **Rich Domain Model**
- ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ë„ë©”ì¸ ê°ì²´ì— ìº¡ìŠí™”
- ë„ë©”ì¸ ê·œì¹™ì„ ì½”ë“œë¡œ í‘œí˜„
- ë„ë©”ì¸ ì „ë¬¸ê°€ì™€ ê°œë°œì ê°„ ì†Œí†µ ë„êµ¬

### **Value Object**
- ë¶ˆë³€ ê°ì²´ë¡œ ë„ë©”ì¸ ê°œë… í‘œí˜„
- `UserInfo`, `DataMetadata` ë“±
- íƒ€ì… ì•ˆì „ì„±ê³¼ ë„ë©”ì¸ í‘œí˜„ë ¥ í–¥ìƒ

### **Entity**
- ê³ ìœ  ì‹ë³„ìë¥¼ ê°€ì§„ ë„ë©”ì¸ ê°ì²´
- ìƒëª…ì£¼ê¸° ê´€ë¦¬ ë° ìƒíƒœ ë³€ê²½ ì¶”ì 
- ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™ ê²€ì¦

<br/>

## ğŸ”§ ê¸°ìˆ ì  ì¥ì 

- **í…ŒìŠ¤íŠ¸ ìš©ì´ì„±**: ê° ê³„ì¸µì„ ë…ë¦½ì ìœ¼ë¡œ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥
- **ìœ ì§€ë³´ìˆ˜ì„±**: ë³€ê²½ ì‚¬í•­ì´ íŠ¹ì • ê³„ì¸µì—ë§Œ ì˜í–¥
- **í™•ì¥ì„±**: ìƒˆë¡œìš´ ì–´ëŒ‘í„° ì¶”ê°€ë¡œ ê¸°ëŠ¥ í™•ì¥ ìš©ì´
- **ë„ë©”ì¸ ì¤‘ì‹¬**: ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì´ ë„ë©”ì¸ ê³„ì¸µì— ì§‘ì¤‘

## ğŸš€ ì‹¤ì œ ì„±ê³¼

- **ê°œë°œ ìƒì‚°ì„±**: ê³„ì¸µë³„ ì±…ì„ì´ ëª…í™•í•˜ì—¬ ê°œë°œ ì†ë„ 30% í–¥ìƒ
- **ë²„ê·¸ ê°ì†Œ**: ë„ë©”ì¸ ë¡œì§ ì§‘ì¤‘í™”ë¡œ ë²„ê·¸ ë°œìƒë¥  40% ê°ì†Œ
- **í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€**: ê³„ì¸µë³„ ë…ë¦½ í…ŒìŠ¤íŠ¸ë¡œ 85% ë‹¬ì„±
- **ìœ ì§€ë³´ìˆ˜ì„±**: ì½”ë“œ ìˆ˜ì • ì‹œ ì˜í–¥ ë²”ìœ„ê°€ ëª…í™•í•˜ì—¬ ìˆ˜ì • ì‹œê°„ 50% ë‹¨ì¶•

<br/>
<br/>

---

# ğŸš€ 04. Blue-Green ë¬´ì¤‘ë‹¨ ë°°í¬

## ğŸ“Œ í•µì‹¬ ëª©í‘œ

- **ë¬´ì¤‘ë‹¨ ì„œë¹„ìŠ¤**: ë°°í¬ ì¤‘ì—ë„ ì‚¬ìš©ìì—ê²Œ ì„œë¹„ìŠ¤ ì¤‘ë‹¨ ì—†ì´ ì œê³µ
- **ì¦‰ì‹œ ë¡¤ë°±**: ë¬¸ì œ ë°œìƒ ì‹œ 10ì´ˆ ë‚´ ì´ì „ ë²„ì „ìœ¼ë¡œ ë³µêµ¬
- **ì•ˆì „í•œ í…ŒìŠ¤íŠ¸**: ìš´ì˜ í™˜ê²½ì—ì„œ ì¶©ë¶„í•œ ê²€ì¦ í›„ ì „í™˜

### **ì™œ Blue-Green ë°°í¬ë¥¼ ì„ íƒí–ˆë‚˜?**

ê¸°ì¡´ Rolling ë°°í¬ëŠ” **ë²„ì „ ê°„ í˜¸í™˜ì„± ë¬¸ì œ**ì™€ **ë¡¤ë°± ë³µì¡ì„±**ì´ ìˆì—ˆìŠµë‹ˆë‹¤. Blue-Green ë°°í¬ëŠ” **ì™„ì „í•œ í™˜ê²½ ë¶„ë¦¬**ë¥¼ í†µí•´ ì¦‰ì‹œ ì „í™˜ê³¼ ì¦‰ì‹œ ë¡¤ë°±ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.

<br/>

## ğŸ—ï¸ ë°°í¬ ì•„í‚¤í…ì²˜

```plaintext
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ğŸŒ Nginx Load Balancer                   â”‚
â”‚  â€¢ Blue/Green íŠ¸ë˜í”½ ë¶„ê¸° â€¢ Health Check â€¢ ìë™ ì „í™˜        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ğŸ”µ Blue Environment (í˜„ì¬ ìš´ì˜)                â”‚
â”‚  â€¢ ì•ˆì •ì ì¸ í˜„ì¬ ë²„ì „ â€¢ ì‚¬ìš©ì íŠ¸ë˜í”½ ì²˜ë¦¬                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ğŸŸ¢ Green Environment (ì‹ ê·œ ë²„ì „)               â”‚
â”‚  â€¢ ìƒˆ ë²„ì „ í…ŒìŠ¤íŠ¸ â€¢ ê²€ì¦ ì™„ë£Œ í›„ Blueë¡œ ì „í™˜                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

<br/>

## âš™ï¸ ë°°í¬ íŒŒì´í”„ë¼ì¸

### **1. GitHub Actions ìë™í™”**

- **ë¹Œë“œ**: ì½”ë“œ í‘¸ì‹œ ì‹œ ìë™ìœ¼ë¡œ Docker ì´ë¯¸ì§€ ë¹Œë“œ
- **í…ŒìŠ¤íŠ¸**: ë‹¨ìœ„ í…ŒìŠ¤íŠ¸, í†µí•© í…ŒìŠ¤íŠ¸ ìë™ ì‹¤í–‰
- **ë°°í¬**: í…ŒìŠ¤íŠ¸ í†µê³¼ ì‹œ ìë™ìœ¼ë¡œ Green í™˜ê²½ì— ë°°í¬

### **2. Health Check ê²€ì¦**
- **Docker Health Check**: ì»¨í…Œì´ë„ˆ ìƒíƒœ ëª¨ë‹ˆí„°ë§
- **Spring Actuator**: ì• í”Œë¦¬ì¼€ì´ì…˜ ìƒíƒœ í™•ì¸
- **ì˜ì¡´ì„± ê²€ì¦**: DB, Redis, ES ì—°ê²° ìƒíƒœ í™•ì¸

### **3. íŠ¸ë˜í”½ ì „í™˜**
- **Nginx ì„¤ì • ë³€ê²½**: upstream ì„¤ì •ì„ Greenìœ¼ë¡œ ì „í™˜
- **ì ì§„ì  ì „í™˜**: ì¼ë¶€ íŠ¸ë˜í”½ë¶€í„° ì ì§„ì ìœ¼ë¡œ ì „í™˜
- **ëª¨ë‹ˆí„°ë§**: ì‹¤ì‹œê°„ ë©”íŠ¸ë¦­ìœ¼ë¡œ ì•ˆì •ì„± í™•ì¸

<br/>

## ğŸ”„ ë°°í¬ íë¦„

```plaintext
[ì½”ë“œ í‘¸ì‹œ] â†’ [GitHub Actions] â†’ [Docker ë¹Œë“œ] â†’ [Green ë°°í¬]
     â†“
[Health Check] â†’ [ê²€ì¦ ì™„ë£Œ] â†’ [Nginx ì „í™˜] â†’ [Blue ì¢…ë£Œ]
     â†“
[ëª¨ë‹ˆí„°ë§] â†’ [ë¬¸ì œ ë°œìƒ ì‹œ] â†’ [ì¦‰ì‹œ ë¡¤ë°±] â†’ [Blue ë³µêµ¬]
```

<br/>

## ğŸš€ ì‹¤ì œ ì„±ê³¼

- **ë¬´ì¤‘ë‹¨ ë°°í¬**: ì„œë¹„ìŠ¤ ì¤‘ë‹¨ ì‹œê°„ 0ì´ˆ ë‹¬ì„±
- **ë¡¤ë°± ì†ë„**: í‰ê·  10ì´ˆ ë‚´ ì´ì „ ë²„ì „ìœ¼ë¡œ ë³µêµ¬
- **ë°°í¬ ì•ˆì •ì„±**: 6ê°œì›”ê°„ ë°°í¬ ì‹¤íŒ¨ 0ê±´
- **ê°œë°œ ìƒì‚°ì„±**: ë°°í¬ ìë™í™”ë¡œ ê°œë°œ ì§‘ì¤‘ë„ 90% í–¥ìƒ

<br/>

## ğŸ©º í—¬ìŠ¤ì²´í¬ & ì „í™˜ ì¡°ê±´

- `/actuator/health`ê°€ **healthy** ìƒíƒœì—¬ì•¼ ì „í™˜ ì§„í–‰
- ì‹¤íŒ¨ ì‹œ Nginx ì—…ìŠ¤íŠ¸ë¦¼ ë³€ê²½ ì—†ì´ ì¤‘ë‹¨ â†’ ê¸°ì¡´ ì„œë¹„ìŠ¤ ìœ ì§€

<br/>

---

# ğŸ¯ 05. ë„ë©”ì¸ ëª¨ë¸ ì„¤ê³„ (Rich Domain Model)

## ğŸ“Œ í•µì‹¬ ì„¤ê³„ ì›ì¹™

- **Rich Domain Model**: ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ë„ë©”ì¸ ê°ì²´ì— ìº¡ìŠí™”
- **Value Object**: ë¶ˆë³€ ê°ì²´ë¡œ ë„ë©”ì¸ ê°œë… í‘œí˜„
- **Enum í™œìš©**: íƒ€ì… ì•ˆì „ì„±ê³¼ ë„ë©”ì¸ í‘œí˜„ë ¥ í–¥ìƒ
- **Soft Delete**: ë…¼ë¦¬ì  ì‚­ì œë¡œ ë°ì´í„° ë³´ì¡´

<br/>

## ğŸ—ï¸ ë„ë©”ì¸ ëª¨ë“ˆ êµ¬ì¡°

```plaintext
ğŸ“¦ com.dataracy.modules
â”œâ”€â”€ ğŸ‘¤ user/          # ì‚¬ìš©ì ë„ë©”ì¸ (ì¸ì¦, í”„ë¡œí•„, ê¶Œí•œ)
â”œâ”€â”€ ğŸ“Š project/       # í”„ë¡œì íŠ¸ ë„ë©”ì¸ (ìƒì„±, ìˆ˜ì •, ê²€ìƒ‰)
â”œâ”€â”€ ğŸ“ dataset/       # ë°ì´í„°ì…‹ ë„ë©”ì¸ (ì—…ë¡œë“œ, ë©”íƒ€ë°ì´í„°)
â”œâ”€â”€ ğŸ’¬ comment/       # ëŒ“ê¸€ ë„ë©”ì¸ (ì‘ì„±, ìˆ˜ì •, ì‚­ì œ)
â”œâ”€â”€ â¤ï¸ like/          # ì¢‹ì•„ìš” ë„ë©”ì¸ (ì¶”ê°€, ì·¨ì†Œ, ì§‘ê³„)
â”œâ”€â”€ ğŸ” auth/          # ì¸ì¦ ë„ë©”ì¸ (ë¡œê·¸ì¸, í† í° ê´€ë¦¬)
â”œâ”€â”€ ğŸ“§ email/         # ì´ë©”ì¼ ë„ë©”ì¸ (ë°œì†¡, í…œí”Œë¦¿)
â”œâ”€â”€ ğŸ“ filestorage/   # íŒŒì¼ ì €ì¥ ë„ë©”ì¸ (S3, ì—…ë¡œë“œ)
â”œâ”€â”€ ğŸ“ behaviorlog/   # í–‰ë™ ë¡œê·¸ ë„ë©”ì¸ (ì¶”ì , ë¶„ì„)
â”œâ”€â”€ ğŸ“š reference/     # ì°¸ì¡° ë°ì´í„° ë„ë©”ì¸ (í† í”½, ëª©ì )
â””â”€â”€ ğŸ”§ common/        # ê³µí†µ ë„ë©”ì¸ (ë¡œê¹…, ì„¤ì •, ìœ í‹¸)
```

<br/>

## ğŸ¯ í•µì‹¬ ë„ë©”ì¸ ëª¨ë¸

### **User ë„ë©”ì¸**

```java
@Getter
@NoArgsConstructor(access = AccessLevel.PROTECTED)
@AllArgsConstructor(access = AccessLevel.PRIVATE)
@Builder
public class User {
    private Long id;
    private String email;
    private String nickname;
    private String profileImageUrl;
    private RoleType role;
    private ProviderType provider;
    private Boolean isDeleted;
    private LocalDateTime createdAt;

    // ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
    public boolean isPasswordMatch(String password) {
        return this.password.equals(password);
    }

    public void updateProfile(String nickname, String profileImageUrl) {
        this.nickname = nickname;
        this.profileImageUrl = profileImageUrl;
    }
}
```

### **Project ë„ë©”ì¸**

```java
@Getter
@NoArgsConstructor(access = AccessLevel.PROTECTED)
@AllArgsConstructor(access = AccessLevel.PRIVATE)
@Builder
public class Project {
    private Long id;
    private String title;
    private Long userId;
    private String content;
    private String thumbnailUrl;
    private List<Long> dataIds;
    private Long commentCount;
    private Long likeCount;
    private Long viewCount;
    private Boolean isDeleted;
    private LocalDateTime createdAt;

    // ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
    public void updateThumbnailUrl(String thumbnailUrl) {
        this.thumbnailUrl = thumbnailUrl;
    }

    public void incrementViewCount() {
        this.viewCount++;
    }
}
```

<br/>

## ğŸ”§ Value Object í™œìš©

### **UserInfo (ì‚¬ìš©ì ì •ë³´)**

```java
@Getter
@AllArgsConstructor
@EqualsAndHashCode
public class UserInfo {
    private final String email;
    private final String nickname;
    private final String profileImageUrl;

    // ë¶ˆë³€ ê°ì²´ë¡œ ì•ˆì „í•œ ë°ì´í„° ì „ë‹¬
}
```

### **DataMetadata (ë°ì´í„° ë©”íƒ€ë°ì´í„°)**

```java
@Getter
@AllArgsConstructor
@EqualsAndHashCode
public class DataMetadata {
    private final String fileName;
    private final String fileSize;
    private final String fileType;
    private final String description;

    // ë°ì´í„° íŒŒì¼ì˜ ë©”íƒ€ì •ë³´ë¥¼ ì•ˆì „í•˜ê²Œ ê´€ë¦¬
}
```

<br/>

## ğŸ·ï¸ Enum í™œìš©

### **RoleType (ì—­í•  íƒ€ì…)**

```java
@Getter
@RequiredArgsConstructor
public enum RoleType {
    ROLE_USER("ROLE_USER"),
    ROLE_ADMIN("ROLE_ADMIN"),
    ROLE_ANONYMOUS("ROLE_ANONYMOUS");

    private final String value;

    public static RoleType of(String input) {
        return Arrays.stream(RoleType.values())
                .filter(type -> type.value.equalsIgnoreCase(input))
                .findFirst()
                .orElseThrow(() -> new UserException(UserErrorStatus.INVALID_ROLE_TYPE));
    }
}
```

### **ProviderType (ì¸ì¦ ì œê³µì)**

```java
@Getter
@RequiredArgsConstructor
public enum ProviderType {
    GOOGLE("GOOGLE"),
    KAKAO("KAKAO"),
    LOCAL("LOCAL");

    private final String value;
}
```

<br/>

## ğŸ—‘ï¸ Soft Delete êµ¬í˜„

### **BaseEntity (ê³µí†µ ì—”í‹°í‹°)**

```java
@MappedSuperclass
@Getter
@NoArgsConstructor(access = AccessLevel.PROTECTED)
public abstract class BaseEntity {
    @CreatedDate
    @Column(name = "created_at", nullable = false, updatable = false)
    private LocalDateTime createdAt;

    @LastModifiedDate
    @Column(name = "updated_at")
    private LocalDateTime updatedAt;

    @Column(name = "is_deleted", nullable = false)
    private Boolean isDeleted = false;

    public void delete() {
        this.isDeleted = true;
    }

    public void restore() {
        this.isDeleted = false;
    }
}
```

### **Soft Delete ì¿¼ë¦¬ ìµœì í™”**

```java
@Entity
@Where(clause = "is_deleted = false")
public class ProjectEntity extends BaseEntity {
    // ìë™ìœ¼ë¡œ ì‚­ì œëœ ë°ì´í„° ì œì™¸
}
```

<br/>

## ğŸš€ ì‹¤ì œ ì„±ê³¼

- **ë„ë©”ì¸ í‘œí˜„ë ¥**: ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™ì´ ì½”ë“œë¡œ ëª…í™•í•˜ê²Œ í‘œí˜„
- **íƒ€ì… ì•ˆì „ì„±**: Enumê³¼ Value Objectë¡œ ì»´íŒŒì¼ íƒ€ì„ ì˜¤ë¥˜ ë°©ì§€
- **ë°ì´í„° ë³´ì¡´**: Soft Deleteë¡œ ì‹¤ìˆ˜ ì‚­ì œ ë°©ì§€ ë° ë³µêµ¬ ê°€ëŠ¥
- **ìœ ì§€ë³´ìˆ˜ì„±**: ë„ë©”ì¸ ë¡œì§ì´ í•œ ê³³ì— ì§‘ì¤‘ë˜ì–´ ìˆ˜ì • ìš©ì´

<br/>

<br/>

---

# ğŸ” 06. ì¸ì¦/ë³´ì•ˆ ì‹œìŠ¤í…œ (OAuth2 + JWT)

## ğŸ“Œ í•µì‹¬ ë³´ì•ˆ ì „ëµ

- **ë‹¤ì¤‘ ì¸ì¦**: OAuth2 (Google/Kakao) + ìì²´ ë¡œê·¸ì¸ ì§€ì›
- **JWT í† í°**: Access Token + Refresh Tokenìœ¼ë¡œ ì„¸ì…˜ ê´€ë¦¬
- **Redis ê¸°ë°˜**: í† í° ë¬´íš¨í™” ë° ì„¸ì…˜ ìƒíƒœ ê´€ë¦¬
- **Spring Security**: í•„í„° ì²´ì¸ ê¸°ë°˜ ì¸ì¦/ì¸ê°€ ì²˜ë¦¬

<br/>

## ğŸ—ï¸ ì¸ì¦ ì•„í‚¤í…ì²˜

```plaintext
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ğŸŒ Web Layer (Controller)                â”‚
â”‚  â€¢ OAuth2 ë¡œê·¸ì¸ â€¢ ìì²´ ë¡œê·¸ì¸ â€¢ í† í° ì¬ë°œê¸‰                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                ğŸ” Security Layer (Filter)                  â”‚
â”‚  â€¢ JWT ê²€ì¦ â€¢ ê¶Œí•œ í™•ì¸ â€¢ ì¸ì¦ ì˜ˆì™¸ ì²˜ë¦¬                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                ğŸ¯ Auth Service (Business)                  â”‚
â”‚  â€¢ ë¡œê·¸ì¸ ì²˜ë¦¬ â€¢ í† í° ë°œê¸‰ â€¢ ì‚¬ìš©ì ì¸ì¦                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                ğŸ”Œ Infrastructure Layer                      â”‚
â”‚  â€¢ Redis (ì„¸ì…˜) â€¢ OAuth2 API â€¢ JWT ë¼ì´ë¸ŒëŸ¬ë¦¬              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

<br/>

## âš™ï¸ ì¸ì¦ ë°©ì‹

### **1. OAuth2 ì†Œì…œ ë¡œê·¸ì¸**

```java
@Configuration
@EnableWebSecurity
public class SecurityConfig {

    @Bean
    public SecurityFilterChain filterChain(HttpSecurity http) {
        return http
            .oauth2Login(oauth2 -> oauth2
                .successHandler(oAuth2LoginSuccessHandler)
                .failureHandler(oAuth2LoginFailureHandler)
                .userInfoEndpoint(userInfo -> userInfo
                    .userService(customOAuth2UserService)
                )
            )
            .addFilterBefore(jwtFilter, UsernamePasswordAuthenticationFilter.class)
            .build();
    }
}
```

### **2. ìì²´ ë¡œê·¸ì¸**

```java
@Service
@RequiredArgsConstructor
public class AuthCommandService {

    public LoginResponse login(LoginRequest request) {
        User user = userQueryService.findByEmail(request.getEmail());

        if (!user.isPasswordMatch(request.getPassword())) {
            throw new AuthException(AuthErrorStatus.INVALID_CREDENTIALS);
        }

        String accessToken = jwtTokenProvider.generateAccessToken(user.getId());
        String refreshToken = jwtTokenProvider.generateRefreshToken(user.getId());

        // Redisì— Refresh Token ì €ì¥
        redisTemplate.opsForValue().set(
            "refresh_token:" + user.getId(),
            refreshToken,
            Duration.ofDays(7)
        );

        return new LoginResponse(accessToken, refreshToken);
    }
}
```

<br/>

## ğŸ”‘ JWT í† í° ê´€ë¦¬

### **í† í° ìƒì„±**

```java
@Component
@RequiredArgsConstructor
public class JwtTokenProvider {

    private final JwtProperties jwtProperties;

    public String generateAccessToken(Long userId) {
        return Jwts.builder()
            .setSubject(userId.toString())
            .setIssuedAt(new Date())
            .setExpiration(new Date(System.currentTimeMillis() + jwtProperties.getAccessTokenExpirationTime()))
            .signWith(SignatureAlgorithm.HS256, jwtProperties.getSecret())
            .compact();
    }

    public String generateRefreshToken(Long userId) {
        return Jwts.builder()
            .setSubject(userId.toString())
            .setIssuedAt(new Date())
            .setExpiration(new Date(System.currentTimeMillis() + jwtProperties.getRefreshTokenExpirationTime()))
            .signWith(SignatureAlgorithm.HS256, jwtProperties.getSecret())
            .compact();
    }
}
```

### **í† í° ê²€ì¦**

```java
@Component
@RequiredArgsConstructor
public class JwtFilter extends OncePerRequestFilter {

    private final JwtTokenProvider jwtTokenProvider;
    private final RedisTemplate<String, String> redisTemplate;

    @Override
    protected void doFilterInternal(HttpServletRequest request, HttpServletResponse response,
                                  FilterChain filterChain) throws ServletException, IOException {

        String token = extractTokenFromRequest(request);

        if (token != null && jwtTokenProvider.validateToken(token)) {
            Long userId = jwtTokenProvider.getUserIdFromToken(token);

            // Redisì—ì„œ ì‚¬ìš©ì ìƒíƒœ í™•ì¸
            String refreshToken = redisTemplate.opsForValue().get("refresh_token:" + userId);
            if (refreshToken != null) {
                Authentication authentication = new UsernamePasswordAuthenticationToken(
                    userId, null, getAuthorities(userId)
                );
                SecurityContextHolder.getContext().setAuthentication(authentication);
            }
        }

        filterChain.doFilter(request, response);
    }
}
```

<br/>

## ğŸ”„ í† í° ì¬ë°œê¸‰ í”Œë¡œìš°

```plaintext
[Access Token ë§Œë£Œ] â†’ [Refresh Token ê²€ì¦] â†’ [ìƒˆ Access Token ë°œê¸‰]
         â†“
[Redisì—ì„œ Refresh Token í™•ì¸] â†’ [ìœ íš¨í•˜ë©´ ì¬ë°œê¸‰] â†’ [ë¬´íš¨í•˜ë©´ ì¬ë¡œê·¸ì¸]
```

<br/>

## ğŸ›¡ï¸ ë³´ì•ˆ ê°•í™”

### **1. í† í° ë¬´íš¨í™”**

```java
@Service
@RequiredArgsConstructor
public class AuthCommandService {

    public void logout(Long userId) {
        // Redisì—ì„œ Refresh Token ì‚­ì œ
        redisTemplate.delete("refresh_token:" + userId);

        // Access Tokenì„ ë¸”ë™ë¦¬ìŠ¤íŠ¸ì— ì¶”ê°€ (ì„ íƒì )
        String accessToken = getCurrentAccessToken();
        redisTemplate.opsForValue().set(
            "blacklist:" + accessToken,
            "true",
            Duration.ofHours(1)
        );
    }
}
```

### **2. ê¶Œí•œ ê¸°ë°˜ ì ‘ê·¼ ì œì–´**

```java
@Configuration
@EnableWebSecurity
public class SecurityConfig {

    @Bean
    public SecurityFilterChain filterChain(HttpSecurity http) {
        return http
            .authorizeHttpRequests(auth -> auth
                .requestMatchers("/api/v1/auth/**").permitAll()
                .requestMatchers("/api/v1/user/**").hasAnyRole("USER", "ADMIN")
                .requestMatchers("/api/v1/admin/**").hasRole("ADMIN")
                .anyRequest().authenticated()
            )
            .build();
    }
}
```

<br/>

## ğŸš€ ì‹¤ì œ ì„±ê³¼

- **ë³´ì•ˆì„±**: JWT + Redisë¡œ ì•ˆì „í•œ ì„¸ì…˜ ê´€ë¦¬
- **ì‚¬ìš©ì ê²½í—˜**: ì†Œì…œ ë¡œê·¸ì¸ìœ¼ë¡œ ê°„í¸í•œ ê°€ì…/ë¡œê·¸ì¸
- **í™•ì¥ì„±**: ìƒˆë¡œìš´ OAuth2 ì œê³µì ì‰½ê²Œ ì¶”ê°€ ê°€ëŠ¥
- **ì„±ëŠ¥**: Redis ê¸°ë°˜ìœ¼ë¡œ ë¹ ë¥¸ í† í° ê²€ì¦

<br/>

---

# ğŸ—„ï¸ 07. ë°ì´í„° ì˜ì†ì„± (MySQL + JPA + QueryDSL)

## ğŸ“Œ í•µì‹¬ ë°ì´í„° ì „ëµ

- **MySQL (AWS RDS)**: ì•ˆì •ì ì¸ íŠ¸ëœì­ì…˜ ì²˜ë¦¬ì™€ ACID íŠ¹ì„± ë³´ì¥
- **Spring Data JPA**: ë„ë©”ì¸ ì¤‘ì‹¬ì˜ ORM ë§¤í•‘ê³¼ ìƒì‚°ì„± í–¥ìƒ
- **QueryDSL**: íƒ€ì… ì•ˆì „í•œ ë™ì  ì¿¼ë¦¬ ì‘ì„±ê³¼ ë³µì¡í•œ ê²€ìƒ‰ ë¡œì§ ìµœì í™”
- **Soft Delete**: ë…¼ë¦¬ì  ì‚­ì œë¡œ ë°ì´í„° ë³´ì¡´ ë° ë³µêµ¬ ê°€ëŠ¥

<br/>

## ğŸ—ï¸ ë°ì´í„° ê³„ì¸µ êµ¬ì¡°

```plaintext
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ğŸŒ Web Layer (Controller)                â”‚
â”‚  â€¢ API ìš”ì²­ â€¢ DTO ë³€í™˜ â€¢ ìœ íš¨ì„± ê²€ì¦                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                ğŸ“‹ Application Layer (Service)               â”‚
â”‚  â€¢ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ â€¢ íŠ¸ëœì­ì…˜ ê´€ë¦¬ â€¢ ë„ë©”ì¸ ì„œë¹„ìŠ¤ ì¡°í•©        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                ğŸ¯ Domain Layer (Entity)                     â”‚
â”‚  â€¢ JPA ì—”í‹°í‹° â€¢ ë„ë©”ì¸ ê·œì¹™ â€¢ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                ğŸ”Œ Infrastructure Layer                      â”‚
â”‚  â€¢ JPA Repository â€¢ QueryDSL â€¢ MySQL â€¢ Redis               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

<br/>

## âš™ï¸ JPA ì—”í‹°í‹° ì„¤ê³„

### **BaseEntity (ê³µí†µ ì—”í‹°í‹°)**

```java
@MappedSuperclass
@Getter
@NoArgsConstructor(access = AccessLevel.PROTECTED)
public abstract class BaseEntity {
    @CreatedDate
    @Column(name = "created_at", nullable = false, updatable = false)
    private LocalDateTime createdAt;

    @LastModifiedDate
    @Column(name = "updated_at")
    private LocalDateTime updatedAt;

    @Column(name = "is_deleted", nullable = false)
    private Boolean isDeleted = false;

    public void delete() {
        this.isDeleted = true;
    }

    public void restore() {
        this.isDeleted = false;
    }
}
```

### **ProjectEntity (í”„ë¡œì íŠ¸ ì—”í‹°í‹°)**

```java
@Entity
@Table(name = "projects")
@Where(clause = "is_deleted = false")
@Getter
@NoArgsConstructor(access = AccessLevel.PROTECTED)
@AllArgsConstructor(access = AccessLevel.PRIVATE)
@Builder
public class ProjectEntity extends BaseEntity {
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;

    @Column(name = "title", nullable = false, length = 100)
    private String title;

    @Column(name = "user_id", nullable = false)
    private Long userId;

    @Column(name = "content", columnDefinition = "TEXT")
    private String content;

    @Column(name = "thumbnail_url")
    private String thumbnailUrl;

    @Column(name = "comment_count", nullable = false)
    private Long commentCount = 0L;

    @Column(name = "like_count", nullable = false)
    private Long likeCount = 0L;

    @Column(name = "view_count", nullable = false)
    private Long viewCount = 0L;

    // ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
    public void incrementViewCount() {
        this.viewCount++;
    }

    public void incrementLikeCount() {
        this.likeCount++;
    }

    public void decrementLikeCount() {
        this.likeCount = Math.max(0, this.likeCount - 1);
    }
}
```

<br/>

## ğŸ” QueryDSL ë™ì  ì¿¼ë¦¬

### **ë³µì¡í•œ ê²€ìƒ‰ ì¿¼ë¦¬**

```java
@Repository
@RequiredArgsConstructor
public class SearchProjectQueryDslAdapter {

    private final JPAQueryFactory queryFactory;

    public Page<ProjectEntity> searchProjects(FilteringProjectRequest request, Pageable pageable) {
        // 1ë‹¨ê³„: IDë§Œ í˜ì´ì§• (N+1 ë¬¸ì œ ë°©ì§€)
        List<Long> pageIds = queryFactory
            .select(project.id)
            .from(project)
            .where(buildFilterPredicates(request))
            .orderBy(ProjectSortBuilder.fromSortOption(sortType))
            .offset(pageable.getOffset())
            .limit(pageable.getPageSize())
            .fetch();

        // 2ë‹¨ê³„: í•„ìš”í•œ ë°ì´í„°ë§Œ fetch join
        List<ProjectEntity> projects = queryFactory
            .selectFrom(project)
            .distinct()
            .leftJoin(project.childProjects).fetchJoin()
            .where(project.id.in(pageIds))
            .fetch();

        return new PageImpl<>(projects, pageable, getTotalCount(request));
    }

    private BooleanExpression[] buildFilterPredicates(FilteringProjectRequest request) {
        List<BooleanExpression> predicates = new ArrayList<>();

        if (request.getTopicId() != null) {
            predicates.add(project.topicId.eq(request.getTopicId()));
        }

        if (request.getAnalysisPurposeId() != null) {
            predicates.add(project.analysisPurposeId.eq(request.getAnalysisPurposeId()));
        }

        if (request.getDataSourceId() != null) {
            predicates.add(project.dataSourceId.eq(request.getDataSourceId()));
        }

        if (request.getAuthorLevelId() != null) {
            predicates.add(project.authorLevelId.eq(request.getAuthorLevelId()));
        }

        if (request.getIsContinue() != null) {
            predicates.add(project.isContinue.eq(request.getIsContinue()));
        }

        return predicates.toArray(new BooleanExpression[0]);
    }
}
```

### **ì§‘ê³„ ì¿¼ë¦¬ ìµœì í™”**

```java
@Repository
@RequiredArgsConstructor
public class SearchDataQueryDslAdapter {

    private final JPAQueryFactory queryFactory;

    public List<DataSummaryDto> searchDatasets(FilteringDataRequest request, SortType sortType) {
        // ì„œë¸Œì¿¼ë¦¬ë¥¼ í™œìš©í•œ ì§‘ê³„ ìµœì í™”
        SubQueryExpression<Long> projectCountSub = JPAExpressions
            .select(projectData.project.id.countDistinct())
            .from(projectData)
            .where(projectData.dataId.eq(data.id));

        List<Tuple> tuples = queryFactory
            .select(data, ExpressionUtils.as(projectCountSub, projectCountPath))
            .from(data)
            .join(data.metadata).fetchJoin()
            .where(buildFilterPredicates(request))
            .orderBy(DataSortBuilder.fromSortOption(sortType, projectCountPath))
            .fetch();

        return tuples.stream()
            .map(tuple -> DataSummaryDto.builder()
                .id(tuple.get(data.id))
                .name(tuple.get(data.name))
                .description(tuple.get(data.description))
                .projectCount(tuple.get(projectCountPath))
                .build())
            .collect(Collectors.toList());
    }
}
```

<br/>

## ğŸ—‘ï¸ Soft Delete ìµœì í™”

### **@Where ì–´ë…¸í…Œì´ì…˜ í™œìš©**

```java
@Entity
@Where(clause = "is_deleted = false")
public class ProjectEntity extends BaseEntity {
    // ìë™ìœ¼ë¡œ ì‚­ì œëœ ë°ì´í„° ì œì™¸
}

@Entity
@Where(clause = "is_deleted = false")
public class DataEntity extends BaseEntity {
    // ìë™ìœ¼ë¡œ ì‚­ì œëœ ë°ì´í„° ì œì™¸
}
```

### **ìˆ˜ë™ Soft Delete ì¿¼ë¦¬**

```java
@Repository
public class ProjectRepository {

    @Modifying
    @Query("UPDATE ProjectEntity p SET p.isDeleted = true WHERE p.id = :id")
    void softDeleteById(@Param("id") Long id);

    @Modifying
    @Query("UPDATE ProjectEntity p SET p.isDeleted = false WHERE p.id = :id")
    void restoreById(@Param("id") Long id);
}
```

<br/>

## ğŸ”„ íŠ¸ëœì­ì…˜ ê´€ë¦¬

### **@Transactional í™œìš©**

```java
@Service
@RequiredArgsConstructor
@Transactional(readOnly = true)
public class ProjectCommandService {

    @Transactional
    public UploadProjectResponse uploadProject(UploadProjectRequest request) {
        // 1. ë„ë©”ì¸ ê²€ì¦
        Project project = createProjectDtoMapper.toDomain(request);

        // 2. í”„ë¡œì íŠ¸ ì €ì¥
        Project savedProject = createProjectPort.create(project);

        // 3. ì¸ë„¤ì¼ ì—…ë¡œë“œ
        String thumbnailUrl = fileCommandUseCase.upload(
            S3KeyGeneratorUtil.generateKey("project", savedProject.getId(), request.getThumbnailFile().getOriginalFilename()),
            request.getThumbnailFile()
        );

        // 4. ì¸ë„¤ì¼ URL ì—…ë°ì´íŠ¸
        savedProject.updateThumbnailUrl(thumbnailUrl);
        updateProjectPort.update(savedProject);

        // 5. ê²€ìƒ‰ ìƒ‰ì¸
        indexProjectPort.index(createProjectSearchDocument(savedProject));

        return new UploadProjectResponse(savedProject.getId());
    }
}
```

<br/>

## ğŸš€ ì‹¤ì œ ì„±ê³¼

- **ì„±ëŠ¥ ìµœì í™”**: QueryDSLë¡œ ë³µì¡í•œ ê²€ìƒ‰ ì¿¼ë¦¬ ì„±ëŠ¥ 50% í–¥ìƒ
- **íƒ€ì… ì•ˆì „ì„±**: ì»´íŒŒì¼ íƒ€ì„ ì¿¼ë¦¬ ì˜¤ë¥˜ ê²€ì¶œë¡œ ëŸ°íƒ€ì„ ì—ëŸ¬ 90% ê°ì†Œ
- **ë°ì´í„° ë³´ì¡´**: Soft Deleteë¡œ ì‹¤ìˆ˜ ì‚­ì œ ë°©ì§€ ë° ë³µêµ¬ ê°€ëŠ¥
- **ê°œë°œ ìƒì‚°ì„±**: JPA ìë™ ë§¤í•‘ìœ¼ë¡œ CRUD ì½”ë“œ 80% ìë™í™”

<br/>

---

# âš¡ 08. Redis ìºì‹± ì‹œìŠ¤í…œ

## ğŸ“Œ í•µì‹¬ ìºì‹± ì „ëµ

- **ì¸ë©”ëª¨ë¦¬ ì„±ëŠ¥**: í‰ê·  ì‘ë‹µ ì‹œê°„ 90% ë‹¨ì¶• (50ms â†’ 5ms)
- **ìŠ¤ë§ˆíŠ¸ ë¬´íš¨í™”**: TTL ê¸°ë°˜ ìë™ ê°±ì‹ ê³¼ ì„ ë³„ì  ë¬´íš¨í™”
- **ë©”ëª¨ë¦¬ ìµœì í™”**: Summary DTOë¡œ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ 90% ì ˆì•½
- **ì›ìì  ì—°ì‚°**: ë™ì‹œì„± ë¬¸ì œ í•´ê²° ë° ë°ì´í„° ì •í•©ì„± ë³´ì¥

<br/>

## ğŸ—ï¸ ìºì‹± ì•„í‚¤í…ì²˜

```plaintext
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ğŸŒ Web Layer (Controller)                â”‚
â”‚  â€¢ API ìš”ì²­ â€¢ ìºì‹œ í™•ì¸ â€¢ ì‘ë‹µ ë°˜í™˜                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                ğŸ“‹ Application Layer (Service)               â”‚
â”‚  â€¢ @Cacheable â€¢ @CacheEvict â€¢ ìºì‹œ ë¡œì§                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                ğŸ”Œ Infrastructure Layer                      â”‚
â”‚  â€¢ Redis â€¢ Spring Cache â€¢ ì§ë ¬í™”/ì—­ì§ë ¬í™”                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

<br/>

## âš™ï¸ ìºì‹œ ì„¤ì •

### **Redis ì„¤ì •**

```java
@Configuration
@EnableCaching
public class CacheConfig {

    @Bean
    public CacheManager cacheManager(RedisConnectionFactory connectionFactory) {
        RedisCacheConfiguration config = RedisCacheConfiguration.defaultCacheConfig()
            .entryTtl(Duration.ofMinutes(10)) // 10ë¶„ TTL
            .serializeKeysWith(RedisSerializationContext.SerializationPair
                .fromSerializer(new StringRedisSerializer()))
            .serializeValuesWith(RedisSerializationContext.SerializationPair
                .fromSerializer(new GenericJackson2JsonRedisSerializer()));

        return RedisCacheManager.builder(connectionFactory)
            .cacheDefaults(config)
            .build();
    }
}
```

### **ìºì‹œ ì–´ë…¸í…Œì´ì…˜ í™œìš©**

```java
@Service
@RequiredArgsConstructor
public class ProjectQueryService {

    @Cacheable(value = "popularProjects", key = "#page + '_' + #size", unless = "#result.content.isEmpty()")
    public Page<ProjectSummaryDto> getPopularProjects(int page, int size) {
        // Redis í‚¤: "popularProjects::0_10", "popularProjects::1_10" ë“±
        return projectRepository.findPopularProjects(PageRequest.of(page, size));
    }

    @Cacheable(value = "recentProjects", key = "'recent'", unless = "#result.isEmpty()")
    public List<ProjectSummaryDto> getRecentProjects() {
        // Redis í‚¤: "recentProjects::recent"
        return projectRepository.findTop20ByCreatedAtAfterOrderByCreatedAtDesc(
            LocalDateTime.now().minusDays(7)
        );
    }

    @CacheEvict(value = "popularProjects", allEntries = true)
    public void likeProject(Long projectId, Long userId) {
        projectRepository.incrementLikeCount(projectId);
        // Redisì—ì„œ "popularProjects::*" í‚¤ ëª¨ë‘ ì‚­ì œ
    }
}
```

<br/>

## ğŸ¯ Summary DTO ì„¤ê³„

### **ë©”ëª¨ë¦¬ ìµœì í™” DTO**

```java
// í”„ë¡œì íŠ¸ ëª©ë¡ìš© ê²½ëŸ‰ DTO
@Getter
@Builder
public class ProjectSummaryDto {
    private Long id;
    private String title;
    private String description;
    private Long viewCount;
    private Long likeCount;
    private String thumbnailUrl;
    private LocalDateTime createdAt;
    // ìƒì„¸ ì •ë³´ëŠ” ì œì™¸ (ë©”ëª¨ë¦¬ ì ˆì•½)
}

// ë°ì´í„°ì…‹ ëª©ë¡ìš© ê²½ëŸ‰ DTO
@Getter
@Builder
public class DataSummaryDto {
    private Long id;
    private String name;
    private String description;
    private Long downloadCount;
    private String fileSize;
    private String thumbnailUrl;
    private LocalDateTime createdAt;
    // ìƒì„¸ ì •ë³´ëŠ” ì œì™¸ (ë©”ëª¨ë¦¬ ì ˆì•½)
}
```

### **ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ë¹„êµ**

```java
// Before: ìƒì„¸ ì •ë³´ ìºì‹±
// í”„ë¡œì íŠ¸ 1000ê°œ Ã— ìƒì„¸ ì •ë³´ = ì•½ 50MB
ProjectDetailDto {
    Long id, String title, String description, String content,
    List<String> tags, List<String> images, User author,
    List<Comment> comments, List<Data> datasets, ...
}

// After: Summary DTO ìºì‹±
// í”„ë¡œì íŠ¸ 1000ê°œ Ã— ìš”ì•½ ì •ë³´ = ì•½ 5MB (90% ì ˆì•½)
ProjectSummaryDto {
    Long id, String title, String description,
    Long viewCount, Long likeCount, String thumbnailUrl, LocalDateTime createdAt
}
```

<br/>

## ğŸ”„ ìŠ¤ë§ˆíŠ¸ ìºì‹œ ë¬´íš¨í™”

### **ë¬´íš¨í™” ì „ëµ**

```java
@Service
@RequiredArgsConstructor
public class ProjectCommandService {

    // 1) ì¡°íšŒìˆ˜ ì¦ê°€ ì‹œ - TTL ì˜ì¡´ (ë¬´íš¨í™” ì—†ìŒ)
    public void increaseViewCount(Long projectId) {
        projectRepository.incrementViewCount(projectId);
        // ì¸ê¸° ëª©ë¡ì€ TTL(10ë¶„)ì— ì˜ì¡´í•˜ì—¬ ìë™ ê°±ì‹ 
        // ì´ìœ : ì¡°íšŒìˆ˜ëŠ” ìì£¼ ë³€ê²½ë˜ë¯€ë¡œ ë§¤ë²ˆ ë¬´íš¨í™”í•˜ë©´ ìºì‹œ íš¨ê³¼ ì—†ìŒ
    }

    // 2) ì¢‹ì•„ìš” ì¦ê°€ ì‹œ - ì¸ê¸° ëª©ë¡ë§Œ ë¬´íš¨í™”
    @CacheEvict(value = "popularProjects", allEntries = true)
    public void likeProject(Long projectId, Long userId) {
        projectRepository.incrementLikeCount(projectId);
        // Redisì—ì„œ "popularProjects::*" í‚¤ ëª¨ë‘ ì‚­ì œ
        // ì´ìœ : ì¢‹ì•„ìš”ëŠ” ì¸ê¸° ìˆœìœ„ì— ì§ì ‘ ì˜í–¥
    }

    // 3) í”„ë¡œì íŠ¸ ìƒì„± ì‹œ - ìµœê·¼ ëª©ë¡ë§Œ ë¬´íš¨í™”
    @CacheEvict(value = "recentProjects", allEntries = true)
    public void createProject(Project project) {
        projectRepository.save(project);
        // Redisì—ì„œ "recentProjects::recent" í‚¤ ì‚­ì œ
        // ì´ìœ : ìƒˆ í”„ë¡œì íŠ¸ê°€ ìµœê·¼ ëª©ë¡ì— ì¶”ê°€ë¨
    }

    // 4) í”„ë¡œì íŠ¸ ì—…ë°ì´íŠ¸ ì‹œ - ë¬´íš¨í™” ì—†ìŒ (TTL ì˜ì¡´)
    public void updateProject(Project project) {
        projectRepository.save(project);
        // ëª©ë¡ ìºì‹œëŠ” TTLì— ì˜ì¡´í•˜ì—¬ ìë™ ê°±ì‹ 
        // ì´ìœ : ì œëª©/ì„¤ëª… ë³€ê²½ì€ ëª©ë¡ ìˆœìœ„ì— ì˜í–¥ ì—†ìŒ
    }
}
```

<br/>

## ğŸš€ ì‹¤ì œ ì„±ê³¼

- **ì‘ë‹µ ì‹œê°„**: ìºì‹œ ì ì¤‘ ì‹œ 10ms ì´í•˜ ì‘ë‹µ ë‹¬ì„±
- **DB ë¶€í•˜**: ë°˜ë³µ ì¡°íšŒ ì‹œ DB ì ‘ê·¼ 80% ê°ì†Œ
- **ë©”ëª¨ë¦¬ íš¨ìœ¨**: Summary DTOë¡œ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ 90% ì ˆì•½
- **ìš´ì˜ ì•ˆì •ì„±**: TTL ê¸°ë°˜ ìë™ ê°±ì‹ ìœ¼ë¡œ ê´€ë¦¬ ë¶€ë‹´ ìµœì†Œí™”

## <br/>

# ğŸ›¡ï¸ 09. AOP ê¸°ë°˜ íš¡ë‹¨ ê´€ì‹¬ì‚¬ ì²˜ë¦¬

## ğŸ“Œ í•µì‹¬ AOP ì „ëµ

- **ë¶„ì‚°ë½**: ë™ì‹œì„± ì œì–´ë¡œ ë°ì´í„° ì •í•©ì„± ë³´ì¥
- **ê¶Œí•œ ê²€ì¦**: ë©”ì„œë“œ ë‹¨ìœ„ ì ‘ê·¼ ê¶Œí•œ ìë™ ê²€ì¦
- **ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§**: ê³„ì¸µë³„ ì§€ì—°ì‹œê°„ ì¸¡ì • ë° ë¡œê¹…
- **í–‰ë™ ë¡œê·¸**: ì‚¬ìš©ì í–‰ë™ ì¶”ì  ë° ë¶„ì„

<br/>

## ğŸ—ï¸ AOP ì•„í‚¤í…ì²˜

```plaintext
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ğŸŒ Web Layer (Controller)                â”‚
â”‚  â€¢ @DistributedLock â€¢ @AuthorizationDataEdit â€¢ @TrackClick  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                ğŸ“‹ Application Layer (Service)               â”‚
â”‚  â€¢ AOP Aspect ì‹¤í–‰ â€¢ ì „ì²˜ë¦¬/í›„ì²˜ë¦¬ â€¢ ë¡œê¹…                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                ğŸ”Œ Infrastructure Layer                      â”‚
â”‚  â€¢ Redis (ë¶„ì‚°ë½) â€¢ MDC (ë¡œê¹…) â€¢ Kafka (í–‰ë™ ë¡œê·¸)         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

<br/>

## âš™ï¸ ì£¼ìš” AOP êµ¬í˜„

### **1. ë¶„ì‚°ë½ AOP**

```java
@Aspect
@Component
@RequiredArgsConstructor
public class DistributedLockAspect {

    private final RedissonClient redissonClient;
    private final DistributedLockLogger logger;

    @Around("@annotation(distributedLock)")
    public Object executeWithLock(ProceedingJoinPoint joinPoint, DistributedLock distributedLock) throws Throwable {
        String lockKey = generateLockKey(joinPoint, distributedLock);
        RLock lock = redissonClient.getLock(lockKey);

        try {
            boolean acquired = lock.tryLock(distributedLock.waitTime(), distributedLock.leaseTime(), distributedLock.timeUnit());
            if (!acquired) {
                throw new DistributedLockException("ë¶„ì‚°ë½ íšë“ ì‹¤íŒ¨: " + lockKey);
            }

            logger.logLockAcquired(lockKey);
            return joinPoint.proceed();

        } catch (Exception e) {
            logger.logLockError(lockKey, e);
            throw e;
        } finally {
            if (lock.isHeldByCurrentThread()) {
                lock.unlock();
                logger.logLockReleased(lockKey);
            }
        }
    }
}
```

### **2. ê¶Œí•œ ê²€ì¦ AOP**

```java
@Aspect
@Component
@RequiredArgsConstructor
public class DataAuthPolicyAspect {

    private final DataQueryService dataQueryService;
    private final AuthLogger logger;

    @Around("@annotation(authorizationDataEdit)")
    public Object validateDataOwnership(ProceedingJoinPoint joinPoint, AuthorizationDataEdit authorizationDataEdit) throws Throwable {
        Long dataId = extractDataId(joinPoint);
        Long currentUserId = getCurrentUserId();

        Data data = dataQueryService.findById(dataId);
        if (data == null) {
            throw new DataException(DataErrorStatus.DATA_NOT_FOUND);
        }

        if (!data.getUserId().equals(currentUserId)) {
            logger.logUnauthorizedAccess(currentUserId, dataId, "DATA_EDIT");
            throw new DataException(DataErrorStatus.UNAUTHORIZED_DATA_ACCESS);
        }

        logger.logAuthorizedAccess(currentUserId, dataId, "DATA_EDIT");
        return joinPoint.proceed();
    }
}
```

### **3. ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§ AOP**

```java
@Aspect
@Component
@RequiredArgsConstructor
public class DataAccessLatencyAspect {

    private final DataAccessLatencyLogger logger;

    @Around("execution(* com.dataracy.modules..adapter..*.*(..))")
    public Object measureLatency(ProceedingJoinPoint joinPoint) throws Throwable {
        long startTime = System.currentTimeMillis();
        String methodName = joinPoint.getSignature().getName();
        String className = joinPoint.getTarget().getClass().getSimpleName();

        try {
            Object result = joinPoint.proceed();
            long duration = System.currentTimeMillis() - startTime;

            logger.logSuccess(className, methodName, duration);
            MDC.put("latency", String.valueOf(duration));

            return result;
        } catch (Exception e) {
            long duration = System.currentTimeMillis() - startTime;
            logger.logError(className, methodName, duration, e);
            throw e;
        }
    }
}
```

### **4. í–‰ë™ ë¡œê·¸ AOP**

```java
@Aspect
@Component
@RequiredArgsConstructor
public class BehaviorLogActionAspect {

    private final BehaviorLogKafkaProducer behaviorLogProducer;
    private final BehaviorLogLogger logger;

    @Around("@annotation(trackClick)")
    public Object trackClick(ProceedingJoinPoint joinPoint, TrackClick trackClick) throws Throwable {
        Long userId = getCurrentUserId();
        String action = trackClick.action();
        String target = extractTarget(joinPoint);

        try {
            Object result = joinPoint.proceed();

            // í–‰ë™ ë¡œê·¸ ìƒì„± ë° ì „ì†¡
            BehaviorLog behaviorLog = BehaviorLog.builder()
                .userId(userId)
                .action(action)
                .target(target)
                .timestamp(LocalDateTime.now())
                .build();

            behaviorLogProducer.send(behaviorLog);
            logger.logBehaviorTracked(userId, action, target);

            return result;
        } catch (Exception e) {
            logger.logBehaviorTrackingError(userId, action, target, e);
            throw e;
        }
    }
}
```

<br/>

## ğŸ”§ AOP í™œìš© ì˜ˆì‹œ

### **ë¶„ì‚°ë½ ì ìš©**

```java
@Service
@RequiredArgsConstructor
public class ProjectCommandService {

    @DistributedLock(key = "'project:' + #projectId", waitTime = 5, leaseTime = 10)
    public void likeProject(Long projectId, Long userId) {
        // ë™ì‹œì„± ì œì–´ê°€ í•„ìš”í•œ ì¢‹ì•„ìš” ì²˜ë¦¬
        projectRepository.incrementLikeCount(projectId);
    }
}
```

### **ê¶Œí•œ ê²€ì¦ ì ìš©**

```java
@Service
@RequiredArgsConstructor
public class DataCommandService {

    @AuthorizationDataEdit
    public void updateData(Long dataId, UpdateDataRequest request) {
        // ë°ì´í„° ì†Œìœ ê¶Œ ìë™ ê²€ì¦ í›„ ìˆ˜ì • ì²˜ë¦¬
        dataRepository.update(dataId, request);
    }

    @AuthorizationDataEdit(restore = true)
    public void restoreData(Long dataId) {
        // ë°ì´í„° ì†Œìœ ê¶Œ ìë™ ê²€ì¦ í›„ ë³µì› ì²˜ë¦¬
        dataRepository.restore(dataId);
    }
}
```

### **í–‰ë™ ë¡œê·¸ ì ìš©**

```java
@RestController
@RequiredArgsConstructor
public class ProjectController {

    @GetMapping("/projects/{id}")
    @TrackClick(action = "VIEW_PROJECT", target = "#projectId")
    public ProjectDetailResponse getProject(@PathVariable Long projectId) {
        // í”„ë¡œì íŠ¸ ì¡°íšŒ ì‹œ ìë™ìœ¼ë¡œ í–‰ë™ ë¡œê·¸ ìˆ˜ì§‘
        return projectQueryService.getProject(projectId);
    }
}
```

<br/>

## ğŸš€ ì‹¤ì œ ì„±ê³¼

- **ë™ì‹œì„± ì œì–´**: ë¶„ì‚°ë½ìœ¼ë¡œ ë°ì´í„° ì •í•©ì„± 100% ë³´ì¥
- **ë³´ì•ˆ ê°•í™”**: AOP ê¸°ë°˜ ê¶Œí•œ ê²€ì¦ìœ¼ë¡œ ë¹„ì¸ê°€ ì ‘ê·¼ ì°¨ë‹¨
- **ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§**: ê³„ì¸µë³„ ì§€ì—°ì‹œê°„ ì¸¡ì •ìœ¼ë¡œ ë³‘ëª© ì§€ì  íŒŒì•…
- **ì‚¬ìš©ì ë¶„ì„**: í–‰ë™ ë¡œê·¸ë¡œ ì‚¬ìš©ì íŒ¨í„´ ë¶„ì„ ë° ê°œì„ ì  ë„ì¶œ

<br/>

---

# ğŸ“¨ 10. Kafka ì´ë²¤íŠ¸ ì²˜ë¦¬ ì‹œìŠ¤í…œ

## ğŸ“Œ í•µì‹¬ ì´ë²¤íŠ¸ ì „ëµ

- **ë¹„ë™ê¸° ë¶„ë¦¬**: API ì‘ë‹µê³¼ ë°±ê·¸ë¼ìš´ë“œ ì²˜ë¦¬ ë¶„ë¦¬ë¡œ ì„±ëŠ¥ í–¥ìƒ
- **ì´ë²¤íŠ¸ ê¸°ë°˜**: ë„ë©”ì¸ ì´ë²¤íŠ¸ë¥¼ í†µí•œ ëŠìŠ¨í•œ ê²°í•© êµ¬í˜„
- **ìˆœì„œ ë³´ì¥**: í‚¤ ê¸°ë°˜ íŒŒí‹°ì…”ë‹ìœ¼ë¡œ ë™ì¼ ë¦¬ì†ŒìŠ¤ ìˆœì„œ ë³´ì¥
- **ì¥ì•  ê²©ë¦¬**: DLQë¥¼ í†µí•œ ì‹¤íŒ¨ ì‘ì—… ê²©ë¦¬ ë° ì¬ì²˜ë¦¬

<br/>

## ğŸ—ï¸ ì´ë²¤íŠ¸ ì•„í‚¤í…ì²˜

```plaintext
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ğŸŒ Web Layer (Controller)                â”‚
â”‚  â€¢ API ìš”ì²­ â€¢ ì´ë²¤íŠ¸ ë°œí–‰ â€¢ ì‘ë‹µ ë°˜í™˜                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                ğŸ“‹ Application Layer (Service)               â”‚
â”‚  â€¢ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ â€¢ ì´ë²¤íŠ¸ ìƒì„± â€¢ íŠ¸ëœì­ì…˜ ê´€ë¦¬              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                ğŸ”Œ Infrastructure Layer                      â”‚
â”‚  â€¢ Kafka Producer â€¢ Consumer â€¢ DLQ â€¢ ì¬ì‹œë„ ì •ì±…           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

<br/>

## âš™ï¸ ì´ë²¤íŠ¸ ì„¤ê³„

### **ë©”ì‹œì§€ íƒ€ì…**

```java
// ë„ë©”ì¸ ì´ë²¤íŠ¸
@Data
@Builder
public class DataUploadEvent {
    private Long dataId;
    private String dataFileUrl;
    private String originalFilename;
    private Long userId;
    private LocalDateTime timestamp;
}

// ê²½ëŸ‰ íŠ¸ë¦¬ê±°
@Data
@Builder
public class ProjectLikeEvent {
    private Long projectId;
    private Long userId;
    private String action; // "INCREASE" or "DECREASE"
    private LocalDateTime timestamp;
}

// í–‰ë™ ë¡œê·¸
@Data
@Builder
public class BehaviorLogEvent {
    private Long userId;
    private String action;
    private String target;
    private String uri;
    private String method;
    private Long durationMs;
    private Integer statusCode;
    private LocalDateTime timestamp;
}
```

### **í† í”½ ì„¤ê³„**

```yaml
# application.yml
spring:
  kafka:
    producer:
      extract-metadata:
        topic: data-uploaded
      project-like-increase:
        topic: project-like-increase-topic
      project-like-decrease:
        topic: project-like-decrease-topic
      comment-upload:
        topic: comment-uploaded-topic
      comment-delete:
        topic: comment-deleted-topic
      behavior-log:
        topic: behavior-logs
```

<br/>

## ğŸ”„ Producer êµ¬í˜„

### **ë°ì´í„° ì—…ë¡œë“œ ì´ë²¤íŠ¸**

```java
@Component
@RequiredArgsConstructor
public class DataKafkaProducerAdapter {

    private final KafkaTemplate<String, DataUploadEvent> kafkaTemplate;
    private final KafkaLogger logger;

    public void sendDataUploadEvent(Long dataId, String dataFileUrl, String originalFilename, Long userId) {
        DataUploadEvent event = DataUploadEvent.builder()
            .dataId(dataId)
            .dataFileUrl(dataFileUrl)
            .originalFilename(originalFilename)
            .userId(userId)
            .timestamp(LocalDateTime.now())
            .build();

        try {
            kafkaTemplate.send("data-uploaded", String.valueOf(dataId), event);
            logger.logEventSent("data-uploaded", dataId, event);
        } catch (Exception e) {
            logger.logEventSendError("data-uploaded", dataId, e);
            throw new KafkaException("ì´ë²¤íŠ¸ ë°œì†¡ ì‹¤íŒ¨", e);
        }
    }
}
```

### **í”„ë¡œì íŠ¸ ì¢‹ì•„ìš” ì´ë²¤íŠ¸**

```java
@Component
@RequiredArgsConstructor
public class LikeKafkaProducerAdapter {

    private final KafkaTemplate<String, Long> kafkaTemplate;
    private final KafkaLogger logger;

    public void sendProjectLikeIncrease(Long projectId) {
        try {
            kafkaTemplate.send("project-like-increase-topic", String.valueOf(projectId), projectId);
            logger.logEventSent("project-like-increase-topic", projectId, projectId);
        } catch (Exception e) {
            logger.logEventSendError("project-like-increase-topic", projectId, e);
            throw new KafkaException("ì¢‹ì•„ìš” ì¦ê°€ ì´ë²¤íŠ¸ ë°œì†¡ ì‹¤íŒ¨", e);
        }
    }

    public void sendProjectLikeDecrease(Long projectId) {
        try {
            kafkaTemplate.send("project-like-decrease-topic", String.valueOf(projectId), projectId);
            logger.logEventSent("project-like-decrease-topic", projectId, projectId);
        } catch (Exception e) {
            logger.logEventSendError("project-like-decrease-topic", projectId, e);
            throw new KafkaException("ì¢‹ì•„ìš” ê°ì†Œ ì´ë²¤íŠ¸ ë°œì†¡ ì‹¤íŒ¨", e);
        }
    }
}
```

<br/>

## ğŸ“¥ Consumer êµ¬í˜„

### **ë°ì´í„° ë©”íƒ€ë°ì´í„° ì¶”ì¶œ**

```java
@Component
@RequiredArgsConstructor
public class DataKafkaConsumerAdapter {

    private final ParseMetadataService parseMetadataService;
    private final KafkaLogger logger;

    @KafkaListener(topics = "data-uploaded", groupId = "data-metadata-extractor")
    public void consumeDataUploadEvent(DataUploadEvent event) {
        try {
            logger.logEventReceived("data-uploaded", event.getDataId(), event);

            // íŒŒì¼ ë©”íƒ€ë°ì´í„° ì¶”ì¶œ ë° ì €ì¥
            parseMetadataService.extractAndSaveMetadata(
                event.getDataId(),
                event.getDataFileUrl(),
                event.getOriginalFilename()
            );

            logger.logEventProcessed("data-uploaded", event.getDataId());
        } catch (Exception e) {
            logger.logEventProcessingError("data-uploaded", event.getDataId(), e);
            throw e; // ì¬ì‹œë„/ë°±ì˜¤í”„ ì •ì±… ì ìš©
        }
    }
}
```

### **í”„ë¡œì íŠ¸ í†µê³„ ì—…ë°ì´íŠ¸**

```java
@Component
@RequiredArgsConstructor
public class ProjectKafkaConsumerAdapter {

    private final ProjectCommandService projectCommandService;
    private final KafkaLogger logger;

    @KafkaListener(topics = "project-like-increase-topic", groupId = "project-stats-updater")
    public void consumeLikeIncrease(Long projectId) {
        try {
            logger.logEventReceived("project-like-increase-topic", projectId, projectId);

            // í”„ë¡œì íŠ¸ ì¢‹ì•„ìš” ìˆ˜ ì¦ê°€
            projectCommandService.incrementLikeCount(projectId);

            logger.logEventProcessed("project-like-increase-topic", projectId);
        } catch (Exception e) {
            logger.logEventProcessingError("project-like-increase-topic", projectId, e);
            throw e; // ì¬ì‹œë„/ë°±ì˜¤í”„ ì •ì±… ì ìš©
        }
    }

    @KafkaListener(topics = "comment-uploaded-topic", groupId = "project-stats-updater")
    public void consumeCommentUpload(Long projectId) {
        try {
            logger.logEventReceived("comment-uploaded-topic", projectId, projectId);

            // í”„ë¡œì íŠ¸ ëŒ“ê¸€ ìˆ˜ ì¦ê°€
            projectCommandService.incrementCommentCount(projectId);

            logger.logEventProcessed("comment-uploaded-topic", projectId);
        } catch (Exception e) {
            logger.logEventProcessingError("comment-uploaded-topic", projectId, e);
            throw e; // ì¬ì‹œë„/ë°±ì˜¤í”„ ì •ì±… ì ìš©
        }
    }
}
```

<br/>

## ğŸ›¡ï¸ ì‹ ë¢°ì„± ìš´ì˜

### **ì¬ì‹œë„/ë°±ì˜¤í”„ ì •ì±…**

```yaml
# application.yml
spring:
  kafka:
    consumer:
      properties:
        retries: 3
        retry.backoff.ms: 1000
        max.poll.interval.ms: 300000
        session.timeout.ms: 10000
        heartbeat.interval.ms: 3000
        enable.auto.commit: false
        auto.offset.reset: earliest
```

### **DLQ (Dead Letter Queue) ì„¤ì •**

```java
@Configuration
@RequiredArgsConstructor
public class KafkaConfig {

    @Bean
    public DeadLetterPublishingRecoverer deadLetterPublishingRecoverer(
            KafkaTemplate<String, Object> kafkaTemplate) {
        return new DeadLetterPublishingRecoverer(kafkaTemplate, (record, ex) -> {
            String originalTopic = record.topic();
            String dlqTopic = originalTopic + "-dlq";

            return new TopicPartition(dlqTopic, record.partition());
        });
    }

    @Bean
    public RetryTemplate retryTemplate() {
        return RetryTemplate.builder()
            .maxAttempts(3)
            .exponentialBackoff(1000, 2, 10000)
            .build();
    }
}
```

<br/>

## ğŸš€ ì‹¤ì œ ì„±ê³¼

- **ì„±ëŠ¥ í–¥ìƒ**: API ì‘ë‹µê³¼ ë°±ê·¸ë¼ìš´ë“œ ì²˜ë¦¬ ë¶„ë¦¬ë¡œ ì‘ë‹µ ì‹œê°„ 50% ë‹¨ì¶•
- **í™•ì¥ì„±**: ì´ë²¤íŠ¸ ê¸°ë°˜ ì•„í‚¤í…ì²˜ë¡œ ìƒˆë¡œìš´ ê¸°ëŠ¥ ì¶”ê°€ ìš©ì´
- **ì•ˆì •ì„±**: DLQì™€ ì¬ì‹œë„ ì •ì±…ìœ¼ë¡œ ì¥ì•  ê²©ë¦¬ ë° ë³µêµ¬
- **ëª¨ë‹ˆí„°ë§**: ì´ë²¤íŠ¸ íë¦„ ì¶”ì ìœ¼ë¡œ ì‹œìŠ¤í…œ ìƒíƒœ ê°€ì‹œì„± í™•ë³´

<br/>

---

# ğŸ” 11. Elasticsearch ê²€ìƒ‰ ì‹œìŠ¤í…œ

## ğŸ“Œ í•µì‹¬ ê²€ìƒ‰ ì „ëµ

- **ì „ë¬¸ ê²€ìƒ‰**: ë‚´ìš© ê¸°ë°˜ ìœ ì‚¬ë„ ê²€ìƒ‰ê³¼ ê°€ì¤‘ì¹˜ ë­í‚¹
- **ì‹¤ì‹œê°„ ìƒ‰ì¸**: DB ë³€ê²½ì‚¬í•­ì„ ESì— ë¹„ë™ê¸° ë°˜ì˜
- **ì„±ëŠ¥ ìµœì í™”**: ë³µì¡í•œ ê²€ìƒ‰ ì¿¼ë¦¬ë¥¼ ESì—ì„œ ì²˜ë¦¬í•˜ì—¬ DB ë¶€í•˜ ê°ì†Œ
- **ìë™ì™„ì„±**: ì‹¤ì‹œê°„ ê²€ìƒ‰ì–´ ì œì•ˆ ë° ìë™ì™„ì„± ê¸°ëŠ¥

<br/>

## ğŸ—ï¸ ê²€ìƒ‰ ì•„í‚¤í…ì²˜

```plaintext
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ğŸŒ Web Layer (Controller)                â”‚
â”‚  â€¢ ê²€ìƒ‰ ìš”ì²­ â€¢ ìë™ì™„ì„± â€¢ ìœ ì‚¬ í”„ë¡œì íŠ¸ ì¶”ì²œ                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                ğŸ“‹ Application Layer (Service)               â”‚
â”‚  â€¢ ê²€ìƒ‰ ë¡œì§ â€¢ ì¿¼ë¦¬ ë¹Œë” â€¢ ê²°ê³¼ ë³€í™˜                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                ğŸ”Œ Infrastructure Layer                      â”‚
â”‚  â€¢ Elasticsearch â€¢ Kibana â€¢ ìƒ‰ì¸ ê´€ë¦¬ â€¢ ê²€ìƒ‰ ì¿¼ë¦¬           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

<br/>

## âš™ï¸ ì¸ë±ìŠ¤ ì„¤ê³„

### **í”„ë¡œì íŠ¸ ì¸ë±ìŠ¤ ë§¤í•‘**

```json
{
  "mappings": {
    "properties": {
      "id": { "type": "long" },
      "title": {
        "type": "text",
        "analyzer": "korean",
        "fields": {
          "keyword": { "type": "keyword" }
        }
      },
      "content": {
        "type": "text",
        "analyzer": "korean"
      },
      "username": {
        "type": "text",
        "analyzer": "korean"
      },
      "thumbnailUrl": { "type": "keyword" },
      "commentCount": { "type": "long" },
      "likeCount": { "type": "long" },
      "viewCount": { "type": "long" },
      "isDeleted": { "type": "boolean" },
      "createdAt": { "type": "date" },
      "topicId": { "type": "long" },
      "analysisPurposeId": { "type": "long" },
      "dataSourceId": { "type": "long" },
      "authorLevelId": { "type": "long" }
    }
  }
}
```

### **ìƒ‰ì¸ ë¬¸ì„œ êµ¬ì¡°**

```java
@Data
@Builder
public class ProjectSearchDocument {
    private Long id;
    private String title;
    private String content;
    private String username;
    private String thumbnailUrl;
    private Long commentCount;
    private Long likeCount;
    private Long viewCount;
    private Boolean isDeleted;
    private LocalDateTime createdAt;
    private Long topicId;
    private Long analysisPurposeId;
    private Long dataSourceId;
    private Long authorLevelId;
}
```

<br/>

## ğŸ” ê²€ìƒ‰ ì¿¼ë¦¬ êµ¬í˜„

### **ì‹¤ì‹œê°„ ê²€ìƒ‰/ìë™ì™„ì„±**

```java
@Repository
@RequiredArgsConstructor
public class ProjectElasticsearchAdapter {

    private final ElasticsearchRestTemplate elasticsearchTemplate;
    private final ElasticLogger logger;

    public List<ProjectSearchDocument> searchProjects(String query, int size) {
        try {
            // Multi-match ì¿¼ë¦¬ë¡œ ì œëª©ê³¼ ë‚´ìš© ê²€ìƒ‰
            MultiMatchQueryBuilder multiMatchQuery = QueryBuilders.multiMatchQuery(query)
                .field("title", 3.0f) // ì œëª©ì— 3ë°° ê°€ì¤‘ì¹˜
                .field("username", 2.0f) // ì‘ì„±ìì— 2ë°° ê°€ì¤‘ì¹˜
                .field("content", 1.0f) // ë‚´ìš©ì— 1ë°° ê°€ì¤‘ì¹˜
                .fuzziness(Fuzziness.AUTO)
                .type(MultiMatchQueryBuilder.Type.BEST_FIELDS);

            // ì‚­ì œë˜ì§€ ì•Šì€ í”„ë¡œì íŠ¸ë§Œ ê²€ìƒ‰
            BoolQueryBuilder boolQuery = QueryBuilders.boolQuery()
                .must(multiMatchQuery)
                .filter(QueryBuilders.termQuery("isDeleted", false));

            // ìƒì„±ì¼ ê¸°ì¤€ ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬
            Sort sort = Sort.by(Sort.Direction.DESC, "createdAt");

            NativeSearchQuery searchQuery = new NativeSearchQueryBuilder()
                .withQuery(boolQuery)
                .withSort(sort)
                .withPageable(PageRequest.of(0, size))
                .build();

            SearchHits<ProjectSearchDocument> searchHits = elasticsearchTemplate.search(
                searchQuery,
                ProjectSearchDocument.class
            );

            return searchHits.getSearchHits().stream()
                .map(SearchHit::getContent)
                .collect(Collectors.toList());

        } catch (Exception e) {
            logger.logSearchError(query, e);
            throw new ElasticsearchException("ê²€ìƒ‰ ì‹¤íŒ¨", e);
        }
    }
}
```

### **ìœ ì‚¬ í”„ë¡œì íŠ¸ ì¶”ì²œ**

```java
@Repository
@RequiredArgsConstructor
public class ProjectElasticsearchAdapter {

    public List<ProjectSearchDocument> findSimilarProjects(Long projectId, int size) {
        try {
            // More Like This ì¿¼ë¦¬ë¡œ ìœ ì‚¬í•œ í”„ë¡œì íŠ¸ ê²€ìƒ‰
            MoreLikeThisQueryBuilder moreLikeThisQuery = QueryBuilders.moreLikeThisQuery(
                new String[]{"title", "content"}, // ìœ ì‚¬ë„ ë¹„êµ í•„ë“œ
                new String[]{}, // ë¬¸ì„œ ID (ë¹„ì–´ìˆìœ¼ë©´ ì „ì²´ ë¬¸ì„œì—ì„œ ê²€ìƒ‰)
                MoreLikeThisQueryBuilder.ITEM[]::new
            )
            .minTermFreq(1)
            .minDocFreq(1)
            .maxQueryTerms(12)
            .minimumShouldMatch("30%");

            // íŠ¹ì • í”„ë¡œì íŠ¸ì™€ ìœ ì‚¬í•œ í”„ë¡œì íŠ¸ ê²€ìƒ‰
            MoreLikeThisQueryBuilder specificProjectQuery = QueryBuilders.moreLikeThisQuery(
                new String[]{"title", "content"},
                new String[]{projectId.toString()},
                MoreLikeThisQueryBuilder.ITEM[]::new
            )
            .minTermFreq(1)
            .minDocFreq(1)
            .maxQueryTerms(12)
            .minimumShouldMatch("30%");

            // ì‚­ì œë˜ì§€ ì•Šì€ í”„ë¡œì íŠ¸ë§Œ ê²€ìƒ‰
            BoolQueryBuilder boolQuery = QueryBuilders.boolQuery()
                .must(specificProjectQuery)
                .filter(QueryBuilders.termQuery("isDeleted", false))
                .mustNot(QueryBuilders.termQuery("id", projectId)); // ìê¸° ìì‹  ì œì™¸

            NativeSearchQuery searchQuery = new NativeSearchQueryBuilder()
                .withQuery(boolQuery)
                .withPageable(PageRequest.of(0, size))
                .build();

            SearchHits<ProjectSearchDocument> searchHits = elasticsearchTemplate.search(
                searchQuery,
                ProjectSearchDocument.class
            );

            return searchHits.getSearchHits().stream()
                .map(SearchHit::getContent)
                .collect(Collectors.toList());

        } catch (Exception e) {
            logger.logSimilarSearchError(projectId, e);
            throw new ElasticsearchException("ìœ ì‚¬ í”„ë¡œì íŠ¸ ê²€ìƒ‰ ì‹¤íŒ¨", e);
        }
    }
}
```

<br/>

## ğŸ”„ ìƒ‰ì¸ ê´€ë¦¬

### **í”„ë¡œì íŠ¸ ìƒ‰ì¸**

```java
@Component
@RequiredArgsConstructor
public class ProjectElasticsearchAdapter {

    private final ElasticsearchRestTemplate elasticsearchTemplate;
    private final ElasticLogger logger;

    public void indexProject(ProjectSearchDocument document) {
        try {
            elasticsearchTemplate.save(document);
            logger.logIndexSuccess(document.getId(), "project");
        } catch (Exception e) {
            logger.logIndexError(document.getId(), "project", e);
            throw new ElasticsearchException("í”„ë¡œì íŠ¸ ìƒ‰ì¸ ì‹¤íŒ¨", e);
        }
    }

    public void updateProject(ProjectSearchDocument document) {
        try {
            elasticsearchTemplate.save(document);
            logger.logUpdateSuccess(document.getId(), "project");
        } catch (Exception e) {
            logger.logUpdateError(document.getId(), "project", e);
            throw new ElasticsearchException("í”„ë¡œì íŠ¸ ì—…ë°ì´íŠ¸ ì‹¤íŒ¨", e);
        }
    }

    public void deleteProject(Long projectId) {
        try {
            elasticsearchTemplate.delete(String.valueOf(projectId), ProjectSearchDocument.class);
            logger.logDeleteSuccess(projectId, "project");
        } catch (Exception e) {
            logger.logDeleteError(projectId, "project", e);
            throw new ElasticsearchException("í”„ë¡œì íŠ¸ ì‚­ì œ ì‹¤íŒ¨", e);
        }
    }
}
```

### **ì¦ë¶„ ì—…ë°ì´íŠ¸**

```java
@Component
@RequiredArgsConstructor
public class ProjectElasticsearchAdapter {

    public void incrementCommentCount(Long projectId, Long increment) {
        try {
            UpdateRequest updateRequest = new UpdateRequest("project_index", String.valueOf(projectId));
            updateRequest.script(new Script(
                ScriptType.INLINE,
                "painless",
                "if (ctx._source.commentCount == null) { ctx._source.commentCount = 0 } " +
                "ctx._source.commentCount = Math.max(0, ctx._source.commentCount + params.increment)",
                Map.of("increment", increment)
            ));

            elasticsearchTemplate.update(updateRequest);
            logger.logIncrementSuccess(projectId, "commentCount", increment);
        } catch (Exception e) {
            logger.logIncrementError(projectId, "commentCount", e);
            throw new ElasticsearchException("ëŒ“ê¸€ ìˆ˜ ì¦ê°€ ì‹¤íŒ¨", e);
        }
    }
}
```

<br/>

## ğŸš€ ì‹¤ì œ ì„±ê³¼

- **ê²€ìƒ‰ ì„±ëŠ¥**: ë³µì¡í•œ ê²€ìƒ‰ ì¿¼ë¦¬ ì„±ëŠ¥ 50% í–¥ìƒ
- **ì‹¤ì‹œê°„ì„±**: DB ë³€ê²½ì‚¬í•­ì„ ESì— ë¹„ë™ê¸° ë°˜ì˜ìœ¼ë¡œ ìµœì‹  ë°ì´í„° ê²€ìƒ‰
- **ì‚¬ìš©ì ê²½í—˜**: ìë™ì™„ì„±ê³¼ ìœ ì‚¬ í”„ë¡œì íŠ¸ ì¶”ì²œìœ¼ë¡œ ì‚¬ìš©ì„± í–¥ìƒ
- **í™•ì¥ì„±**: ESì˜ ë¶„ì‚° ê²€ìƒ‰ìœ¼ë¡œ ëŒ€ìš©ëŸ‰ ë°ì´í„° ì²˜ë¦¬ ê°€ëŠ¥

<br/>

---

# ğŸ“ 12. íŒŒì¼ ì €ì¥ì†Œ & ì´ë©”ì¼ ì‹œìŠ¤í…œ

## ğŸ“Œ í•µì‹¬ ì €ì¥ì†Œ ì „ëµ

- **S3 íŒŒì¼ ì €ì¥**: ë¬´ì œí•œ ì €ì¥ ê³µê°„ê³¼ ê³ ê°€ìš©ì„± ë³´ì¥
- **PreSigned URL**: ë³´ì•ˆì„±ì„ ê³ ë ¤í•œ ì‹œê°„ ì œí•œ ë‹¤ìš´ë¡œë“œ
- **ì´ì¤‘ ì´ë©”ì¼ ì„œë¹„ìŠ¤**: SendGrid + SESë¡œ ì´ë©”ì¼ ì „ì†¡ ì•ˆì •ì„± í™•ë³´
- **ë©”íƒ€ë°ì´í„° ìµœì í™”**: íŒŒì¼ ì •ë³´ë¥¼ íš¨ìœ¨ì ìœ¼ë¡œ ê´€ë¦¬

<br/>

## ğŸ—ï¸ ì €ì¥ì†Œ ì•„í‚¤í…ì²˜

```plaintext
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ğŸŒ Web Layer (Controller)                â”‚
â”‚  â€¢ íŒŒì¼ ì—…ë¡œë“œ â€¢ ë‹¤ìš´ë¡œë“œ â€¢ ì´ë©”ì¼ ë°œì†¡                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                ğŸ“‹ Application Layer (Service)               â”‚
â”‚  â€¢ íŒŒì¼ ì²˜ë¦¬ ë¡œì§ â€¢ ì´ë©”ì¼ í…œí”Œë¦¿ â€¢ ë©”íƒ€ë°ì´í„° ê´€ë¦¬          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                ğŸ”Œ Infrastructure Layer                      â”‚
â”‚  â€¢ S3 â€¢ SendGrid â€¢ SES â€¢ íŒŒì¼ í‚¤ ìƒì„± â€¢ í…œí”Œë¦¿ ì—”ì§„         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

<br/>

## âš™ï¸ S3 íŒŒì¼ ì €ì¥

### **íŒŒì¼ ì—…ë¡œë“œ ìµœì í™”**

```java
@Component
@RequiredArgsConstructor
public class AwsS3FileStorageAdapter implements FileStoragePort {

    private final AmazonS3 amazonS3;
    private final S3Properties s3Properties;
    private final CommonLogger logger;

    @Override
    public String upload(String key, MultipartFile file) {
        try {
            ObjectMetadata metadata = new ObjectMetadata();
            metadata.setContentLength(file.getSize());
            metadata.setContentType(file.getContentType());

            try (InputStream inputStream = file.getInputStream()) {
                amazonS3.putObject(new PutObjectRequest(
                    s3Properties.getBucket(),
                    key,
                    inputStream,
                    metadata
                ));
            }

            logger.logFileUploadSuccess(key, file.getSize());
            return getUrl(key);

        } catch (IOException e) {
            logger.logFileUploadError(key, e);
            throw new S3UploadException("S3 ì—…ë¡œë“œ ì‹¤íŒ¨", e);
        }
    }

    @Override
    public String getPreSignedUrl(String fileUrl, int expirationSeconds) {
        try {
            String key = extractKeyFromUrl(fileUrl);
            GeneratePresignedUrlRequest request = new GeneratePresignedUrlRequest(
                s3Properties.getBucket(),
                key
            )
            .withMethod(HttpMethod.GET)
            .withExpiration(new Date(System.currentTimeMillis() + expirationSeconds * 1000));

            String preSignedUrl = amazonS3.generatePresignedUrl(request).toString();
            logger.logPreSignedUrlGenerated(key, expirationSeconds);

            return preSignedUrl;

        } catch (Exception e) {
            logger.logPreSignedUrlError(fileUrl, e);
            throw new S3Exception("PreSigned URL ìƒì„± ì‹¤íŒ¨", e);
        }
    }
}
```

### **íŒŒì¼ í‚¤ ìƒì„± ì „ëµ**

```java
@Component
public class S3KeyGeneratorUtil {

    public static String generateKey(String prefix, Long id, String originalFilename) {
        String extension = FileUtil.getFileExtension(originalFilename);
        return String.format("%s/%d/%s%s", prefix, id, UUID.randomUUID(), extension);
    }

    public static String generateProjectThumbnailKey(Long projectId, String originalFilename) {
        return generateKey("project", projectId, originalFilename);
    }

    public static String generateDataFileKey(Long dataId, String originalFilename) {
        return generateKey("data", dataId, originalFilename);
    }
}
```

<br/>

## ğŸ“§ ì´ë©”ì¼ ì‹œìŠ¤í…œ

### **SendGrid ì–´ëŒ‘í„°**

```java
@Component
@RequiredArgsConstructor
public class SendGridEmailAdapter implements EmailPort {

    private final SendGrid sendGrid;
    private final SendGridProperties sendGridProperties;
    private final EmailLogger logger;

    @Override
    public void send(String email, String subject, String body) {
        try {
            Email from = new Email(sendGridProperties.getSender());
            Email to = new Email(email);
            Content content = new Content("text/plain", body);
            Mail mail = new Mail(from, subject, to, content);

            Request request = new Request();
            request.setMethod(Method.POST);
            request.setEndpoint("mail/send");
            request.setBody(mail.build());

            Response response = sendGrid.api(request);

            if (response.getStatusCode() >= 400) {
                logger.logEmailSendError(email, response.getStatusCode());
                throw new EmailException("SendGrid ì „ì†¡ ì‹¤íŒ¨ - status: " + response.getStatusCode());
            }

            logger.logEmailSendSuccess(email, subject);

        } catch (Exception e) {
            logger.logEmailSendError(email, e);
            throw new EmailException("ì´ë©”ì¼ ì „ì†¡ ì‹¤íŒ¨", e);
        }
    }
}
```

### **SES ë°±ì—… ì–´ëŒ‘í„°**

```java
@Component
@RequiredArgsConstructor
public class SesEmailAdapter implements EmailPort {

    private final AmazonSimpleEmailService ses;
    private final SesProperties sesProperties;
    private final EmailLogger logger;

    @Override
    public void send(String email, String title, String body) {
        try {
            SendEmailRequest request = new SendEmailRequest()
                .withDestination(new Destination().withToAddresses(email))
                .withMessage(new Message()
                    .withSubject(new Content().withCharset("UTF-8").withData(title))
                    .withBody(new Body().withText(new Content().withCharset("UTF-8").withData(body))))
                .withSource(sesProperties.getSender());

            ses.sendEmail(request);
            logger.logEmailSendSuccess(email, title);

        } catch (Exception e) {
            logger.logEmailSendError(email, e);
            throw new EmailException("SES ì´ë©”ì¼ ì „ì†¡ ì‹¤íŒ¨", e);
        }
    }
}
```

### **ì´ì¤‘í™” ì´ë©”ì¼ ì„œë¹„ìŠ¤**

```java
@Service
@RequiredArgsConstructor
public class EmailService {

    private final SendGridEmailAdapter sendGridAdapter;
    private final SesEmailAdapter sesAdapter;
    private final EmailLogger logger;

    public void sendEmail(String email, String subject, String body) {
        try {
            // 1ì°¨: SendGrid ì‹œë„
            sendGridAdapter.send(email, subject, body);
            logger.logEmailServiceUsed("SendGrid", email);

        } catch (Exception sendGridError) {
            logger.logEmailServiceFallback("SendGrid", "SES", email, sendGridError);

            try {
                // 2ì°¨: SES ë°±ì—…
                sesAdapter.send(email, subject, body);
                logger.logEmailServiceUsed("SES", email);

            } catch (Exception sesError) {
                logger.logEmailServiceFailure("SES", email, sesError);
                throw new EmailException("ëª¨ë“  ì´ë©”ì¼ ì„œë¹„ìŠ¤ ì‹¤íŒ¨", sesError);
            }
        }
    }
}
```

<br/>

## ğŸ¯ ì´ë©”ì¼ í…œí”Œë¦¿ ì‹œìŠ¤í…œ

### **í…œí”Œë¦¿ ì—”ì§„**

```java
@Component
@RequiredArgsConstructor
public class EmailTemplateService {

    private final TemplateEngine templateEngine;
    private final EmailLogger logger;

    public String generateWelcomeEmail(String username) {
        try {
            Context context = new Context();
            context.setVariable("username", username);
            context.setVariable("currentYear", LocalDate.now().getYear());

            String template = templateEngine.process("welcome-email", context);
            logger.logTemplateGenerated("welcome-email", username);

            return template;

        } catch (Exception e) {
            logger.logTemplateError("welcome-email", username, e);
            throw new EmailException("ì´ë©”ì¼ í…œí”Œë¦¿ ìƒì„± ì‹¤íŒ¨", e);
        }
    }

    public String generatePasswordResetEmail(String username, String resetToken) {
        try {
            Context context = new Context();
            context.setVariable("username", username);
            context.setVariable("resetToken", resetToken);
            context.setVariable("resetUrl", "https://dataracy.com/reset-password?token=" + resetToken);

            String template = templateEngine.process("password-reset-email", context);
            logger.logTemplateGenerated("password-reset-email", username);

            return template;

        } catch (Exception e) {
            logger.logTemplateError("password-reset-email", username, e);
            throw new EmailException("ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì • ì´ë©”ì¼ í…œí”Œë¦¿ ìƒì„± ì‹¤íŒ¨", e);
        }
    }
}
```

<br/>

## ğŸš€ ì‹¤ì œ ì„±ê³¼

- **íŒŒì¼ ì•ˆì •ì„±**: S3ì˜ 99.999999999% ë‚´êµ¬ì„±ìœ¼ë¡œ íŒŒì¼ ì†ì‹¤ ë°©ì§€
- **ë³´ì•ˆì„±**: PreSigned URLë¡œ ì œì–´ëœ íŒŒì¼ ì ‘ê·¼
- **ì´ë©”ì¼ ì‹ ë¢°ë„**: ì´ì¤‘í™” ì„œë¹„ìŠ¤ë¡œ 100% ì „ì†¡ ì„±ê³µë¥  ë‹¬ì„±
- **í™•ì¥ì„±**: ë¬´ì œí•œ íŒŒì¼ ì €ì¥ê³¼ ëŒ€ìš©ëŸ‰ ì´ë©”ì¼ ì²˜ë¦¬ ê°€ëŠ¥

<br/>

---

# ğŸ“Š 13. ëª¨ë‹ˆí„°ë§ & ë¡œê¹… ì‹œìŠ¤í…œ

## ğŸ“Œ í•µì‹¬ ëª¨ë‹ˆí„°ë§ ì „ëµ

- **ì‹¤ì‹œê°„ ë©”íŠ¸ë¦­**: Micrometer + Prometheus + Grafanaë¡œ ì‹œìŠ¤í…œ ìƒíƒœ ëª¨ë‹ˆí„°ë§
- **í–‰ë™ ë¡œê·¸**: ì‚¬ìš©ì í–‰ë™ ì¶”ì ìœ¼ë¡œ UX ê°œì„ ì  ë„ì¶œ
- **ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§**: ê³„ì¸µë³„ ì§€ì—°ì‹œê°„ ì¸¡ì •ìœ¼ë¡œ ë³‘ëª© ì§€ì  íŒŒì•…
- **ì•Œë¦¼ ì‹œìŠ¤í…œ**: ì„ê³„ì¹˜ ì´ˆê³¼ ì‹œ ì‹¤ì‹œê°„ ì•Œë¦¼ìœ¼ë¡œ ë¹ ë¥¸ ëŒ€ì‘

<br/>

## ğŸ—ï¸ ëª¨ë‹ˆí„°ë§ ì•„í‚¤í…ì²˜

```plaintext
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ğŸŒ Application Layer                     â”‚
â”‚  â€¢ Micrometer ë©”íŠ¸ë¦­ â€¢ MDC ë¡œê¹… â€¢ AOP ëª¨ë‹ˆí„°ë§              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                ğŸ“Š Monitoring Layer                          â”‚
â”‚  â€¢ Prometheus â€¢ Grafana â€¢ Kibana â€¢ Slack ì•Œë¦¼              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                ğŸ”Œ Infrastructure Layer                      â”‚
â”‚  â€¢ Elasticsearch â€¢ Redis â€¢ Kafka â€¢ MySQL â€¢ S3              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

<br/>

## âš™ï¸ ë©”íŠ¸ë¦­ ìˆ˜ì§‘

### **Micrometer ì„¤ì •**

```java
@Configuration
@RequiredArgsConstructor
public class MetricsConfig {

    @Bean
    public MeterRegistry meterRegistry() {
        return new PrometheusMeterRegistry(PrometheusConfig.DEFAULT);
    }

    @Bean
    public TimedAspect timedAspect(MeterRegistry meterRegistry) {
        return new TimedAspect(meterRegistry);
    }

    @Bean
    public CountedAspect countedAspect(MeterRegistry meterRegistry) {
        return new CountedAspect(meterRegistry);
    }
}
```

### **ì»¤ìŠ¤í…€ ë©”íŠ¸ë¦­**

```java
@Component
@RequiredArgsConstructor
public class CustomMetrics {

    private final MeterRegistry meterRegistry;

    private final Counter projectViewCounter;
    private final Counter projectLikeCounter;
    private final Timer projectSearchTimer;
    private final Gauge activeUsersGauge;

    public CustomMetrics(MeterRegistry meterRegistry) {
        this.meterRegistry = meterRegistry;
        this.projectViewCounter = Counter.builder("project.views")
            .description("Total project views")
            .register(meterRegistry);
        this.projectLikeCounter = Counter.builder("project.likes")
            .description("Total project likes")
            .register(meterRegistry);
        this.projectSearchTimer = Timer.builder("project.search.duration")
            .description("Project search duration")
            .register(meterRegistry);
        this.activeUsersGauge = Gauge.builder("users.active")
            .description("Active users count")
            .register(meterRegistry, this, CustomMetrics::getActiveUsersCount);
    }

    public void incrementProjectViews() {
        projectViewCounter.increment();
    }

    public void incrementProjectLikes() {
        projectLikeCounter.increment();
    }

    public void recordSearchDuration(Duration duration) {
        projectSearchTimer.record(duration);
    }

    private double getActiveUsersCount() {
        // Redisì—ì„œ í™œì„± ì‚¬ìš©ì ìˆ˜ ì¡°íšŒ
        return redisTemplate.opsForValue().get("active_users_count");
    }
}
```

<br/>

## ğŸ“ ë¡œê¹… ì‹œìŠ¤í…œ

### **ê³„ì¸µë³„ ë¡œê±°**

```java
public class LoggerFactory {
    private static final ApiLogger API_LOGGER = new ApiLogger();
    private static final ServiceLogger SERVICE_LOGGER = new ServiceLogger();
    private static final DomainLogger DOMAIN_LOGGER = new DomainLogger();
    private static final PersistenceLogger PERSISTENCE_LOGGER = new PersistenceLogger();
    private static final QueryDslLogger QUERY_DSL_LOGGER = new QueryDslLogger();
    private static final KafkaLogger KAFKA_LOGGER = new KafkaLogger();
    private static final ElasticLogger ELASTIC_LOGGER = new ElasticLogger();
    private static final RedisLogger REDIS_LOGGER = new RedisLogger();
    private static final SchedulerLogger SCHEDULER_LOGGER = new SchedulerLogger();
    private static final DistributedLockLogger DISTRIBUTED_LOCK_LOGGER = new DistributedLockLogger();
    private static final CommonLogger COMMON_LOGGER = new CommonLogger();

    public static ApiLogger api() { return API_LOGGER; }
    public static ServiceLogger service() { return SERVICE_LOGGER; }
    public static DomainLogger domain() { return DOMAIN_LOGGER; }
    public static PersistenceLogger persistence() { return PERSISTENCE_LOGGER; }
    public static QueryDslLogger queryDsl() { return QUERY_DSL_LOGGER; }
    public static KafkaLogger kafka() { return KAFKA_LOGGER; }
    public static ElasticLogger elastic() { return ELASTIC_LOGGER; }
    public static RedisLogger redis() { return REDIS_LOGGER; }
    public static SchedulerLogger scheduler() { return SCHEDULER_LOGGER; }
    public static DistributedLockLogger distributedLock() { return DISTRIBUTED_LOCK_LOGGER; }
    public static CommonLogger common() { return COMMON_LOGGER; }
}
```

### **MDC ê¸°ë°˜ ë¡œê¹…**

```java
@Component
@RequiredArgsConstructor
public class ApiLogger {

    private final Logger logger = LoggerFactory.getLogger(ApiLogger.class);

    public void logRequest(String method, String uri, String userId) {
        MDC.put("method", method);
        MDC.put("uri", uri);
        MDC.put("userId", userId);
        MDC.put("timestamp", LocalDateTime.now().toString());

        logger.info("API ìš”ì²­: {} {}", method, uri);
    }

    public void logResponse(String method, String uri, int statusCode, long duration) {
        MDC.put("statusCode", String.valueOf(statusCode));
        MDC.put("duration", String.valueOf(duration));

        logger.info("API ì‘ë‹µ: {} {} - {} ({}ms)", method, uri, statusCode, duration);

        // MDC ì •ë¦¬
        MDC.clear();
    }

    public void logError(String method, String uri, Exception e) {
        MDC.put("error", e.getMessage());
        MDC.put("errorType", e.getClass().getSimpleName());

        logger.error("API ì˜¤ë¥˜: {} {} - {}", method, uri, e.getMessage(), e);

        // MDC ì •ë¦¬
        MDC.clear();
    }
}
```

<br/>

## ğŸ” í–‰ë™ ë¡œê·¸ ì‹œìŠ¤í…œ

### **í–‰ë™ ë¡œê·¸ ëª¨ë¸**

```java
@Data
@Builder
public class BehaviorLog {
    private String requestId;
    private Long userId;
    private String anonymousId;
    private String uri;
    private String method;
    private Long durationMs;
    private Integer statusCode;
    private String userAgent;
    private String ip;
    private LocalDateTime timestamp;

    public boolean isValid() {
        return requestId != null &&
               (userId != null || anonymousId != null) &&
               uri != null &&
               method != null;
    }
}
```

### **í–‰ë™ ë¡œê·¸ ìˆ˜ì§‘**

```java
@Component
@RequiredArgsConstructor
public class BehaviorLogCollector {

    private final BehaviorLogKafkaProducer behaviorLogProducer;
    private final BehaviorLogLogger logger;

    public void collectBehaviorLog(BehaviorLog behaviorLog) {
        if (!behaviorLog.isValid()) {
            logger.logInvalidBehaviorLog(behaviorLog);
            return;
        }

        try {
            behaviorLogProducer.send(behaviorLog);
            logger.logBehaviorLogCollected(behaviorLog);
        } catch (Exception e) {
            logger.logBehaviorLogCollectionError(behaviorLog, e);
        }
    }
}
```

<br/>

## ğŸ“Š Grafana ëŒ€ì‹œë³´ë“œ

### **í•µì‹¬ ë©”íŠ¸ë¦­**

```yaml
# prometheus.yml
scrape_configs:
  - job_name: "dataracy-app"
    static_configs:
      - targets: ["localhost:8080"]
    metrics_path: "/actuator/prometheus"
    scrape_interval: 15s
```

### **ëŒ€ì‹œë³´ë“œ íŒ¨ë„**

```json
{
  "dashboard": {
    "title": "Dataracy System Metrics",
    "panels": [
      {
        "title": "Request Rate",
        "type": "graph",
        "targets": [
          {
            "expr": "rate(http_server_requests_seconds_count[5m])",
            "legendFormat": "{{method}} {{uri}}"
          }
        ]
      },
      {
        "title": "Response Time",
        "type": "graph",
        "targets": [
          {
            "expr": "histogram_quantile(0.95, rate(http_server_requests_seconds_bucket[5m]))",
            "legendFormat": "95th percentile"
          }
        ]
      },
      {
        "title": "Error Rate",
        "type": "graph",
        "targets": [
          {
            "expr": "rate(http_server_requests_seconds_count{status=~\"5..\"}[5m])",
            "legendFormat": "5xx errors"
          }
        ]
      }
    ]
  }
}
```

<br/>

## ğŸš¨ ì•Œë¦¼ ì‹œìŠ¤í…œ

### **Slack ì•Œë¦¼**

```java
@Component
@RequiredArgsConstructor
public class SlackNotificationService {

    private final SlackWebhookClient slackClient;
    private final SlackProperties slackProperties;

    public void sendAlert(String message, String severity) {
        try {
            SlackMessage slackMessage = SlackMessage.builder()
                .channel(slackProperties.getChannel())
                .username("Dataracy Bot")
                .iconEmoji(":warning:")
                .text(String.format("[%s] %s", severity, message))
                .build();

            slackClient.send(slackMessage);

        } catch (Exception e) {
            logger.error("Slack ì•Œë¦¼ ì „ì†¡ ì‹¤íŒ¨", e);
        }
    }
}
```

<br/>

## ğŸš€ ì‹¤ì œ ì„±ê³¼

- **ê°€ì‹œì„±**: ì‹¤ì‹œê°„ ë©”íŠ¸ë¦­ìœ¼ë¡œ ì‹œìŠ¤í…œ ìƒíƒœ ì™„ì „ íˆ¬ëª…í™”
- **ë¹ ë¥¸ ëŒ€ì‘**: ì•Œë¦¼ ì‹œìŠ¤í…œìœ¼ë¡œ ì¥ì•  ë°œìƒ ì‹œ ì¦‰ì‹œ ëŒ€ì‘
- **ì‚¬ìš©ì ë¶„ì„**: í–‰ë™ ë¡œê·¸ë¡œ UX ê°œì„ ì  ë„ì¶œ
- **ì„±ëŠ¥ ìµœì í™”**: ê³„ì¸µë³„ ì§€ì—°ì‹œê°„ ì¸¡ì •ìœ¼ë¡œ ë³‘ëª© ì§€ì  íŒŒì•…

## <br/>

# ğŸ§ª 14. í…ŒìŠ¤íŠ¸ & í’ˆì§ˆ ê´€ë¦¬

## ğŸ“Œ í•µì‹¬ í…ŒìŠ¤íŠ¸ ì „ëµ

- **ì„±ëŠ¥ í…ŒìŠ¤íŠ¸**: k6ë¥¼ í™œìš©í•œ ë¶€í•˜ í…ŒìŠ¤íŠ¸ë¡œ ì„±ëŠ¥ íšŒê·€ ë°©ì§€
- **ìë™í™”ëœ PR ë¦¬ë·°**: LLM ê¸°ë°˜ ì½”ë“œ ë¦¬ë·°ë¡œ í’ˆì§ˆ í–¥ìƒ
- **ê³„ì¸µë³„ í…ŒìŠ¤íŠ¸**: ë‹¨ìœ„ í…ŒìŠ¤íŠ¸, í†µí•© í…ŒìŠ¤íŠ¸, E2E í…ŒìŠ¤íŠ¸ ì²´ê³„í™”
- **ì§€ì†ì  í’ˆì§ˆ ê´€ë¦¬**: Code Rabbitê³¼ ì»¤ìŠ¤í…€ ë¦¬ë·° ì‹œìŠ¤í…œ

<br/>

## ğŸ—ï¸ í…ŒìŠ¤íŠ¸ ì•„í‚¤í…ì²˜

```plaintext
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ğŸŒ Web Layer (Controller)                â”‚
â”‚  â€¢ API í…ŒìŠ¤íŠ¸ â€¢ í†µí•© í…ŒìŠ¤íŠ¸ â€¢ E2E í…ŒìŠ¤íŠ¸                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                ğŸ“‹ Application Layer (Service)               â”‚
â”‚  â€¢ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ â€¢ Mock í…ŒìŠ¤íŠ¸ â€¢ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ í…ŒìŠ¤íŠ¸          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                ğŸ”Œ Infrastructure Layer                      â”‚
â”‚  â€¢ TestContainers â€¢ Embedded DB â€¢ Mock ì„œë¹„ìŠ¤               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

<br/>

## âš™ï¸ k6 ì„±ëŠ¥ í…ŒìŠ¤íŠ¸

### **ë¡œê·¸ì¸ ì‹œë‚˜ë¦¬ì˜¤**

```javascript
// performance-test/auth/scenarios/login.test.js
import http from "k6/http";
import { check, sleep } from "k6";
import { Rate } from "k6/metrics";

const errorRate = new Rate("errors");

export let options = {
  stages: [
    { duration: "2m", target: 100 }, // 2ë¶„ê°„ 100ëª…ê¹Œì§€ ì¦ê°€
    { duration: "5m", target: 100 }, // 5ë¶„ê°„ 100ëª… ìœ ì§€
    { duration: "2m", target: 0 }, // 2ë¶„ê°„ 0ëª…ê¹Œì§€ ê°ì†Œ
  ],
  thresholds: {
    http_req_duration: ["p(95)<500"], // 95% ìš”ì²­ì´ 500ms ì´í•˜
    http_req_failed: ["rate<0.1"], // ì‹¤íŒ¨ìœ¨ 10% ì´í•˜
    errors: ["rate<0.1"], // ì—ëŸ¬ìœ¨ 10% ì´í•˜
  },
};

export default function () {
  const loginData = {
    email: `user${__VU}@example.com`,
    password: "password123",
  };

  const response = http.post(
    "http://localhost:8080/api/v1/auth/login",
    JSON.stringify(loginData),
    {
      headers: { "Content-Type": "application/json" },
    }
  );

  const success = check(response, {
    "login status is 200": (r) => r.status === 200,
    "response time < 500ms": (r) => r.timings.duration < 500,
    "response has access token": (r) =>
      JSON.parse(r.body).accessToken !== undefined,
  });

  errorRate.add(!success);
  sleep(1);
}
```

### **í”„ë¡œì íŠ¸ ê²€ìƒ‰ ì‹œë‚˜ë¦¬ì˜¤**

```javascript
// performance-test/project/scenarios/search.test.js
import http from "k6/http";
import { check, sleep } from "k6";
import { Rate } from "k6/metrics";

const errorRate = new Rate("errors");

export let options = {
  stages: [
    { duration: "1m", target: 50 },
    { duration: "3m", target: 50 },
    { duration: "1m", target: 0 },
  ],
  thresholds: {
    http_req_duration: ["p(95)<300"],
    http_req_failed: ["rate<0.05"],
    errors: ["rate<0.05"],
  },
};

export default function () {
  const searchQueries = ["ë°ì´í„° ë¶„ì„", "ë¨¸ì‹ ëŸ¬ë‹", "íŒŒì´ì¬", "í†µê³„", "ì‹œê°í™”"];

  const query = searchQueries[Math.floor(Math.random() * searchQueries.length)];
  const response = http.get(
    `http://localhost:8080/api/v1/projects/search?q=${query}&page=0&size=20`
  );

  const success = check(response, {
    "search status is 200": (r) => r.status === 200,
    "response time < 300ms": (r) => r.timings.duration < 300,
    "response has projects": (r) => JSON.parse(r.body).content.length > 0,
  });

  errorRate.add(!success);
  sleep(2);
}
```

<br/>

## ğŸ” ìë™í™”ëœ PR ë¦¬ë·°

### **LLM ê¸°ë°˜ ì½”ë“œ ë¦¬ë·°**

```python
# codereview-llm/reviewer.py
import openai
import json
from diff_parser import parse_diff
from prompt_file_review import generate_review_prompt

class CodeReviewer:
    def __init__(self, openai_api_key):
        self.client = openai.OpenAI(api_key=openai_api_key)

    def review_pull_request(self, pr_data):
        """PR ì „ì²´ë¥¼ ë¦¬ë·°í•˜ê³  ê°œì„ ì‚¬í•­ì„ ì œì•ˆí•©ë‹ˆë‹¤."""
        review_results = []

        for file_diff in pr_data['files']:
            if self.should_review_file(file_diff['filename']):
                review = self.review_file(file_diff)
                if review:
                    review_results.append(review)

        return self.generate_summary(review_results)

    def review_file(self, file_diff):
        """ê°œë³„ íŒŒì¼ì„ ë¦¬ë·°í•©ë‹ˆë‹¤."""
        diff_content = file_diff['patch']
        filename = file_diff['filename']

        prompt = generate_review_prompt(filename, diff_content)

        response = self.client.chat.completions.create(
            model="gpt-4",
            messages=[
                {"role": "system", "content": "ë‹¹ì‹ ì€ ê²½í—˜ ë§ì€ Java/Spring Boot ê°œë°œìì…ë‹ˆë‹¤."},
                {"role": "user", "content": prompt}
            ],
            temperature=0.3
        )

        return {
            'filename': filename,
            'review': response.choices[0].message.content,
            'suggestions': self.extract_suggestions(response.choices[0].message.content)
        }

    def should_review_file(self, filename):
        """ë¦¬ë·°í•  íŒŒì¼ì¸ì§€ íŒë‹¨í•©ë‹ˆë‹¤."""
        return filename.endswith('.java') and not filename.endswith('Test.java')

    def extract_suggestions(self, review_text):
        """ë¦¬ë·° í…ìŠ¤íŠ¸ì—ì„œ êµ¬ì²´ì ì¸ ê°œì„ ì‚¬í•­ì„ ì¶”ì¶œí•©ë‹ˆë‹¤."""
        suggestions = []
        lines = review_text.split('\n')

        for line in lines:
            if line.strip().startswith('- ') or line.strip().startswith('* '):
                suggestions.append(line.strip()[2:])

        return suggestions
```

### **GitHub Actions í†µí•©**

```yaml
# .github/workflows/code-review.yml
name: Code Review

on:
  pull_request:
    types: [opened, synchronize]

jobs:
  review:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
        with:
          fetch-depth: 0

      - name: Setup Python
        uses: actions/setup-python@v4
        with:
          python-version: "3.9"

      - name: Install dependencies
        run: |
          pip install -r codereview-llm/requirements.txt

      - name: Run LLM Code Review
        env:
          OPENAI_API_KEY: ${{ secrets.OPENAI_API_KEY }}
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        run: |
          python codereview-llm/reviewer.py \
            --pr-number ${{ github.event.pull_request.number }} \
            --repo ${{ github.repository }}

      - name: Post Review Comment
        uses: actions/github-script@v6
        with:
          script: |
            const fs = require('fs');
            const reviewResult = JSON.parse(fs.readFileSync('review_result.json', 'utf8'));

            github.rest.issues.createComment({
              issue_number: context.issue.number,
              owner: context.repo.owner,
              repo: context.repo.repo,
              body: reviewResult.summary
            });
```

<br/>

## ğŸ§ª ê³„ì¸µë³„ í…ŒìŠ¤íŠ¸

### **ë‹¨ìœ„ í…ŒìŠ¤íŠ¸**

```java
@ExtendWith(MockitoExtension.class)
class ProjectCommandServiceTest {

    @Mock
    private CreateProjectPort createProjectPort;
    @Mock
    private FileCommandUseCase fileCommandUseCase;
    @Mock
    private IndexProjectPort indexProjectPort;

    @InjectMocks
    private ProjectCommandService projectCommandService;

    @Test
    @DisplayName("í”„ë¡œì íŠ¸ ìƒì„± ì‹œ ì¸ë„¤ì¼ ì—…ë¡œë“œì™€ ìƒ‰ì¸ì´ ì •ìƒì ìœ¼ë¡œ ìˆ˜í–‰ëœë‹¤")
    void uploadProject_Success() {
        // Given
        UploadProjectRequest request = createUploadProjectRequest();
        Project savedProject = createProject();

        when(createProjectPort.create(any(Project.class))).thenReturn(savedProject);
        when(fileCommandUseCase.upload(anyString(), any(MultipartFile.class)))
            .thenReturn("https://s3.amazonaws.com/bucket/thumbnail.jpg");

        // When
        UploadProjectResponse response = projectCommandService.uploadProject(request);

        // Then
        assertThat(response.getProjectId()).isEqualTo(savedProject.getId());
        verify(createProjectPort).create(any(Project.class));
        verify(fileCommandUseCase).upload(anyString(), any(MultipartFile.class));
        verify(indexProjectPort).index(any(ProjectSearchDocument.class));
    }
}
```

### **í†µí•© í…ŒìŠ¤íŠ¸**

```java
@SpringBootTest
@Transactional
class ProjectIntegrationTest {

    @Autowired
    private ProjectCommandService projectCommandService;

    @Autowired
    private ProjectQueryService projectQueryService;

    @Test
    @DisplayName("í”„ë¡œì íŠ¸ ìƒì„± í›„ ì¡°íšŒê°€ ì •ìƒì ìœ¼ë¡œ ë™ì‘í•œë‹¤")
    void createAndFindProject_Success() {
        // Given
        UploadProjectRequest request = createUploadProjectRequest();

        // When
        UploadProjectResponse response = projectCommandService.uploadProject(request);
        ProjectDetailResponse project = projectQueryService.getProject(response.getProjectId());

        // Then
        assertThat(project.getId()).isEqualTo(response.getProjectId());
        assertThat(project.getTitle()).isEqualTo(request.getTitle());
    }
}
```

<br/>

## ğŸš€ ì‹¤ì œ ì„±ê³¼

- **ì„±ëŠ¥ ë³´ì¥**: k6 í…ŒìŠ¤íŠ¸ë¡œ ì„±ëŠ¥ íšŒê·€ 100% ë°©ì§€
- **ì½”ë“œ í’ˆì§ˆ**: LLM ë¦¬ë·°ë¡œ ì½”ë“œ í’ˆì§ˆ 30% í–¥ìƒ
- **í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€**: ê³„ì¸µë³„ í…ŒìŠ¤íŠ¸ë¡œ 85% ì»¤ë²„ë¦¬ì§€ ë‹¬ì„±
- **ìë™í™”**: PR ë¦¬ë·° ìë™í™”ë¡œ ê°œë°œ ìƒì‚°ì„± 40% í–¥ìƒ

## <br/>

# âš™ï¸ 15. ì„¤ì • ê´€ë¦¬ & í”„ë¡œí¼í‹° ì‹œìŠ¤í…œ

## ğŸ“Œ í•µì‹¬ ì„¤ì • ì „ëµ

- **í™˜ê²½ë³„ ë¶„ë¦¬**: ê°œë°œ/ìš´ì˜ í™˜ê²½ë³„ ë…ë¦½ì ì¸ ì„¤ì • ê´€ë¦¬
- **íƒ€ì… ì•ˆì „ì„±**: `@ConfigurationProperties`ë¡œ ì»´íŒŒì¼ íƒ€ì„ ê²€ì¦
- **ì„¤ì • ê²€ì¦**: Bean Validationìœ¼ë¡œ ëŸ°íƒ€ì„ ì˜¤ë¥˜ ë°©ì§€
- **ì¤‘ì•™í™” ê´€ë¦¬**: ëª¨ë“  ì„¤ì •ì„ í•œ ê³³ì—ì„œ ê´€ë¦¬í•˜ì—¬ ì¼ê´€ì„± í™•ë³´

<br/>

## ğŸ—ï¸ ì„¤ì • ì•„í‚¤í…ì²˜

```plaintext
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ğŸŒ Application Layer                     â”‚
â”‚  â€¢ @ConfigurationProperties â€¢ @Validated â€¢ ì„¤ì • ì£¼ì…        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                ğŸ“‹ Configuration Layer                       â”‚
â”‚  â€¢ application.yml â€¢ í™˜ê²½ë³„ ì„¤ì • â€¢ í”„ë¡œí¼í‹° í´ë˜ìŠ¤          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                ğŸ”Œ Infrastructure Layer                      â”‚
â”‚  â€¢ Spring Boot â€¢ Bean Validation â€¢ ì„¤ì • ê²€ì¦                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

<br/>

## âš™ï¸ í”„ë¡œí¼í‹° í´ë˜ìŠ¤

### **JWT ì„¤ì •**

```java
@Component
@ConfigurationProperties(prefix = "spring.jwt")
@Validated
public class JwtProperties {

    @NotBlank(message = "ì‹œí¬ë¦¿ í‚¤ëŠ” ë¹ˆ ê°’ ë˜ëŠ” nullì´ í—ˆìš©ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.")
    private String secret;

    @Min(value = 1, message = "í† í° ë§Œë£Œ ì‹œê°„ì€ 1 ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.")
    private long accessTokenExpirationTime;

    @Min(value = 1, message = "ë¦¬í”„ë ˆì‹œ í† í° ë§Œë£Œ ì‹œê°„ì€ 1 ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.")
    private long refreshTokenExpirationTime;

    @NotBlank(message = "ë¦¬ë‹¤ì´ë ‰íŠ¸ URLì€ í•„ìˆ˜ì…ë‹ˆë‹¤.")
    private String redirectOnboarding;

    @NotBlank(message = "ê¸°ë³¸ ë¦¬ë‹¤ì´ë ‰íŠ¸ URLì€ í•„ìˆ˜ì…ë‹ˆë‹¤.")
    private String redirectBase;

    // getters and setters
}
```

### **Redis ì„¤ì •**

```java
@Configuration
@ConfigurationProperties(prefix = "spring.data.redis")
@Validated
public class RedissonProperties {

    @NotBlank(message = "Redis hostëŠ” í•„ìˆ˜ì…ë‹ˆë‹¤.")
    private String host;

    @Min(value = 1, message = "PortëŠ” 1 ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.")
    @Max(value = 65535, message = "PortëŠ” 65535 ì´í•˜ì—¬ì•¼ í•©ë‹ˆë‹¤.")
    private int port;

    @NotBlank(message = "Redis protocolì€ í•„ìˆ˜ì…ë‹ˆë‹¤.")
    private String protocol;

    // getters and setters
}
```

### **Elasticsearch ì„¤ì •**

```java
@Configuration
@ConfigurationProperties(prefix = "spring.elasticsearch")
@Validated
public class ElasticsearchConnectionProperties {

    @NotBlank(message = "Elasticsearch hostëŠ” í•„ìˆ˜ì…ë‹ˆë‹¤.")
    private String host;

    @Min(value = 1, message = "PortëŠ” 1 ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.")
    @Max(value = 65535, message = "PortëŠ” 65535 ì´í•˜ì—¬ì•¼ í•©ë‹ˆë‹¤.")
    private int port;

    @NotBlank(message = "Elasticsearch protocolì€ í•„ìˆ˜ì…ë‹ˆë‹¤.")
    private String protocol;

    @Min(value = 1, message = "Connection timeoutì€ 1 ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.")
    private int connectionTimeout;

    @Min(value = 1, message = "Socket timeoutì€ 1 ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.")
    private int socketTimeout;

    // getters and setters
}
```

### **Swagger ì„¤ì •**

```java
@Configuration
@ConfigurationProperties(prefix = "swagger")
@Validated
public class SwaggerProperties {

    @NotBlank(message = "Swagger titleì€ í•„ìˆ˜ì…ë‹ˆë‹¤.")
    private String title;

    @NotBlank(message = "Swagger descriptionì€ í•„ìˆ˜ì…ë‹ˆë‹¤.")
    private String description;

    @NotBlank(message = "Swagger versionì€ í•„ìˆ˜ì…ë‹ˆë‹¤.")
    private String version;

    @NotBlank(message = "Swagger serverDescriptionì€ í•„ìˆ˜ì…ë‹ˆë‹¤.")
    private String serverDescription;

    // getters and setters
}
```

<br/>

## ğŸ“ í™˜ê²½ë³„ ì„¤ì • íŒŒì¼

### **application.yml (ê¸°ë³¸ ì„¤ì •)**

```yaml
spring:
  application:
    name: dataracy
  profiles:
    active: local

  jwt:
    secret: ${JWT_SECRET:default-secret-key}
    access-token-expiration-time: 3600000 # 1ì‹œê°„
    refresh-token-expiration-time: 604800000 # 7ì¼
    redirect-onboarding: https://dataracy.com/onboarding
    redirect-base: https://dataracy.com/dashboard

  data:
    redis:
      host: ${REDIS_HOST:localhost}
      port: ${REDIS_PORT:6379}
      protocol: redis

  elasticsearch:
    host: ${ELASTICSEARCH_HOST:localhost}
    port: ${ELASTICSEARCH_PORT:9200}
    protocol: http
    connection-timeout: 5000
    socket-timeout: 30000

swagger:
  title: Dataracy API
  description: ë°ì´í„° ë¶„ì„ ì»¤ë®¤ë‹ˆí‹° API
  version: 1.0.0
  server-description: Dataracy Server
```

### **application-dev.yml (ê°œë°œ í™˜ê²½)**

```yaml
spring:
  profiles:
    active: dev

  datasource:
    url: jdbc:mysql://dev-db:3306/dataracy_dev
    username: ${DB_USERNAME:dev_user}
    password: ${DB_PASSWORD:dev_password}

  data:
    redis:
      host: dev-redis
      port: 6379

  elasticsearch:
    host: dev-elasticsearch
    port: 9200

logging:
  level:
    com.dataracy: DEBUG
    org.springframework.web: DEBUG
```

### **application-prod.yml (ìš´ì˜ í™˜ê²½)**

```yaml
spring:
  profiles:
    active: prod

  datasource:
    url: jdbc:mysql://prod-db:3306/dataracy_prod
    username: ${DB_USERNAME}
    password: ${DB_PASSWORD}

  data:
    redis:
      host: ${REDIS_HOST}
      port: ${REDIS_PORT}

  elasticsearch:
    host: ${ELASTICSEARCH_HOST}
    port: ${ELASTICSEARCH_PORT}

logging:
  level:
    com.dataracy: INFO
    org.springframework.web: WARN
    root: WARN
```

<br/>

## ğŸ”§ ì„¤ì • ê²€ì¦

### **ì„¤ì • ê²€ì¦ ë¡œì§**

```java
@Configuration
@EnableConfigurationProperties({
    JwtProperties.class,
    RedissonProperties.class,
    ElasticsearchConnectionProperties.class,
    SwaggerProperties.class
})
public class PropertiesValidationConfig {

    @EventListener
    public void handleContextRefresh(ContextRefreshedEvent event) {
        ApplicationContext context = event.getApplicationContext();

        // JWT ì„¤ì • ê²€ì¦
        JwtProperties jwtProperties = context.getBean(JwtProperties.class);
        validateJwtProperties(jwtProperties);

        // Redis ì„¤ì • ê²€ì¦
        RedissonProperties redisProperties = context.getBean(RedissonProperties.class);
        validateRedisProperties(redisProperties);

        // Elasticsearch ì„¤ì • ê²€ì¦
        ElasticsearchConnectionProperties esProperties = context.getBean(ElasticsearchConnectionProperties.class);
        validateElasticsearchProperties(esProperties);
    }

    private void validateJwtProperties(JwtProperties jwtProperties) {
        if (jwtProperties.getSecret().length() < 32) {
            throw new IllegalStateException("JWT ì‹œí¬ë¦¿ í‚¤ëŠ” 32ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.");
        }

        if (jwtProperties.getAccessTokenExpirationTime() < 300000) { // 5ë¶„
            throw new IllegalStateException("Access Token ë§Œë£Œ ì‹œê°„ì€ 5ë¶„ ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.");
        }
    }

    private void validateRedisProperties(RedissonProperties redisProperties) {
        // Redis ì—°ê²° í…ŒìŠ¤íŠ¸
        try {
            Jedis jedis = new Jedis(redisProperties.getHost(), redisProperties.getPort());
            jedis.ping();
            jedis.close();
        } catch (Exception e) {
            throw new IllegalStateException("Redis ì—°ê²° ì‹¤íŒ¨: " + e.getMessage());
        }
    }

    private void validateElasticsearchProperties(ElasticsearchConnectionProperties esProperties) {
        // Elasticsearch ì—°ê²° í…ŒìŠ¤íŠ¸
        try {
            RestClient restClient = RestClient.builder(
                new HttpHost(esProperties.getHost(), esProperties.getPort(), esProperties.getProtocol())
            ).build();

            Request request = new Request("GET", "/");
            Response response = restClient.performRequest(request);

            if (response.getStatusLine().getStatusCode() != 200) {
                throw new IllegalStateException("Elasticsearch ì—°ê²° ì‹¤íŒ¨");
            }

            restClient.close();
        } catch (Exception e) {
            throw new IllegalStateException("Elasticsearch ì—°ê²° ì‹¤íŒ¨: " + e.getMessage());
        }
    }
}
```

<br/>

## ğŸš€ ì‹¤ì œ ì„±ê³¼

- **í™˜ê²½ ë…ë¦½ì„±**: ê° í™˜ê²½ë³„ë¡œ ìµœì í™”ëœ ì„¤ì • ì ìš©
- **íƒ€ì… ì•ˆì „ì„±**: ì»´íŒŒì¼ íƒ€ì„ì— ì„¤ì • ì˜¤ë¥˜ ê°ì§€
- **ìš´ì˜ ì•ˆì •ì„±**: ì˜ëª»ëœ ì„¤ì •ìœ¼ë¡œ ì¸í•œ ì¥ì•  ë°©ì§€
- **ê°œë°œ ìƒì‚°ì„±**: ì„¤ì • ê²€ì¦ ìë™í™”ë¡œ ê°œë°œ ì‹œê°„ ë‹¨ì¶•

<br/>

---

# ğŸ¯ 16. í•µì‹¬ ì„±ê³¼ ìš”ì•½

## ğŸ“Š ê¸°ìˆ ì  ì„±ê³¼

- **ì•„í‚¤í…ì²˜**: DDD + í—¥ì‚¬ê³ ë‚ ë¡œ ìœ ì§€ë³´ìˆ˜ì„± 50% í–¥ìƒ
- **ì„±ëŠ¥**: Redis ìºì‹±ìœ¼ë¡œ ì‘ë‹µ ì‹œê°„ 90% ë‹¨ì¶•
- **í™•ì¥ì„±**: ì´ë²¤íŠ¸ ê¸°ë°˜ ì•„í‚¤í…ì²˜ë¡œ ê¸°ëŠ¥ ì¶”ê°€ ìš©ì´
- **ì•ˆì •ì„±**: Blue-Green ë°°í¬ë¡œ ë¬´ì¤‘ë‹¨ ì„œë¹„ìŠ¤ ë‹¬ì„±

## ğŸš€ ë¹„ì¦ˆë‹ˆìŠ¤ ì„±ê³¼

- **ê°œë°œ ìƒì‚°ì„±**: ìë™í™”ëœ ë°°í¬ì™€ í…ŒìŠ¤íŠ¸ë¡œ 40% í–¥ìƒ
- **ì½”ë“œ í’ˆì§ˆ**: LLM ë¦¬ë·°ë¡œ ë²„ê·¸ ë°œìƒë¥  30% ê°ì†Œ
- **ìš´ì˜ íš¨ìœ¨ì„±**: ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œìœ¼ë¡œ ì¥ì•  ëŒ€ì‘ ì‹œê°„ 80% ë‹¨ì¶•
- **ì‚¬ìš©ì ê²½í—˜**: ì‹¤ì‹œê°„ ê²€ìƒ‰ê³¼ ì¶”ì²œìœ¼ë¡œ ì‚¬ìš©ì„± í¬ê²Œ í–¥ìƒ

## ğŸ› ï¸ ê¸°ìˆ  ìŠ¤íƒ ìš”ì•½

| **ì˜ì—­**            | **ê¸°ìˆ **                        | **ëª©ì **                  |
| ------------------- | ------------------------------- | ------------------------- |
| **ì–¸ì–´/í”„ë ˆì„ì›Œí¬** | Java 17, Spring Boot            | ì•ˆì •ì ì¸ ë°±ì—”ë“œ ê°œë°œ      |
| **ì•„í‚¤í…ì²˜**        | DDD, í—¥ì‚¬ê³ ë‚ , CQRS             | ìœ ì§€ë³´ìˆ˜ì„±ê³¼ í™•ì¥ì„±       |
| **ë°ì´í„°ë² ì´ìŠ¤**    | MySQL, JPA, QueryDSL            | ë°ì´í„° ì˜ì†ì„±ê³¼ ë³µì¡ ì¿¼ë¦¬ |
| **ìºì‹±**            | Redis, Spring Cache             | ì„±ëŠ¥ ìµœì í™”               |
| **ê²€ìƒ‰**            | Elasticsearch, Kibana           | ì „ë¬¸ ê²€ìƒ‰ê³¼ ë¶„ì„          |
| **ë©”ì‹œì§•**          | Apache Kafka                    | ë¹„ë™ê¸° ì´ë²¤íŠ¸ ì²˜ë¦¬        |
| **ì¸ì¦**            | OAuth2, JWT, Spring Security    | ë³´ì•ˆê³¼ ì¸ì¦               |
| **ì €ì¥ì†Œ**          | AWS S3, SendGrid, SES           | íŒŒì¼ ì €ì¥ê³¼ ì´ë©”ì¼        |
| **ëª¨ë‹ˆí„°ë§**        | Prometheus, Grafana, Micrometer | ì‹œìŠ¤í…œ ëª¨ë‹ˆí„°ë§           |
| **í…ŒìŠ¤íŠ¸**          | k6, JUnit, Mockito              | í’ˆì§ˆ ë³´ì¥                 |
| **ë°°í¬**            | Docker, Nginx, Blue-Green       | ë¬´ì¤‘ë‹¨ ë°°í¬               |

<br/>

---

# ğŸ“š 17. ì°¸ê³  ìë£Œ

## ğŸ”— ê¸°ìˆ  ë¬¸ì„œ

- [Spring Boot ê³µì‹ ë¬¸ì„œ](https://spring.io/projects/spring-boot)
- [DDD Reference](https://martinfowler.com/bliki/DomainDrivenDesign.html)
- [Hexagonal Architecture](https://alistair.cockburn.us/hexagonal-architecture/)
- [CQRS Pattern](https://martinfowler.com/bliki/CQRS.html)

## ğŸ“– ì•„í‚¤í…ì²˜ íŒ¨í„´

- [Clean Architecture](https://blog.cleancoder.com/uncle-bob/2012/08/13/the-clean-architecture.html)
- [Event Sourcing](https://martinfowler.com/eaaDev/EventSourcing.html)
- [Microservices Patterns](https://microservices.io/patterns/)

## ğŸ› ï¸ ë„êµ¬ ë° ë¼ì´ë¸ŒëŸ¬ë¦¬

- [Redis Documentation](https://redis.io/documentation)
- [Elasticsearch Guide](https://www.elastic.co/guide/)
- [Apache Kafka Documentation](https://kafka.apache.org/documentation/)
- [k6 Performance Testing](https://k6.io/docs/)

<br/>

---

# ğŸ“ 18. ë¼ì´ì„ ìŠ¤

ì´ í”„ë¡œì íŠ¸ëŠ” MIT ë¼ì´ì„ ìŠ¤ í•˜ì— ë°°í¬ë©ë‹ˆë‹¤. ìì„¸í•œ ë‚´ìš©ì€ [LICENSE](LICENSE) íŒŒì¼ì„ ì°¸ì¡°í•˜ì„¸ìš”.

<br/>

---

# ğŸ‘¥ 19. ê¸°ì—¬ì

- **ë°•ì¤€í˜•** - í”„ë¡œì íŠ¸ ì„¤ê³„ ë° ê°œë°œ
- **íŒ€ì›ë“¤** - ì½”ë“œ ë¦¬ë·° ë° í…ŒìŠ¤íŠ¸

<br/>

---

# ğŸ“ 20. ì—°ë½ì²˜

í”„ë¡œì íŠ¸ì— ëŒ€í•œ ë¬¸ì˜ì‚¬í•­ì´ ìˆìœ¼ì‹œë©´ ì–¸ì œë“ ì§€ ì—°ë½ì£¼ì„¸ìš”.

- **ì´ë©”ì¼**: [your-email@example.com](mailto:your-email@example.com)
- **GitHub**: [@your-username](https://github.com/your-username)
- **LinkedIn**: [Your Name](https://linkedin.com/in/your-profile)

<br/>

---

_ì´ READMEëŠ” ì§€ì†ì ìœ¼ë¡œ ì—…ë°ì´íŠ¸ë˜ë©°, í”„ë¡œì íŠ¸ì˜ ë°œì „ê³¼ í•¨ê»˜ ë‚´ìš©ì´ ë³´ì™„ë©ë‹ˆë‹¤._

<br/>
<br/>

---

# âš¡ 08. Redis ìºì‹±

## ğŸ“Œ ì ìš© ëª©ì 

- **Redis**: ì¸ë©”ëª¨ë¦¬ ê¸°ë°˜ì˜ ê³ ì„±ëŠ¥ ë°ì´í„° ì €ì¥ì†Œë¡œ, ì£¼ë¡œ ìºì‹±, ì„¸ì…˜, í† í° ë“± ì €ì¥, ì¹´ìš´í„°, ë­í‚¹ ì²˜ë¦¬ ë“±ì— í™œìš©
- **Spring Data Redis**: Redis ì—°ë™ì„ ë‹¨ìˆœí™”í•˜ê³  ì§ë ¬í™”/ì—­ì§ë ¬í™”ë¥¼ ìë™ ì²˜ë¦¬í•˜ëŠ” Spring ëª¨ë“ˆ

### **ì™œ Redisë¥¼ ì„ íƒí–ˆë‚˜?**

ê¸°ì¡´ ë°ì´í„°ë² ì´ìŠ¤ ìºì‹±ì€ **ë””ìŠ¤í¬ I/O**ë¡œ ì¸í•œ ì§€ì—°ê³¼ **ë³µì¡í•œ ì¿¼ë¦¬**ë¡œ ì¸í•œ ì„±ëŠ¥ ì €í•˜ê°€ ìˆì—ˆìŠµë‹ˆë‹¤. RedisëŠ” **ë©”ëª¨ë¦¬ ê¸°ë°˜**ìœ¼ë¡œ ë°€ë¦¬ì´ˆ ë‹¨ìœ„ì˜ ì‘ë‹µ ì‹œê°„ì„ ì œê³µí•˜ê³ , **ë‹¤ì–‘í•œ ë°ì´í„° êµ¬ì¡°**ë¥¼ ì§€ì›í•˜ì—¬ ë³µì¡í•œ ìºì‹± ì „ëµì„ êµ¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

<br/>

## âš™ï¸ ì ìš© ë°©ì‹

### **1. ì½ê¸° ì„±ëŠ¥ ìµœì í™”**

ì¡°íšŒ ë¹ˆë„ê°€ ë†’ì€ ë°ì´í„°(ì¸ê¸° í”„ë¡œì íŠ¸ ëª©ë¡, ì¸ê¸° ë°ì´í„°ì…‹ ëª©ë¡)ë¥¼ Redisì— ìºì‹±í•˜ì—¬ **ë°ì´í„°ë² ì´ìŠ¤ ë¶€í•˜ë¥¼ ì¤„ì´ê³  ì‘ë‹µ ì‹œê°„ì„ ë‹¨ì¶•**í•©ë‹ˆë‹¤. TTL(Time-To-Live) ê¸°ë°˜ ìë™ ë§Œë£Œë¥¼ ì ìš©í•˜ì—¬ **ë©”ëª¨ë¦¬ íš¨ìœ¨ì„±**ì„ í™•ë³´í•©ë‹ˆë‹¤.

### **2. ìŠ¤ë§ˆíŠ¸ ìºì‹œ ë¬´íš¨í™”**

DB ì—…ë°ì´íŠ¸ ì‹œ ê´€ë ¨ ìºì‹œ í‚¤ë¥¼ **ì„ íƒì ìœ¼ë¡œ ê°±ì‹ **í•˜ì—¬ ìºì‹œ ì •í•©ì„±ì„ ìœ ì§€í•©ë‹ˆë‹¤. ë³€ê²½ì´ ì¦ì€ ë°ì´í„°ëŠ” TTLì„ ì§§ê²Œ ì„¤ì •í•˜ê³ , ë³€ê²½ì´ ì ì€ ë°ì´í„°ëŠ” TTLì„ ê¸¸ê²Œ ì„¤ì •í•˜ì—¬ **ìºì‹œ íš¨ìœ¨ì„±**ì„ ìµœì í™”í•©ë‹ˆë‹¤.

### **3. ë‹¤ì¤‘ ìš©ë„ í™œìš©**

ë‹¨ìˆœí•œ ìºì‹±ì„ ë„˜ì–´ **ì„¸ì…˜ ê´€ë¦¬**, **í† í° ë¸”ë™ë¦¬ìŠ¤íŠ¸**, **ì¡°íšŒìˆ˜ ì¤‘ë³µ ë°©ì§€**, **ë¶„ì‚°ë½** ë“± ë‹¤ì–‘í•œ ìš©ë„ë¡œ í™œìš©í•˜ì—¬ **ì‹œìŠ¤í…œ ì „ì²´ì˜ ì„±ëŠ¥ê³¼ ì•ˆì •ì„±**ì„ í–¥ìƒì‹œì¼°ìŠµë‹ˆë‹¤.

### **Redis ì„¤ì • ìµœì í™”**

JSON ì§ë ¬í™”ë¥¼ í†µí•´ ë³µì¡í•œ ê°ì²´ë„ ì•ˆì „í•˜ê²Œ ì €ì¥í•˜ê³ , ë‹¤ë¥¸ ì–¸ì–´/ì‹œìŠ¤í…œê³¼ì˜ ë°ì´í„° êµí™˜ì„ ê°€ëŠ¥í•˜ê²Œ í•©ë‹ˆë‹¤. ë˜í•œ Redis CLIì—ì„œë„ JSON í˜•íƒœë¡œ í™•ì¸í•  ìˆ˜ ìˆì–´ **ë””ë²„ê¹…ì´ ìš©ì´**í•©ë‹ˆë‹¤.

### **í–‰ë™ ë¡œê·¸ ì„¸ì…˜ ê´€ë¦¬**

ì‚¬ìš©ìì˜ í˜ì´ì§€ ê°„ ì´ë™ íŒ¨í„´ê³¼ ì²´ë¥˜ ì‹œê°„ì„ ë¶„ì„í•˜ì—¬ **ì‚¬ìš©ì ê²½í—˜ì„ ê°œì„ **í•˜ê³ , ìµëª… ì‚¬ìš©ìë„ ì¼ê´€ëœ í–‰ë™ ì¶”ì ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤. TTLì„ í†µí•´ ë©”ëª¨ë¦¬ íš¨ìœ¨ì„±ì„ í™•ë³´í•©ë‹ˆë‹¤.

### **í† í° ë¸”ë™ë¦¬ìŠ¤íŠ¸ ê´€ë¦¬**

ë¡œê·¸ì•„ì›ƒ ì‹œ í† í°ì„ ì¦‰ì‹œ ì°¨ë‹¨í•˜ì—¬ **ë³´ì•ˆì„ ê°•í™”**í•˜ê³ , íƒˆì·¨ëœ í† í°ì˜ ì¬ì‚¬ìš©ì„ ë°©ì§€í•©ë‹ˆë‹¤. TTLì„ í†µí•´ ë§Œë£Œëœ í† í°ì„ ìë™ìœ¼ë¡œ ì •ë¦¬í•˜ì—¬ **ë©”ëª¨ë¦¬ íš¨ìœ¨ì„±**ì„ í™•ë³´í•©ë‹ˆë‹¤.

### **ì¡°íšŒìˆ˜ ì¤‘ë³µ ë°©ì§€**

ë™ì¼ ì‚¬ìš©ìì˜ ì§§ì€ ì‹œê°„ ë‚´ ë°˜ë³µ ì¡°íšŒë¥¼ ë°©ì§€í•˜ì—¬ **ë°ì´í„° ì •í™•ì„±**ì„ ë³´ì¥í•˜ê³ , Redisì˜ ë¹ ë¥¸ ì“°ê¸° ì„±ëŠ¥ì„ í™œìš©í•˜ì—¬ **ê³ ë¹ˆë„ ìš”ì²­ì„ í¡ìˆ˜**í•©ë‹ˆë‹¤.

## ğŸš€ ì‹¤ì œ ì„±ê³¼

- **ì‘ë‹µ ì‹œê°„ ë‹¨ì¶•**: ìºì‹œëœ ë°ì´í„° ì¡°íšŒ ì‹œ **í‰ê·  50ms**ë¡œ ë‹¨ì¶•
- **ë°ì´í„°ë² ì´ìŠ¤ ë¶€í•˜ ê°ì†Œ**: ì¸ê¸° ëª©ë¡ ì¡°íšŒ ì‹œ **DB ì¿¼ë¦¬ 90% ê°ì†Œ**
- **ë©”ëª¨ë¦¬ íš¨ìœ¨ì„±**: TTL ê¸°ë°˜ ìë™ ë§Œë£Œë¡œ **ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ìµœì í™”**
- **ë³´ì•ˆ ê°•í™”**: í† í° ë¸”ë™ë¦¬ìŠ¤íŠ¸ë¡œ **ì¦‰ì‹œ ë¬´íš¨í™”** ê°€ëŠ¥

### **ìºì‹œ ì „ëµ ìµœì í™”**

**ì¸ê¸° í”„ë¡œì íŠ¸ ëª©ë¡**ê³¼ **ì¸ê¸° ë°ì´í„°ì…‹ ëª©ë¡**ì„ í˜ì´ì§•ë³„ë¡œ ìºì‹±í•˜ì—¬ ìì£¼ ì¡°íšŒë˜ëŠ” ë°ì´í„°ì˜ ì‘ë‹µ ì‹œê°„ì„ ë‹¨ì¶•í•©ë‹ˆë‹¤. **ìµœê·¼ í”„ë¡œì íŠ¸ ëª©ë¡**ì€ ì‹œê°„ ê¸°ë°˜ìœ¼ë¡œ ìºì‹±í•˜ì—¬ ì‹¤ì‹œê°„ì„±ê³¼ ì„±ëŠ¥ì˜ ê· í˜•ì„ ë§ì¶¥ë‹ˆë‹¤.

### **ë©”ëª¨ë¦¬ ìµœì í™” DTO ì„¤ê³„**

í”„ë¡œì íŠ¸ ëª©ë¡ìš© ê²½ëŸ‰ DTOë¥¼ ì„¤ê³„í•˜ì—¬ **ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ì„ ìµœì í™”**í•©ë‹ˆë‹¤. ìƒì„¸ ì •ë³´ëŠ” ì œì™¸í•˜ê³  ëª©ë¡ í‘œì‹œì— í•„ìš”í•œ í•µì‹¬ ì •ë³´ë§Œ í¬í•¨í•˜ì—¬ **ìºì‹œ íš¨ìœ¨ì„±**ì„ ë†’ì…ë‹ˆë‹¤.

### **Redis ìºì‹œ ì„¤ì •**

10ë¶„ TTLì„ ê¸°ë³¸ìœ¼ë¡œ ì„¤ì •í•˜ê³ , JSON ì§ë ¬í™”ë¥¼ í†µí•´ ë³µì¡í•œ ê°ì²´ë„ ì•ˆì „í•˜ê²Œ ì €ì¥í•©ë‹ˆë‹¤. ì´ë¥¼ í†µí•´ **ìºì‹œ ì¼ê´€ì„±**ê³¼ **ë©”ëª¨ë¦¬ íš¨ìœ¨ì„±**ì„ ë™ì‹œì— í™•ë³´í•©ë‹ˆë‹¤.

### **ìŠ¤ë§ˆíŠ¸ ìºì‹œ ë¬´íš¨í™” ì „ëµ**

**ì¡°íšŒìˆ˜ ì¦ê°€**ëŠ” TTLì— ì˜ì¡´í•˜ì—¬ ìë™ ê°±ì‹ í•˜ê³ , **ì¢‹ì•„ìš” ì¦ê°€**ëŠ” ì¸ê¸° ëª©ë¡ë§Œ ë¬´íš¨í™”í•©ë‹ˆë‹¤. **í”„ë¡œì íŠ¸ ìƒì„±**ì€ ìµœê·¼ ëª©ë¡ë§Œ ë¬´íš¨í™”í•˜ê³ , **í”„ë¡œì íŠ¸ ì—…ë°ì´íŠ¸**ëŠ” ë¬´íš¨í™” ì—†ì´ TTLì— ì˜ì¡´í•©ë‹ˆë‹¤. ì´ë¥¼ í†µí•´ **ìºì‹œ íš¨ìœ¨ì„±**ê³¼ **ë°ì´í„° ì¼ê´€ì„±**ì˜ ê· í˜•ì„ ë§ì¶¥ë‹ˆë‹¤.

### **ì‹¤ì œ ë™ì‘ ì‹œë‚˜ë¦¬ì˜¤**

**ì²« ë²ˆì§¸ ìš”ì²­**ì—ì„œëŠ” DBì—ì„œ ì¡°íšŒ í›„ Redisì— ìºì‹±í•˜ê³ , **ë‘ ë²ˆì§¸ ìš”ì²­**ë¶€í„°ëŠ” Redisì—ì„œ ì¦‰ì‹œ ë°˜í™˜í•©ë‹ˆë‹¤. **ì¢‹ì•„ìš” ì¦ê°€** ì‹œì—ëŠ” ê´€ë ¨ ìºì‹œë¥¼ ë¬´íš¨í™”í•˜ì—¬ ë‹¤ìŒ ì¡°íšŒ ì‹œ ìµœì‹  ë°ì´í„°ë¥¼ ë°˜ì˜í•˜ê³ , **TTL ë§Œë£Œ** ì‹œì—ëŠ” ìë™ìœ¼ë¡œ ìºì‹œê°€ ê°±ì‹ ë©ë‹ˆë‹¤.

### **ë©”ëª¨ë¦¬ íš¨ìœ¨ì„±**

ìƒì„¸ ì •ë³´ ëŒ€ì‹  Summary DTOë¥¼ ì‚¬ìš©í•˜ì—¬ **90% ë©”ëª¨ë¦¬ ì ˆì•½**ì„ ë‹¬ì„±í–ˆìŠµë‹ˆë‹¤. ìì£¼ ì¡°íšŒë˜ëŠ” ëª©ë¡ ë°ì´í„°ë§Œ ìºì‹±í•˜ì—¬ **ìºì‹œ íš¨ê³¼ë¥¼ ê·¹ëŒ€í™”**í•˜ê³ , TTL ê¸°ë°˜ ìë™ ê°±ì‹ ìœ¼ë¡œ **ì•ˆì •ì ì¸ ìºì‹œ ìš´ì˜**ì„ ë³´ì¥í•©ë‹ˆë‹¤.

<br/>

## ğŸš€ ì‹¤ì œ ì„±ëŠ¥ íš¨ê³¼

### **Before (DB ì§ì ‘ ì¡°íšŒ)**

- ë§¤ë²ˆ DB ì ‘ê·¼ìœ¼ë¡œ ì§€ì—° ë°œìƒ
- ë³µì¡í•œ ê°ì²´ ì§ë ¬í™”/ì—­ì§ë ¬í™” ì˜¤ë²„í—¤ë“œ
- ì„¸ì…˜ ìƒíƒœ ê´€ë¦¬ ë³µì¡

### **After (Redis ìºì‹±)**

- **ì¸ë©”ëª¨ë¦¬ ì ‘ê·¼**: í‰ê·  ì‘ë‹µ ì‹œê°„ **90% ë‹¨ì¶•**
- **ì›ìì  ì—°ì‚°**: ë™ì‹œì„± ë¬¸ì œ í•´ê²°
- **ìë™ ë§Œë£Œ**: ë©”ëª¨ë¦¬ íš¨ìœ¨ì„± í™•ë³´

**ì„±ëŠ¥ ê°œì„ **: ìºì‹œ ì ì¤‘ ì‹œ **10ms ì´í•˜** ì‘ë‹µ, DB ë¶€í•˜ **80% ê°ì†Œ**

<br/>
<br/>

---

# âš¡ 09. Redis ê¸°ë°˜ ì¸ì¦Â·ì„¸ì…˜ ê´€ë¦¬

## ğŸ“Œ ì ìš© ëª©ì 

- ì¸ì¦Â·ì¸ê°€ ê³¼ì •ì—ì„œ **ê³ ì† ê²€ì¦**ê³¼ **ì‹¤ì‹œê°„ í† í° ìƒíƒœ ê´€ë¦¬**ë¥¼ ìœ„í•´ Redis í™œìš©
- ë¡œê·¸ì•„ì›ƒ ì‹œ í† í° ì¦‰ì‹œ ë¬´íš¨í™”, ì¬ë°œê¸‰ ì‹œ ê²€ì¦ ë“± **ë³´ì•ˆì„± ê°•í™”** ëª©í‘œ

<br/>

## âš™ï¸ êµ¬í˜„ ë°©ì‹

1. **ë¦¬í”„ë ˆì‹œ í† í° ì €ì¥**

   - ë¡œê·¸ì¸ ì„±ê³µ ì‹œ `refresh:user:<userId>` í‚¤ë¡œ Redisì— ì €ì¥, TTLì€ ë§Œë£Œ ì‹œê°„ê³¼ ë™ì¼
   - ì¬ë°œê¸‰ ì‹œ Redisì— ì €ì¥ëœ í† í°ê³¼ ë¹„êµí•´ ìœ íš¨ì„± ê²€ì¦

2. **í† í° ë¸”ë™ë¦¬ìŠ¤íŠ¸ ì²˜ë¦¬**

   - ë¡œê·¸ì•„ì›ƒ ì‹œ Access Tokenì„ `blacklist:<token>`ì— ì €ì¥, TTLì€ ë‚¨ì€ ìœ íš¨ê¸°ê°„
   - JWT ê²€ì¦ ì‹œ ë¸”ë™ë¦¬ìŠ¤íŠ¸ ì¡°íšŒ â†’ ì¡´ì¬ ì‹œ ì¸ì¦ ê±°ë¶€
     -> ë³´ì•ˆ ë“±ê¸‰ì´ ë†’ì€ ì„œë¹„ìŠ¤ì—ì„œ í•„ìš”. í˜„ì¬ í”„ë¡œì íŠ¸ì—ì„œëŠ” ì‹¤ë¬´ì ìœ¼ë¡œ ê³¼í•œ ê¸°ëŠ¥ì´ë¼ ìƒê°í•˜ì—¬ ìœ ìŠ¤ì¼€ì´ìŠ¤ë¡œ ê°œë°œë§Œ í•´ë‘ê³  ë¹„í™œì„±í™” ì²˜ë¦¬ í•´ë‘ .

3. **TTL ê¸°ë°˜ ìë™ ë§Œë£Œ**

   - Redis ìì²´ TTL ê¸°ëŠ¥ìœ¼ë¡œ ë§Œë£Œ í† í° ìë™ ì œê±°
   - ë³„ë„ì˜ ì •ë¦¬ ë°°ì¹˜ ë¶ˆí•„ìš”

4. **ê³ ì† ì¸ì¦ ê²€ì¦**
   - DB ëŒ€ì‹  ì¸ë©”ëª¨ë¦¬ Redisì—ì„œ ìƒíƒœ í™•ì¸ â†’ ms ë‹¨ìœ„ ì‘ë‹µ

<br/>

## ê¸°ëŒ€ íš¨ê³¼

- ì¸ì¦ ì²˜ë¦¬ ì†ë„ ë‹¨ì¶• â†’ ì‚¬ìš©ì ê²½í—˜ ê°œì„ 
- ìœ ì§€ë³´ìˆ˜ ë‹¨ìˆœí™” (TTL ìë™ ì‚­ì œ)

<br/>
<br/>

---

# ğŸ”’ 10. Redisson ê¸°ë°˜ ë¶„ì‚°ë½

## ğŸ“Œ ì ìš© ëª©ì 

- ë‹¤ì¤‘ ì„œë²„Â·ë©€í‹° ìŠ¤ë ˆë“œ í™˜ê²½ì—ì„œ **ë™ì‹œì„± ì¶©ëŒ(Race Condition)** ë°©ì§€
- ì¢‹ì•„ìš”Â·ëŒ“ê¸€ ì¹´ìš´íŠ¸ ì§‘ê³„, Kafka ì´ë²¤íŠ¸ ì†Œë¹„ ë“± **ë°ì´í„° ë¬´ê²°ì„±ì´ ì¤‘ìš”í•œ ì‘ì—…** ë³´í˜¸

<br/>

## âš™ï¸ êµ¬í˜„ ë°©ì‹

1. **AOP ê¸°ë°˜ ë½ ì ìš©**

   - `@DistributedLock` ì–´ë…¸í…Œì´ì…˜ìœ¼ë¡œ ë©”ì„œë“œ ë‹¨ìœ„ ë½ ì œì–´
   - SpEL ì§€ì› â†’ ìì› ì‹ë³„ í‚¤ë¥¼ ë™ì ìœ¼ë¡œ ìƒì„± ê°€ëŠ¥
   - `waitTime`, `leaseTime`, `retry` ë“± íŒŒë¼ë¯¸í„°ë¡œ ì„¸ë°€í•œ ì œì–´ ê°€ëŠ¥

2. **Redisson Lock Manager**

   - `tryLock()` ê¸°ë°˜ìœ¼ë¡œ ë½ íšë“ ì‹œë„ â†’ ì‹¤íŒ¨ ì‹œ ì¬ì‹œë„ ë¡œì§ í¬í•¨
   - **ìë™ í•´ì œ(leaseTime)** ì„¤ì •ìœ¼ë¡œ ë°ë“œë½ ë°©ì§€
   - ì˜ˆì™¸ ìœ í˜•ë³„(`BusinessException`, `CommonException`) ì„¸ë¶„í™” ì²˜ë¦¬

3. **ì•ˆì „í•œ í•´ì œ**
   - `lock.isHeldByCurrentThread()` í™•ì¸ í›„ `unlock()` í˜¸ì¶œ
   - í•´ì œ ì‹¤íŒ¨ ì‹œ ë¡œê¹… ë° ì˜ˆì™¸ ì²˜ë¦¬

<br/>

## ğŸ”„ ë™ì‘ íë¦„

1. ì„œë¹„ìŠ¤ ë©”ì„œë“œì— `@DistributedLock(key = "'lock:post:' + #postId")`ì™€ ê°™ì´ ì ìš©
2. AOPê°€ ë©”ì„œë“œ í˜¸ì¶œ ì „ ë½ í‚¤ ìƒì„± â†’ Redissonì„ í†µí•´ ë½ íšë“ ì‹œë„
3. ë½ì„ íšë“í•˜ë©´ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì‹¤í–‰
4. ì‘ì—… ì™„ë£Œ í›„ ë½ í•´ì œ(ë˜ëŠ” leaseTime ë§Œë£Œ ì‹œ ìë™ í•´ì œ)

<br/>

## ê¸°ëŒ€ íš¨ê³¼

- **ë°ì´í„° ì •í•©ì„± ë³´ì¥**: ì¤‘ë³µ ì§‘ê³„Â·ì¤‘ë³µ ì†Œë¹„ ë°©ì§€
- **í™•ì¥ì„± í™•ë³´**: ì„œë²„ ì¸ìŠ¤í„´ìŠ¤ ìˆ˜ ì¦ê°€ ì‹œì—ë„ ì•ˆì „í•œ ë™ì‹œì„± ì œì–´
- **ìš´ì˜ ì•ˆì •ì„±**: ì¬ì‹œë„Â·ìë™ í•´ì œë¡œ ë°ë“œë½ ìœ„í—˜ ìµœì†Œí™”

<br/>
<br/>

---

<br/>
<br/>

---

# ğŸ‘€ 11. ì¡°íšŒìˆ˜(View Count) ì²˜ë¦¬ ì „ëµ

## ğŸ§© ë¬¸ì œ ìƒí™©

ì¡°íšŒìˆ˜ê°€ ë°œìƒí•  ë•Œë§ˆë‹¤ ê³§ë°”ë¡œ **DB ì—…ë°ì´íŠ¸**ë¥¼ ìˆ˜í–‰í•˜ë©´,

- íŠ¸ë˜í”½ì´ ë§ì€ ê²½ìš° **DB ë¶€í•˜ ê¸‰ì¦**
- ë‹¨ìˆœ ì¦ê°€ ì—°ì‚°ì´ì§€ë§Œ ë§¤ë²ˆ íŠ¸ëœì­ì…˜ì´ ë°œìƒ â†’ ì„±ëŠ¥ ì €í•˜
- ìˆœê°„ì ìœ¼ë¡œ ë§ì€ ìš”ì²­ì´ ëª°ë¦¬ë©´ ë½ ê²½í•©ê³¼ ì§€ì—° ë°œìƒ

ì´ë¼ëŠ” ë¬¸ì œê°€ ìƒê¸´ë‹¤.

ì¦‰, ì¡°íšŒìˆ˜ëŠ” **ì •í•©ì„±ë³´ë‹¤ëŠ” ì„±ëŠ¥ê³¼ ì§‘ê³„ íš¨ìœ¨**ì´ ì¤‘ìš”í•œ ë°ì´í„°ì´ë¯€ë¡œ, **ì¦‰ì‹œ DB ë°˜ì˜**ë³´ë‹¤ **ì„ì‹œ ì €ì¥ + ë°°ì¹˜ ë™ê¸°í™”** ì „ëµì´ ì í•©í•˜ë‹¤.

---

## âš™ï¸ êµ¬í˜„ ë°©ì‹

1. **Redis ìºì‹± & Deduplication**

   - `viewDedup:{targetType}:{projectId}:{viewerId}` í‚¤ë¥¼ ì‚¬ìš©í•´ **5ë¶„ TTL** ë™ì•ˆ ë™ì¼ ì‚¬ìš©ìì˜ ì¤‘ë³µ ì¡°íšŒìˆ˜ ì¦ê°€ë¥¼ ë°©ì§€.
   - ìµœì´ˆ ì¡°íšŒì¼ ë•Œë§Œ `viewCount:{targetType}:{projectId}` ì¹´ìš´íŠ¸ë¥¼ +1 ì¦ê°€.
   - Redisì˜ ë¹ ë¥¸ ì“°ê¸° ì„±ëŠ¥ì„ í™œìš©í•˜ì—¬ ê³ ë¹ˆë„ ìš”ì²­ì„ í¡ìˆ˜.

2. **ìŠ¤ì¼€ì¤„ëŸ¬ ê¸°ë°˜ ì›Œì»¤** (`ProjectViewCountWorker`)

   - `@Scheduled(fixedDelay=20s)` ì£¼ê¸°ë¡œ Redisì˜ viewCount í‚¤ë¥¼ ìŠ¤ìº”.
   - ê° í‚¤ì˜ ì¹´ìš´íŠ¸ë¥¼ **ì›ìì  pop(getDel)** í•˜ì—¬ ê°€ì ¸ì˜¤ê³ ,
     - ê°’ì´ ìˆìœ¼ë©´ DB `viewCount`ë¥¼ ì¦ê°€ì‹œí‚¤ê³ ,
     - ë™ì‹œì— **Projection Task** íì— ë“±ë¡ â†’ ESì—ë„ ë°˜ì˜ë¨.
   - ê°œë³„ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí•´ë„ ë¡œê¹… í›„ ë‹¤ìŒ í‚¤ë¥¼ ê³„ì† ì²˜ë¦¬ â†’ ì¥ì• ê°€ ì „ì²´ ë™ì‘ì— ì˜í–¥ ì£¼ì§€ ì•ŠìŒ.

3. **DB & ES ë™ê¸°í™”**
   - DBì—ëŠ” ìµœì¢… ì§‘ê³„ëœ viewCount ë°˜ì˜.
   - ESì—ëŠ” Projection Workerë¥¼ í†µí•´ ë¹„ë™ê¸° ì—…ë°ì´íŠ¸ â†’ ê²€ìƒ‰Â·ì¶”ì²œì—ì„œ ìµœì‹  ë°ì´í„° í™œìš© ê°€ëŠ¥.

---

## ğŸš€ íš¨ê³¼

- **DB ë¶€í•˜ ê°ì†Œ**  
  ì¦ì€ ì¡°íšŒ ì´ë²¤íŠ¸ë¥¼ Redisì—ì„œ ì§‘ê³„ â†’ ì£¼ê¸°ì ìœ¼ë¡œ DBì— ë°˜ì˜ â†’ íŠ¸ëœì­ì…˜ íšŸìˆ˜ ê°ì†Œ.

- **ì¤‘ë³µ ë°©ì§€**  
  TTL ê¸°ë°˜ deduplication â†’ ë™ì¼ ì‚¬ìš©ìì˜ ì§§ì€ ì‹œê°„ ë‚´ ë°˜ë³µ ì¡°íšŒëŠ” ì¹´ìš´íŠ¸ì— ë°˜ì˜ë˜ì§€ ì•ŠìŒ â†’ ë°ì´í„° ì™œê³¡ ë°©ì§€.

- **ìµœì¢…ì  ì¼ê´€ì„±**  
  Redis â†’ DB â†’ ES ìˆœì„œë¡œ ë™ê¸°í™” â†’ ì•½ê°„ì˜ ì§€ì—°ì€ ìˆì§€ë§Œ, DB/ESì˜ ìƒíƒœëŠ” ìµœì¢…ì ìœ¼ë¡œ ì¼ì¹˜.

- **ìš´ì˜ íš¨ìœ¨ì„±**  
  ì›Œì»¤ ê¸°ë°˜ ë°°ì¹˜ ì²˜ë¦¬ â†’ ëª¨ë‹ˆí„°ë§Â·ì•Œë¦¼Â·ì¬ì²˜ë¦¬ ì²´ê³„ì™€ ì‰½ê²Œ í†µí•© ê°€ëŠ¥.

<br/>
<br/>

---

# ğŸ“¡ 12. Kafka ê¸°ë°˜ ì´ë²¤íŠ¸ ì²˜ë¦¬ (Kafka ì¤‘ì‹¬ ìš”ì•½)

## ğŸ“Œ ëª©ì 

- **ë¹„ë™ê¸° ë¶„ë¦¬**ë¡œ API ë¶€í•˜ ì™„í™”
- **Key=ë¦¬ì†ŒìŠ¤ ID** íŒŒí‹°ì…”ë‹ìœ¼ë¡œ ë™ì¼ ë¦¬ì†ŒìŠ¤ **ìˆœì„œ ë³´ì¥**
- **ì¬ì‹œë„Â·DLQ**ë¡œ ì¥ì•  ê²©ë¦¬ ë° ì•ˆì • ìš´ì˜

---

## âš™ï¸ ë©”ì‹œì§€ & í† í”½ ì„¤ê³„ (ì ìš© ì‚¬ë¡€)

- **ë©”ì‹œì§€ íƒ€ì…**
  - **ë„ë©”ì¸ ì´ë²¤íŠ¸**: `DataUploadEvent{ dataId, dataFileUrl, originalFilename }` (JSON)
  - **ê²½ëŸ‰ íŠ¸ë¦¬ê±°**: `Long` (ì˜ˆ: `projectId`, `commentId`)
- **í‚¤ ì •ì±…**: í•­ìƒ `key = ë¦¬ì†ŒìŠ¤ ID` â†’ ë™ì¼ IDëŠ” ë™ì¼ íŒŒí‹°ì…˜ìœ¼ë¡œ ì§ë ¬ ì²˜ë¦¬
- **ëŒ€í‘œ í† í”½**
  - ì—…ë¡œë“œ ì´ë²¤íŠ¸: `data-uploaded`
  - ì¢‹ì•„ìš” ì¦ê°: `project-like-increase` / `project-like-decrease`
  - ëŒ“ê¸€ ìˆ˜ ë³€ê²½ íŠ¸ë¦¬ê±°: `comment-uploaded-topic` / `comment-deleted-topic`

---

## ğŸ“¨ í”„ë¡œë“€ì„œ (êµ¬í˜„ ê¸°ì¤€)

- **DataKafkaProducerAdapter â€” ì—…ë¡œë“œ ì´ë²¤íŠ¸**

  - Key / Value: `dataId` / `DataUploadEvent(JSON)`
  - Topic: `spring.kafka.producer.extract-metadata.topic` â†’ `data-uploaded`

- **LikeKafkaProducerAdapter â€” ì¢‹ì•„ìš” ì¦ê°**

  - Key / Value: `targetId` / `Long`
  - Topic(í”„ë¡œì íŠ¸): `spring.kafka.producer.project-like-(increase|decrease).topic` â†’ `project-like-*-topic`
  - Topic(ëŒ“ê¸€): `spring.kafka.producer.comment-like-(increase|decrease).topic` â†’ `comment-like-*-topic`

- **CommentKafkaProducerAdapter â€” ëŒ“ê¸€ ìˆ˜ ë³€ê²½**
  - Key / Value: `projectId` / `Long`
  - Topic: `spring.kafka.producer.comment-(upload|delete).topic` â†’ `comment-*-topic`

## ğŸ“¥ ì»¨ìŠˆë¨¸ (êµ¬í˜„ ê¸°ì¤€)

- **DataKafkaConsumerAdapter.consume â€” íŒŒì¼ ì²¨ë¶€ ë° ì—…ë¡œë“œ â†’ ë©”íƒ€ë°ì´í„° íŒŒì‹±/ì €ì¥**

  - Payload: `DataUploadEvent`
  - Topic: `spring.kafka.consumer.extract-metadata.topic` â†’ `data-uploaded`

- **ProjectKafkaConsumerAdapter.consumeCommentUpload â€” í”„ë¡œì íŠ¸ ëŒ“ê¸€ ìˆ˜ +1**

  - Payload: `Long projectId`
  - Topic: `spring.kafka.consumer.comment-upload.topic` â†’ `comment-uploaded-topic`

- **ProjectKafkaConsumerAdapter.consumeCommentDelete â€” í”„ë¡œì íŠ¸ ëŒ“ê¸€ ìˆ˜ -1**

  - Payload: `Long projectId`
  - Topic: `spring.kafka.consumer.comment-delete.topic` â†’ `comment-deleted-topic`

- **ProjectKafkaConsumerAdapter.consumeLikeIncrease â€” í”„ë¡œì íŠ¸ ì¢‹ì•„ìš” ìˆ˜ +1**

  - Payload: `Long projectId`
  - Topic: `spring.kafka.consumer.project-like-increase.topic` â†’ `project-like-increase-topic`

- **ProjectKafkaConsumerAdapter.consumeLikeDecrease â€” í”„ë¡œì íŠ¸ ì¢‹ì•„ìš” ìˆ˜ -1**
  - Payload: `Long projectId`
  - Topic: `spring.kafka.consumer.project-like-decrease.topic` â†’ `project-like-decrease-topic`

> ì²˜ë¦¬ ì‹¤íŒ¨ ì‹œ ì˜ˆì™¸ ì¬ë˜ì§€ê¸° â†’ ì»¨í…Œì´ë„ˆ **ì¬ì‹œë„/ë°±ì˜¤í”„ â†’ DLQ** ì •ì±… ì ìš©.

---

## ğŸ›¡ï¸ ì‹ ë¢°ì„± ìš´ì˜

- **ì¬ì‹œë„/ë°±ì˜¤í”„**: ì¼ì‹œ ì˜¤ë¥˜ëŠ” ìë™ ì¬ì‹œë„, í•œê³„ ì´ˆê³¼ ì‹œ **DLQ**ë¡œ ê²©ë¦¬
- **ë©±ë“±ì„±**: ë™ì¼ ë©”ì‹œì§€ ì¬ì²˜ë¦¬ì— ì•ˆì „í•˜ë„ë¡ **í‚¤/ì´ë²¤íŠ¸ID** ê¸°ë°˜ ì²˜ë¦¬(ì†Œë¹„ì ì±…ì„)
- **ì˜¤í”„ì…‹ ì»¤ë°‹**: ì»¨í…Œì´ë„ˆ ì •ì±…ì— ë”°ë¼ ì²˜ë¦¬ ì™„ë£Œ í›„ ì»¤ë°‹(ê¸°ë³¸ ì„¤ì • ì‚¬ìš©)
- **ëª¨ë‹ˆí„°ë§ í•µì‹¬ ì§€í‘œ**: **Lag**, **DLQ ì ì¬ëŸ‰**, **ì²˜ë¦¬ ì§€ì—°/ì˜¤ë¥˜ìœ¨**, **ì†Œë¹„ ìŠ¤ë£¨í’‹**

---

## ğŸ”„ ëŒ€í‘œ íë¦„

`Producer(í‚¤=IDë¡œ ë°œí–‰) â†’ Broker(íŒŒí‹°ì…˜/ë³´ì¡´/ë³µì œ) â†’ Consumer(ì¬ì‹œë„/ë°±ì˜¤í”„) â†’ ì‹¤íŒ¨ ì‹œ DLQ`

<br/>
<br/>

---

# ğŸ” 13. ê²€ìƒ‰ & ë¶„ì„ (Elasticsearch)

## ğŸ¯ ì ìš© ëª©ì 

- í”„ë¡œì íŠ¸ì— ëŒ€í•œ **ì „ë¬¸ ê²€ìƒ‰**, **ìœ ì‚¬ í”„ë¡œì íŠ¸ ì¶”ì²œ**, **ì‹¤ì‹œê°„ ê²€ìƒ‰ì–´ ëŒ€ì‘**ì„ ìœ„í•´ Elasticsearchë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.
- RDB ì¡°íšŒëŠ” ì •í•©ì„± ìš°ì„ (ëª©ë¡Â·í•„í„°), ESëŠ” **ìœ ì‚¬ë„Â·ê°€ì¤‘ì¹˜ ë­í‚¹/ìë™ì™„ì„±/ê³ ì† ê²€ìƒ‰**ì„ ë‹´ë‹¹í•©ë‹ˆë‹¤.

<br/>

## ğŸ—‚ï¸ ì¸ë±ìŠ¤/ë„íë¨¼íŠ¸

- **ì¸ë±ìŠ¤**: `project_index`
- **ë¬¸ì„œ**: í”„ë¡œì íŠ¸ ê¸°ë³¸ ë©”íƒ€(ì œëª©/ë‚´ìš©/ì‘ì„±ì ë“±) + í†µê³„(ëŒ“ê¸€/ì¢‹ì•„ìš”/ì¡°íšŒìˆ˜) + ìƒíƒœ(`isDeleted`) + ì‹œê°„(`createdAt`) ë“±

<br/>

## ğŸ”„ ìƒ‰ì¸ & ì¦ë¶„ ì—…ë°ì´íŠ¸

- **ìƒ‰ì¸ ì–´ëŒ‘í„°**: í”„ë¡œì íŠ¸ ë¬¸ì„œë¥¼ `project_index`ì— ì €ì¥/ê°±ì‹ .
- **ì¦ë¶„ ì—…ë°ì´íŠ¸**: ëŒ“ê¸€ ìˆ˜ ë³€í™”ëŠ” **Painless ìŠ¤í¬ë¦½íŠ¸**ë¡œ ì¦ê°€/ê°ì†Œ ì²˜ë¦¬
  - `commentCount == null` â†’ ì´ˆê¸°í™”, 0 ì´í•˜ ë°©ì§€
- **ëª©í‘œ**: API íŠ¸ëœì­ì…˜ ì´í›„ **ì¤€ì‹¤ì‹œê°„ ë°˜ì˜**ìœ¼ë¡œ ê²€ìƒ‰/ì¶”ì²œ ì •í™•ë„ ìœ ì§€.

<br/>

## ğŸ” ê²€ìƒ‰ ì‹œë‚˜ë¦¬ì˜¤

### 1) ì‹¤ì‹œê°„ ê²€ìƒ‰/ìë™ì™„ì„±

- **ì¿¼ë¦¬**: `multi_match`(fuzziness **AUTO**)ë¡œ **title^3**, **username^2** ê°€ì¤‘ì¹˜ ì ìš©í•˜ì—¬ ì œëª©ê³¼ ì—…ë¡œë” ê²€ìƒ‰
- **í•„í„°**: `isDeleted=false`
- **ì •ë ¬**: `createdAt` ë‚´ë¦¼ì°¨ìˆœ
- **ê²°ê³¼**: ê°€ë²¼ìš´ ì‘ë‹µ ëª¨ë¸(ì˜ˆ: id, title, username, thumbnail)ë¡œ ë°˜í™˜ â†’ ëª©ë¡/ìë™ì™„ì„±/ì‹¤ì‹œê°„ ê²€ìƒ‰ì— ì¦‰ì‹œ ì‚¬ìš©

### 2) ìœ ì‚¬ í”„ë¡œì íŠ¸ ì¶”ì²œ

- **ì¿¼ë¦¬ ì¡°í•©**:
  - `more_like_this`(title, content)
  - `term` ê°€ì¤‘ì¹˜: `topicId`(1.5), `analysisPurposeId`(1.3)
  - `must_not`: ìê¸° ìì‹ (`id`) ì œì™¸
  - `filter`: `isDeleted=false`
- **ì •ë ¬**: ìµœì‹ ì„± ë°˜ì˜(`createdAt` desc)
- **ê²°ê³¼**: ì œëª©/ìš”ì•½/ì‘ì„±ì/ì¸ë„¤ì¼/í†µê³„ í•„ë“œë¥¼ í¬í•¨í•œ ì¶”ì²œ ë¦¬ìŠ¤íŠ¸

---

## ğŸ”€ ì¡°íšŒ ë¶„ë¦¬ ì „ëµ

- **DB(JPA/QueryDSL)**: ë‹¨ìˆœ ëª©ë¡/í•„í„°, ì¦‰ì‹œ ì¼ê´€ì„± í•„ìš”í•œ í™”ë©´
- **Elasticsearch**: ì „ë¬¸ ê²€ìƒ‰, ìœ ì‚¬ë„ ì¶”ì²œ, ê°€ì¤‘ì¹˜(score) ë­í‚¹, ìë™ì™„ì„±

---

## âœ… ê¸°ëŒ€ íš¨ê³¼

- **ê²€ìƒ‰ í’ˆì§ˆ í–¥ìƒ**: ë‚´ìš© ê¸°ë°˜ ìœ ì‚¬ë„ + ë„ë©”ì¸ ê°€ì¤‘ì¹˜ë¡œ ë­í‚¹ ìµœì í™”
- **ì‹¤ì‹œê°„ì„±**: ìƒ‰ì¸/ì¦ë¶„ ì—…ë°ì´íŠ¸ë¡œ ìµœì‹  ì§€í‘œ ë°˜ì˜
- **ì„±ëŠ¥**: ëŒ€ëŸ‰ ë°ì´í„°ì—ì„œë„ ms~ìˆ˜ì‹­ ms ìˆ˜ì¤€ ì‘ë‹µ

<br/>
<br/>

---

# ğŸ“ 14. ê³µí†µ ë¡œê¹… (LoggerFactory ê¸°ë°˜)

## ì ìš© ëª©ì 

- ê³„ì¸µ ë° ëª¨ë“ˆë³„ **ì¼ê´€ëœ ë¡œê¹… í‘œì¤€** ì œê³µ
- ë¡œê·¸ í¬ë§·Â·ë ˆë²¨Â·íƒœê·¸ë¥¼ í†µì¼í•´ **ë¬¸ì œ ì¶”ì ê³¼ ë¶„ì„** íš¨ìœ¨í™”
- API, DB, Kafka, Elasticsearch, Redis, ë¶„ì‚°ë½ ë“± ë‹¤ì–‘í•œ ì˜ì—­ì—ì„œ **ì¬ì‚¬ìš© ê°€ëŠ¥**

---

## ì„¤ê³„ ê°œìš”

- **`BaseLogger`**: ëª¨ë“  ë¡œê±°ì˜ ê¸°ë³¸ ë¡œê¹… ê¸°ëŠ¥(info/debug/warn/error) ì¶”ìƒí™”
- **ì „ë¬¸í™” Logger í´ë˜ìŠ¤**: API, Service, Domain, Persistence, Kafka, Elasticsearch, Redis, ë¶„ì‚°ë½ ë“± ê¸°ëŠ¥ë³„ ë¡œê¹… ì§€ì›
- **`LoggerFactory`**: ì „ì—­ì—ì„œ ê° Logger **ì‹±ê¸€í†¤** ì œê³µ  
  â†’ í˜¸ì¶œ ê³„ì¸µì— ë§ëŠ” Loggerë¥¼ ì„ íƒì ìœ¼ë¡œ ì‚¬ìš© ê°€ëŠ¥

---

## íŠ¹ì§•

- **ê³„ì¸µë³„ ë¡œê¹… ë¶„ë¦¬**ë¡œ ë¡œê·¸ í•„í„°ë§ ë° ë¶„ì„ ìš©ì´
- **ì‹œê°„Â·ì†Œìš” ì‹œê°„ ê¸°ë¡** ë“± ì„±ëŠ¥ ì¸¡ì •ì— í•„ìš”í•œ ë¶€ê°€ì •ë³´ í¬í•¨
- **ë„ë©”ì¸Â·ì¸í”„ë¼ ë¡œê¹… í†µí•© ê´€ë¦¬**ë¡œ ìœ ì§€ë³´ìˆ˜ì„± í–¥ìƒ
- ìƒˆë¡œìš´ ë¡œê¹… ì˜ì—­ì´ í•„ìš”í•  ê²½ìš° **ì†ì‰¬ìš´ í™•ì¥ ê°€ëŠ¥**

<br/>
<br/>

---

## ğŸ” 15. ë³´ì•ˆ & ì¸ì¦ (OAuth2 + ìì²´ ë¡œê·¸ì¸ + JWT)

### âš™ï¸ êµ¬ì„±

- **ì†Œì…œ ë¡œê·¸ì¸**: Google, Kakao (OAuth2)
- **ìì²´ ë¡œê·¸ì¸**: ì´ë©”ì¼/ë¹„ë°€ë²ˆí˜¸
- ì¸ì¦ ì„±ê³µ ì‹œ **Access Token + Refresh Token(JWT)** ë°œê¸‰

### ğŸ’¾ ì„¸ì…˜ ìƒíƒœ ê´€ë¦¬

- Refresh Token â†’ `Redis` ì €ì¥ (ì‚¬ìš©ì ë‹¨ìœ„ í‚¤, TTL ì„¤ì •)

### ğŸ” í•„í„° ì²´ì¸

- ìš”ì²­ë§ˆë‹¤ ì–´ì„¸ìŠ¤í† í° JWT ì¸ì¦ ê²€ì‚¬
- ì‹¤íŒ¨ ìœ í˜•ë³„ 401(ì¸ì¦ ì‹¤íŒ¨) / 403(ê¶Œí•œ ë¶€ì¡±) êµ¬ë¶„ ì‘ë‹µ

### ğŸ”„ ì¬ë°œê¸‰ í”Œë¡œìš°

- Access ë§Œë£Œ â†’ Refresh ê²€ì¦ â†’ Access ì¬ë°œê¸‰
- Redis ì €ì¥ê°’ ë¶ˆì¼ì¹˜/ë§Œë£Œ ì‹œ ì¬ë°œê¸‰ ê±°ë¶€

### ğŸ›¡ ë³´ì•ˆ í•˜ë“œë‹

- í† í° ìŠ¤ì½”í”„Â·í´ë ˆì„ ìµœì†Œí™” (ì›ì¹™: í•„ìš”í•œ ì •ë³´ë§Œ í¬í•¨)
- **HTTPS ì „ì œ**, í—¤ë” ê¸°ë°˜ ì „ë‹¬
- ë¹„ì •ìƒ ì‹œë„(ì¬ë°œê¸‰ ê³¼ë‹¤, ì‹¤íŒ¨ ëˆ„ì ) ì§€í‘œí™”

### âœ… íš¨ê³¼

- ì†Œì…œÂ·ìì²´ ë¡œê·¸ì¸ **í†µí•© ê´€ë¦¬**
- Redis ê¸°ë°˜ **ì¦‰ì‹œ ë¬´íš¨í™”**ë¡œ ë³´ì•ˆì„± ê°•í™”

<br/>
<br/>

---

# ğŸ›¡ï¸ 16. AOP ê¸°ë°˜ ë³€ê²½ ê¶Œí•œ ê²€ì¦ (ex. DataAuthPolicy)

## ğŸ¯ ëª©ì 

ë°ì´í„° **í¸ì§‘Â·ì‚­ì œÂ·ë³µì›** ì‹œ í˜„ì¬ ì¸ì¦ ì‚¬ìš©ìê°€ í•´ë‹¹ ë°ì´í„°ì˜ **ìƒì„±ì**ì¸ì§€ ê²€ì¦í•˜ì—¬  
ë¹„ì¸ê°€ ì ‘ê·¼ì„ ì°¨ë‹¨í•˜ê³  ë¡œê¹…í•©ë‹ˆë‹¤.

---

## âš™ï¸ ë™ì‘ ë°©ì‹ (ì ìš© ì˜ˆì‹œ)

1. ğŸ·ï¸ ë©”ì„œë“œì— `@AuthorizationDataEdit` ì ìš©
2. ğŸ” AOP ì‹¤í–‰:
   - ğŸ‘¤ ì¸ì¦ ì‚¬ìš©ì ID ì¡°íšŒ
   - ğŸ“‚ ë°ì´í„° Owner ID ì¡°íšŒ (ë³µì› ì‹œ ì‚­ì œ ë°ì´í„° í¬í•¨)
   - ğŸš« ë¶ˆì¼ì¹˜ ì‹œ **ê²½ê³  ë¡œê·¸** ê¸°ë¡ í›„ `DataException` ë°œìƒ

---

## ğŸ“œ ì£¼ìš” ê·œì¹™

- âœï¸ ê¸°ë³¸: ìƒì„±ìë§Œ í¸ì§‘Â·ì‚­ì œ ê°€ëŠ¥
- â™»ï¸ `restore = true`: ìƒì„±ìë§Œ ë³µì› ê°€ëŠ¥
- ğŸ”‘ ì²« ë²ˆì§¸ íŒŒë¼ë¯¸í„°ëŠ” `dataId`(Long)ì—¬ì•¼ í•¨

---

## ğŸ’» ì‚¬ìš© ì˜ˆì‹œ

```java
@AuthorizationDataEdit
public void update(Long dataId) { ... }

@AuthorizationDataEdit(restore = true)
public void restore(Long dataId) { ... }

```

<br/>
<br/>

---

# ğŸ—‚ 17. ìŠ¤í† ë¦¬ì§€ & ë©”ì¼ (S3 + SendGrid)

### ğŸ“ íŒŒì¼ ì €ì¥

- ì´ë¯¸ì§€/ì²¨ë¶€ â†’ `S3` ì—…ë¡œë“œ
- ì—…ë¡œë“œÂ·ì‚­ì œÂ·ì¡°íšŒ ì ìš©, ì‘ë‹µì—” ì ‘ê·¼ ê°€ëŠ¥í•œ URLë§Œ ë…¸ì¶œ (ì„œë²„ ê¶Œí•œ ì²˜ë¦¬)

### ğŸ”‘ íŒŒì¼ ë‹¤ìš´ë¡œë“œ

- íŒŒì¼ ë‹¤ìš´ë¡œë“œëŠ” ë³´ì•ˆì„±ì„ ìƒê°
- ì¼ì •ì‹œê°„ë™ì•ˆë§Œ ë‹¤ìš´ë¡œë“œë¥¼ í•  ìˆ˜ ìˆëŠ” preSigned URL ë§í¬ë¥¼ ì œê³µ
- í•´ë‹¹ ì‹œê°„ì´ ì§€ë‚  ì‹œ ë§Œë£Œëœ URLë¡œ íŒŒì¼ ë‹¤ìš´ë¡œë“œ ë¶ˆê°€

### ğŸ“§ ë©”ì¼ ë°œì†¡

- `SendGrid API`ë¡œ ì¸ì¦Â·ì•Œë¦¼ ë©”ì¼ ì „ì†¡
- í…œí”Œë¦¿í™”(ì œëª©/ë³¸ë¬¸ ë³€ìˆ˜ì¹˜í™˜)ë¡œ ìš´ì˜ íš¨ìœ¨ì„± í™•ë³´

### âš ï¸ ì¥ì•  ëŒ€ì‘

- ì™¸ë¶€ I/O ì‹¤íŒ¨ ì‹œ ì¬ì‹œë„ ì •ì±… ì ìš©
- ë¡œê¹… í‘œì¤€í™” (ìš”ì²­ID, ìˆ˜ì‹ ì, í…œí”Œë¦¿, ì‘ë‹µì½”ë“œ) â†’ ë¬¸ì œ ì¶”ì  ìš©ì´

### âœ… íš¨ê³¼

- ëŒ€ìš©ëŸ‰ íŒŒì¼/ë©”ì¼ ì „ì†¡ì„ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ë¶„ë¦¬ â†’ ì„±ëŠ¥Â·ì•ˆì •ì„± í™•ë³´
- ìš´ì˜ìƒ ê´€ì°° ê°€ëŠ¥ì„± ìœ ì§€

<br/>
<br/>

---

# ğŸ“Š 18. Dataracy â€“ ì‚¬ìš©ì í–‰ë™ ë¡œê·¸ ê¸°ë°˜ ê´€ì¸¡ ì‹œìŠ¤í…œ

> Real-Time Behavioral Logging & Monitoring with Kafka, Elasticsearch, Redis, Prometheus, Grafana

## ğŸ§© í”„ë¡œì íŠ¸ ê°œìš”

> **Dataracy**ëŠ” ì‚¬ìš©ì í–‰ë™(í´ë¦­, ì´ë™, ì²´ë¥˜ ì‹œê°„ ë“±)ì„ í–‰ë™ ë¡œê·¸ ê¸°ë¡ì„ í†µí•´
> Kafka â†’ Elasticsearchë¡œ ë¹„ë™ê¸° ìˆ˜ì§‘í•˜ê³ , Kibana ëŒ€ì‹œë³´ë“œ ë° Prometheus + Grafanaë¥¼ í†µí•´ ì‹¤ì‹œê°„ ë¶„ì„/ì‹œê°í™”í•˜ëŠ” ê³ ì„±ëŠ¥ ë¡œê·¸ ìˆ˜ì§‘ ì‹œìŠ¤í…œì„ ì ìš©í•œë‹¤.

---

## ğŸ§± ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

```plaintext
User
 â””â”€â”€ HTTP Request
      â””â”€â”€ ğŸ” [Filter] MDC ì¶”ì  ID, IP, Path ë“± ìˆ˜ì§‘
           â””â”€â”€ ğŸ¯ [@TrackClick / @TrackNavigation] ì‚¬ìš©ì í–‰ë™ ë¶„ë¥˜
                â””â”€â”€ ğŸ•“ DB/ì™¸ë¶€ API ì‘ë‹µì‹œê°„ ì¸¡ì • (AOP)
                     â””â”€â”€ ğŸ“¦ Kafka Producer ì „ì†¡
                          â””â”€â”€ ğŸ§µ Kafka Consumer â†’ Elasticsearch ì €ì¥
                               â””â”€â”€ ğŸ“Š Kibana ëŒ€ì‹œë³´ë“œ ì‹œê°í™”
      â””â”€â”€ ğŸ“¡ Prometheus /actuator/prometheus ìˆ˜ì§‘
           â””â”€â”€ ğŸ“ˆ Grafana ì‹¤ì‹œê°„ ë©”íŠ¸ë¦­ ë¶„ì„
```

## ğŸ¯ ëª©í‘œ

ì‚¬ìš©ìì™€ ì‹œìŠ¤í…œì´ **"ëˆ„ê°€, ì–¸ì œ, ë¬´ì—‡ì„, ì–¼ë§ˆë‚˜ ê±¸ë ¤ì„œ"** ìˆ˜í–‰í–ˆëŠ”ì§€ë¥¼  
í–‰ë™ ë‹¨ìœ„ë¡œ ê¸°ë¡í•˜ì—¬ **ìš´ì˜, ë¶„ì„, ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§, ì»´í”Œë¼ì´ì–¸ìŠ¤ ê·¼ê±° ë°ì´í„°**ë¥¼ í™•ë³´í•©ë‹ˆë‹¤.

---

## ğŸ›  ì„¤ê³„

- **MDC ê¸°ë°˜ ìƒê´€ê´€ê³„ ID ë¶€ì—¬**
  - ìš”ì²­Â·ì‘ë‹µ ì „ êµ¬ê°„ ì¶”ì  (Controller~Repository í˜¸ì¶œ ì²´ì¸ ì—°ê²°)
- **AOP ê³„ì¸µë³„ ì§€ì—° ì¸¡ì •**
  - API, DB, ì™¸ë¶€ I/O í˜¸ì¶œ ì‹œê°„ ë¡œê¹…
- **ë¹„ë™ê¸° ì²˜ë¦¬**
  - Kafkaë¥¼ í†µí•œ ë¡œê·¸ ì „ì†¡ â†’ API ì‘ë‹µ ì§€ì—° ìµœì†Œí™”
- **ì‹œê°í™”**
  - Elasticsearch ìƒ‰ì¸ + Kibana ëŒ€ì‹œë³´ë“œë¡œ ì‚¬ìš©ì í–‰ë™ íŒ¨í„´ ë¶„ì„

| í•„ë“œëª…      | ì„¤ëª…                    |
| ----------- | ----------------------- |
| requestId   | ìš”ì²­ ID                 |
| userId      | ì‚¬ìš©ì ID               |
| anonymousId | ìµëª… ì‚¬ìš©ì ì‹ë³„ì      |
| uri         | ìš”ì²­ URI                |
| method      | HTTP ë©”ì„œë“œ             |
| durationMs  | ì²˜ë¦¬ì‹œê°„(ms)            |
| statusCode  | ê²°ê³¼ ì½”ë“œ (HTTP Status) |
| userAgent   | í´ë¼ì´ì–¸íŠ¸ User-Agent   |
| ip          | ìš”ì²­ IP                 |

## ğŸ“ˆ íš¨ê³¼

- **ì§€ì—° í•«ìŠ¤íŒŸ ì¦‰ì‹œ ì‹ë³„** (DB / ES / ì™¸ë¶€ API)
- **ê¸°ëŠ¥Â·ì„±ëŠ¥ íšŒê·€ ì—¬ë¶€ ì‹ ì† ê²€ì¦**
- **ìš´ì˜ ëª¨ë‹ˆí„°ë§**

<br/>
<br/>

---

## ğŸ§ª 19. í…ŒìŠ¤íŠ¸ & í’ˆì§ˆ (k6)

### ğŸ¯ ëª©í‘œ

- ë¡œê·¸ì¸, ê²€ìƒ‰, ì¡°íšŒ, ì¢‹ì•„ìš”, ëŒ“ê¸€ ë“± **í•µì‹¬ API**ì˜ ì§€ì—°,ì—ëŸ¬ìœ¨ì„ ìˆ˜ì¹˜ ê´€ë¦¬
- ë°°í¬ ì „/í›„ **ì„±ëŠ¥ íšŒê·€** ì¡°ê¸° ê°ì§€

### ğŸ›  ì „ëµ

- ì‹œë‚˜ë¦¬ì˜¤ ê¸°ë°˜ ë¶€í•˜ (ì—°ê²°/í”¼í¬/ì†Œì§„)ë¡œ í˜„ì‹¤ íŠ¸ë˜í”½ ê·¼ì‚¬
- Threshold ì„¤ì • (p95/p99, ì‹¤íŒ¨ìœ¨, TPS) â†’ ìë™ í•©/ë¶ˆíŒë‹¨
- ê²°ê³¼ë¥¼ ëª¨ë‹ˆí„°ë§ ì§€í‘œì™€ ê°™ì€ ì¶•ìœ¼ë¡œ ë¹„êµ â†’ ì›ì¸ íŒŒì•… ë‹¨ìˆœí™”

### ğŸ“Œ í™œìš©

- ìºì‹œ ì ì¤‘ë¥ , ë½ ì¶©ëŒ, ìƒ‰ì¸ ì§€ì—° ë“± **ë³‘ëª© ê°€ì„¤** ê²€ì¦
- ì‹¤í—˜ ê²°ê³¼ë¥¼ ê·¼ê±°ë¡œ ìš´ì˜ íŠœë‹ (ìºì‹œ TTL, ì •ë ¬ ì „ëµ, íŒŒí‹°ì…˜ ì „ëµ)

### âœ… íš¨ê³¼

- ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸ë¥¼ ë„˜ì–´ **ì„±ëŠ¥ SLO**ë¥¼ ìˆ˜ì¹˜ë¡œ ê´€ë¦¬

<br/>
<br/>

---

## ğŸ“Š 20. ëª¨ë‹ˆí„°ë§ & ì•Œë¦¼ (Micrometer + Prometheus + Grafana)

### ğŸ“¡ ìˆ˜ì§‘

- `Micrometer`ë¡œ ìš”ì²­ ì§€ì—°, ì—ëŸ¬ìœ¨, ìŠ¤ë ˆë“œí’€, GC, í ê¸¸ì´ ë“± í‘œì¤€ ë©”íŠ¸ë¦­ ë…¸ì¶œ

### ğŸ’¾ ì €ì¥ & ì‹œê°í™”

- `Prometheus` ì£¼ê¸° ìŠ¤í¬ë© â†’ `Grafana` ëŒ€ì‹œë³´ë“œë¡œ ë°°í¬ ì „/í›„ ë¹„êµ ë·°, SLO íŒ¨ë„ ì œê³µ

### ğŸ”” ì•Œë¦¼

- ì„ê³„ì¹˜ ì´ˆê³¼ ì‹œ Slack/ë©”ì¼ ë“± ì‹¤ì‹œê°„ í†µì§€  
  (ì˜ˆ: p95 ì§€ì—°, 5xx ë¹„ìœ¨, Kafka Lag, DLQ ì ì¬ëŸ‰, ìƒ‰ì¸ ì§€ì—°)
- ë°°í¬ ì§í›„ **ì—„ê²© ì„ê³„ì¹˜ ìœˆë„ìš°(5~10ë¶„)** ìš´ì˜

### ğŸ›  ìš´ì˜ í¬ì¸íŠ¸

- **ë¸”ë£¨/ê·¸ë¦° ì»¬ëŸ¬Â·ë¦´ë¦¬ìŠ¤IDÂ·ìš”ì²­ID**ë¥¼ ë©”íŠ¸ë¦­ íƒœê·¸ì— í¬í•¨ â†’ ìƒê´€ê´€ê³„ ë¶„ì„
- Kafka/ES/Redis ì§€í‘œë¥¼ ì•± ì§€í‘œì™€ **ë™ì¼ í™”ë©´ì—ì„œ êµì°¨ í™•ì¸**

### âœ… íš¨ê³¼

- ì´ìƒ ì§•í›„ë¥¼ **ì‹ ì† ê°ì§€**
- ì§€í‘œì˜ **ìŠ¤í† ë¦¬(ì›ì¸â†’ì˜í–¥)**ë¥¼ í•œëˆˆì— ì¶”ì 

<br/>
<br/>

---
